var Ft=Object.defineProperty;var Lt=(t,e,o)=>e in t?Ft(t,e,{enumerable:!0,configurable:!0,writable:!0,value:o}):t[e]=o;var E=(t,e,o)=>Lt(t,typeof e!="symbol"?e+"":e,o);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))i(n);new MutationObserver(n=>{for(const l of n)if(l.type==="childList")for(const s of l.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&i(s)}).observe(document,{childList:!0,subtree:!0});function o(n){const l={};return n.integrity&&(l.integrity=n.integrity),n.referrerPolicy&&(l.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?l.credentials="include":n.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function i(n){if(n.ep)return;n.ep=!0;const l=o(n);fetch(n.href,l)}})();const O=(t,e)=>Math.random()*(e-t)+t,Nt=(t,e)=>Math.floor(O(t,e)),q=(t,e,o)=>Math.max(e,Math.min(o,t)),Q=(t,e)=>{const o=t.x-e.x,i=t.y-e.y;return o*o+i*i},Wt=t=>Math.hypot(t.x,t.y),kt=t=>{const e=Wt(t)||1;return{x:t.x/e,y:t.y/e}},St=(t,e)=>({x:t.x-e.x,y:t.y-e.y}),y=32,N={w:240*y,h:240*y},j={x:N.w/2,y:N.h/2},G={sky:"#0a0e14",ground:"#0e161f",wood:"#b08968",metal:"#cbd5e1",colonist:"#c7f9cc",enemy:"#ff9aa2",tree:"#6fbf73",rock:"#9aa5b1",ghost:"#6ee7ff",wall:"#9aa5b1",bld:"#93c5fd",turret:"#93c5fd",farm:"#8bd3dd",house:"#e2b714",stock:"#c084fc",tent:"#f59e0b"},Qe={start:.72,end:.07};function Ue(t,e,o,i){return Math.abs(t-o)+Math.abs(e-i)}function Gt(){const t=Math.ceil(7680/y),e=Math.ceil(7680/y),o=t*e,i=32,n=Math.ceil(t/i),l=Math.ceil(e/i),s=n*l;return{cols:t,rows:e,solid:new Uint8Array(o),cost:new Float32Array(o).fill(1),minCost:1,sectionSize:i,sectionCols:n,sectionRows:l,dirtyFlags:new Uint8Array(s)}}function Yt(t){t.solid.fill(0),t.cost.fill(1),t.minCost=1,t.dirtyFlags.fill(1)}function Ee(t,e,o,i,n){const l=Math.floor(Math.floor(e/y)/t.sectionSize),s=Math.floor(Math.floor(o/y)/t.sectionSize),a=Math.floor(Math.floor((e+i-1)/y)/t.sectionSize),r=Math.floor(Math.floor((o+n-1)/y)/t.sectionSize);for(let c=Math.max(0,s);c<=Math.min(t.sectionRows-1,r);c++)for(let h=Math.max(0,l);h<=Math.min(t.sectionCols-1,a);h++){const d=c*t.sectionCols+h;t.dirtyFlags[d]=1}}function zt(t,e,o,i,n){const l=Math.floor(e/y),s=Math.floor(o/y),a=Math.floor((e+i-1)/y),r=Math.floor((o+n-1)/y);for(let c=s;c<=r;c++)for(let h=l;h<=a;h++)if(h>=0&&c>=0&&h<t.cols&&c<t.rows){const d=c*t.cols+h;t.solid[d]=1}Ee(t,e,o,i,n)}function Xe(t,e,o,i){const n=Math.floor((e-i)/y),l=Math.floor((o-i)/y),s=Math.floor((e+i)/y),a=Math.floor((o+i)/y);for(let r=l;r<=a;r++)for(let c=n;c<=s;c++)if(c>=0&&r>=0&&c<t.cols&&r<t.rows){const h=c*y+y/2,d=r*y+y/2,A=h-e,p=d-o;if(A*A+p*p<=i*i){const f=r*t.cols+c;t.solid[f]=1}}Ee(t,e-i,o-i,i*2,i*2)}function Ht(t,e,o,i,n,l){const s=Math.floor(e/y),a=Math.floor(o/y),r=Math.floor((e+i-1)/y),c=Math.floor((o+n-1)/y);for(let h=a;h<=c;h++)for(let d=s;d<=r;d++)if(d>=0&&h>=0&&d<t.cols&&h<t.rows){const A=h*t.cols+d;t.cost[A]=l,l<t.minCost&&(t.minCost=l)}Ee(t,e,o,i,n)}const Ct=.7,Ot={BASIC_PATH:.6,FAST_ROAD:.5,SLOW_PATH:.7,GRASS:1,ROUGH_TERRAIN:1.5};function we(t,e){return t.cost[e]<=Ct}function qe(t,e,o){const i=Math.floor(e/y),n=Math.floor(o/y);return i<0||n<0||i>=t.cols||n>=t.rows?!1:we(t,n*t.cols+i)}function je(t,e,o,i,n,l="BASIC_PATH"){const s=Ot[l],a=Math.max(.5,Math.min(.7,s));Ht(t,e,o,i,n,a)}function Re(t,e){return{gx:Math.floor(t/y),gy:Math.floor(e/y)}}function Qt(t,e){for(let o=0;o<e.length;o++){const i=Math.floor(e[o].x/y),n=Math.floor(e[o].y/y);if(i>=0&&n>=0&&i<t.cols&&n<t.rows){const l=n*t.cols+i;we(t,l)&&(e[o].x=i*y+y/2,e[o].y=n*y+y/2)}}}function Ut(t,e,o,i){const n=Re(e.x,e.y),l=Re(o.x,o.y),s=Re(i.x,i.y),a=Math.sign(l.gx-n.gx),r=Math.sign(l.gy-n.gy),c=Math.sign(s.gx-l.gx),h=Math.sign(s.gy-l.gy),d=a!==0&&h!==0||r!==0&&c!==0,A=l.gy*t.cols+l.gx;return d&&A>=0&&A<t.cost.length&&we(t,A)}function Ie(t,e,o,i,n){const l=t.cols,s=t.rows,a={x:Math.floor(e/y),y:Math.floor(o/y)},r={x:Math.floor(i/y),y:Math.floor(n/y)},c=(P,u)=>u*l+P;if(a.x===r.x&&a.y===r.y)return[{x:i,y:n}];const h=c(a.x,a.y),d=c(r.x,r.y),A=(P,u)=>P>=0&&u>=0&&P<l&&u<s,p=(P,u)=>{if(!A(P,u))return!1;const x=c(P,u);return x===h||x===d?!0:t.solid[x]===0},f=new Int32Array(l*s).fill(-1),g=new Float32Array(l*s).fill(1/0),m=new Float32Array(l*s).fill(1/0),b=new Uint8Array(l*s),w=[],v=P=>{w.push(P)},k=()=>{let P=-1,u=1/0;for(let M=0;M<w.length;M++){const B=w[M];if(b[B])continue;const I=m[B];I<u&&(u=I,P=M)}return P===-1?-1:w.splice(P,1)[0]},S=Math.max(1e-4,t.minCost);g[h]=0,m[h]=Ue(a.x,a.y,r.x,r.y)*S,v(h);const R=[[1,0],[-1,0],[0,1],[0,-1]];for(;w.length;){const P=k();if(P===-1)break;if(b[P])continue;b[P]=1;const u=P%l,x=P/l|0;if(P===d){let M=[],B=P;for(;B!==-1;){const C=B%l,T=B/l|0;M.push({x:C*y+y/2,y:T*y+y/2}),B=f[B]}M.reverse(),M[M.length-1]={x:i,y:n};const I=[];for(let C=0;C<M.length-1;C++){const T=M[C],W=M[C+1];I.push(T);const Y=Math.floor(T.x/y),X=Math.floor(T.y/y),U=Math.floor(W.x/y),Z=Math.floor(W.y/y),_=X*l+Y,J=Z*l+U,$=we(t,_)&&we(t,J);if(!($&&(X===Z||Y===U)))if($){const le=W.x-T.x,oe=W.y-T.y,Ae=Math.hypot(le,oe),ce=Math.floor(Ae/18);for(let ie=1;ie<=ce;ie++){const ne=ie/(ce+1);I.push({x:T.x+le*ne,y:T.y+oe*ne})}}else{const le=W.x-T.x,oe=W.y-T.y,Ae=Math.hypot(le,oe),ce=Math.floor(Ae/24);for(let ie=1;ie<=ce;ie++){const ne=ie/(ce+1);I.push({x:T.x+le*ne,y:T.y+oe*ne})}}}I.push(M[M.length-1]),M=I;const L=(C,T,W,Y)=>{const X=W-C,U=Y-T,Z=Math.hypot(X,U)||1,_=Math.max(6,y*.33),J=Math.ceil(Z/_);let $=0,V=0;for(let oe=1;oe<J;oe++){const Ae=oe/J,ce=C+X*Ae,ie=T+U*Ae,ne=Math.floor(ce/y),Ce=Math.floor(ie/y);if(ne<0||Ce<0||ne>=t.cols||Ce>=t.rows)return!1;const Oe=Ce*t.cols+ne;if(t.solid[Oe])return!1;t.cost[Oe]<=Ct&&$++,V++}const te=qe(t,C,T),le=qe(t,W,Y);return te&&le&&V>0?$/V>=.6:!0},D=[];let F=0;for(;F<M.length;){D.push(M[F]);let C=F+2,T=F+1;for(;C<M.length&&!Ut(t,M[F],M[F+1],M[C]);)if(L(M[F].x,M[F].y,M[C].x,M[C].y))T=C,C++;else break;F=T}return M=D.length>=2?D:M,Qt(t,M),M}for(const[M,B]of R){const I=u+M,L=x+B;if(!p(I,L))continue;const D=L*l+I,F=t.cost[D]||1,C=g[P]+F;if(C<g[D]){f[D]=P,g[D]=C;const T=Ue(I,L,r.x,r.y)*Math.max(1e-4,t.minCost)*.9999;m[D]=C+T,v(D)}}}return null}function Xt(t){Yt(t.grid);for(const e of t.buildings)if(e.kind!=="hq"&&e.kind!=="path"&&e.kind!=="house"&&e.kind!=="farm"&&zt(t.grid,e.x,e.y,e.w,e.h),e.kind==="path"&&je(t.grid,e.x,e.y,e.w,e.h,"BASIC_PATH"),e.kind==="house"&&e.done){const o=e.x+e.w/2-y/2,i=e.y+e.h;je(t.grid,o,i,y,y,"FAST_ROAD")}for(const e of t.trees)Xe(t.grid,e.x,e.y,e.r);for(const e of t.rocks)Xe(t.grid,e.x,e.y,e.r)}function qt(t,e,o,i,n){return Ie(t.grid,e,o,i,n)}function jt(t,e,o,i,n,l){const s=e.dangerMemory;if(!s||!Array.isArray(s)||s.length===0)return Ie(t.grid,o,i,n,l);const a=[];for(const c of s){const h=e.t-c.time;if(h>=20)continue;const d=h<5?c.radius:h<20?c.radius*(1-(h-5)/15):0;if(d<=0)continue;const A=10,p=Math.ceil(d/y),f=Math.floor(c.x/y),g=Math.floor(c.y/y);for(let m=-p;m<=p;m++)for(let b=-p;b<=p;b++){const w=f+b,v=g+m;if(w<0||v<0||w>=t.grid.cols||v>=t.grid.rows)continue;const k=w*y+y/2,S=v*y+y/2;if(Math.hypot(k-c.x,S-c.y)<=d){const P=v*t.grid.cols+w;t.grid.solid[P]||(a.push({idx:P,originalCost:t.grid.cost[P]}),t.grid.cost[P]=A)}}}const r=Ie(t.grid,o,i,n,l);for(const c of a)t.grid.cost[c.idx]=c.originalCost;return r}function Rt(t,e,o){const i=Math.floor(e/y),n=Math.floor(o/y);return i<0||n<0||i>=t.grid.cols||n>=t.grid.rows?-1:n*t.grid.cols+i}function Vt(t,e,o){const i=Rt(t,e,o);return i<0?!0:!!t.grid.solid[i]}const z={house:{category:"Housing",name:"House",description:"Provides shelter for 2 colonists. Colonists can rest inside to recover fatigue.",key:"1",cost:{wood:20,stone:5},hp:220,size:{w:2,h:2},build:100,color:G.house,popCap:2},farm:{category:"Production",name:"Farm",description:"Grows crops that colonists can harvest for food. Takes 2 days to grow.",key:"2",cost:{wood:15},hp:120,size:{w:2,h:2},build:80,color:G.farm,growTime:1},turret:{category:"Defense",name:"Turret",description:"Automated defense structure. Shoots at enemies within range.",key:"3",cost:{wood:10,stone:20},hp:160,size:{w:1,h:1},build:120,color:G.turret,range:190,fireRate:.6,dps:30},wall:{category:"Defense",name:"Wall",description:"Blocks enemy movement. Essential for creating defensive perimeters.",key:"4",cost:{wood:1,stone:0},hp:150,size:{w:1,h:1},build:40,color:G.wall},stock:{category:"Utility",name:"Stockpile",description:"Increases resource storage capacity by 100. Colonists will store materials here.",key:"5",cost:{wood:10},hp:140,size:{w:2,h:2},build:60,color:G.stock,storageBonus:100},tent:{category:"Utility",name:"Recruit Tent",description:"Attracts new colonists every 60 seconds. Requires 15 food per recruit.",key:"6",cost:{wood:30,food:10},hp:140,size:{w:2,h:2},build:80,color:G.tent},warehouse:{category:"Utility",name:"Warehouse",description:"Large storage facility. Increases resource capacity by 300.",key:"7",cost:{wood:40,stone:20},hp:260,size:{w:3,h:2},build:160,color:G.stock,storageBonus:300},well:{category:"Production",name:"Well",description:"Provides clean water. Colonists can collect water here for food production.",key:"8",cost:{stone:25},hp:160,size:{w:1,h:1},build:80,color:G.farm},infirmary:{category:"Utility",name:"Infirmary",description:"Heals injured colonists within range. Essential for colony survival.",key:"9",cost:{wood:30,stone:20,food:10},hp:200,size:{w:2,h:2},build:140,color:G.bld,healRate:3,healRange:140,popCap:2},path:{category:"Utility",name:"Path",description:"Improves colonist movement speed by 50%. Cheap way to optimize traffic flow.",key:"0",cost:{wood:0},hp:1,size:{w:1,h:1},build:5,color:"#475569",speedBonus:1.5}};function pe(t,e){if(!e)return!0;for(const o of Object.keys(e))if((t[o]||0)<(e[o]||0))return!1;return!0}function De(t,e){if(e)for(const o of Object.keys(e))t[o]-=e[o]||0}function be(t,e,o){const i=z[t],n=Math.floor(e/y)*y,l=Math.floor(o/y)*y;return{kind:t,...i,x:n,y:l,w:i.size.w*y,h:i.size.h*y,hp:i.hp,buildLeft:i.build,done:!1,growth:0,ready:!1,cooldown:0}}function Zt(t){const e={};for(const o of Object.keys(t)){const i=t[o],n=i.category||"Other";(e[n]||(e[n]=[])).push([o,i])}for(const o of Object.keys(e))e[o].sort((i,n)=>i[1].name.localeCompare(n[1].name));return e}const Jt="data:image/png;base64,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",Kt="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAwCAYAAABwrHhvAAAAAXNSR0IArs4c6QAAAX5JREFUWIXtlT1ug0AQhcdpkj51hBuLLnfwFbjD0CIfgIoDuKOI78AVcpUg105ad6TJQ+Nhf1hix1I0n4QE7O57s38zRIZhGIZhGIYRoWrz4Zb6D/pH0WSjYdXmw/F0niUkx/0aiElRbbDdrSff6IO2xUEVTQYxDhm4xsm2OWMmW0BE1NV9KT6ZiPh9/7FSQqyGMRHR6+bROQbvKbB4sJz8E8CFOdqqNh/ku+qvAw6bV20+4AaoLZkIoR2m+IdvMX5CaFm4aLK3l+cnOp7O2JaDrzMMxPYd5C3q6t7p5TwDEOjqvhTX0GuujMcJCPOSErdgRN+GCHKLOLRtf8VdzW9DKDuClPoROoTRIL4+V5NAUurHLBOIilmxTrmyf0r9iAaAZOKqC+TIhkvqRwjWonIVfP3JkcK3u/XgCjqKFhSrIdsvgtDm5KkfcxnFMPtAfk+qH1H0IYQYhD0Zkn3nZhG6tOKJiAerXwr6EErD4MyuMnsZxLXEFgdxT3Pj//MNvPQlpMCKHrIAAAAASUVORK5CYII=",_t="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAwCAYAAABwrHhvAAAAAXNSR0IArs4c6QAAA/VJREFUWIXtVjFrG0kU/jYEZLa5tQWb5JCRmxCSQpw6FUfATcpA5OJKFWY3xk3wD5AL6wcIN0FZ4cJlCqlImUZNCnc24rjD5OAkEL6cCnmdQhDwsVdE3+TN7KwiX1Ideo3Q7Lz3vve9N98MsLSlLW1p/ydrdSrJTX1ufU8A43h6Y5+FALQ6lWSR6nzPxcFR6UYsLARgZ+vEAWANLoGN4yl8z7XGyCpg4RZkBR/HU7Q6laTaKCb7230r0FankmS1JwUgC2lWcN9zMY6n6NaHTrVRTEyg3E//rwKYB8LGAttDn/3tviOrJcAsSwEw+11tFBUY33PV93KtkDCxyULv149aTFv1BHzLXLDRSBCv330Ak58ejxz21mRBGn3M5GRFAeAwAcDZxRXIQrc+VBX/8vNdtYdBzOq69aGzuvYZx+behgJERk0/BYALP/34A4DPrZAsPHu8BgB49WaE0+ORYyY3e0/Wes2BU64VEsYy2dVmgB+fPLqHaqOYkL4///hHG6ZWp5KQJWlcu5x8IYXtoq+coxQAViErYQAA4HBx4ACdZlqvOdDacnBUUgyYM5E6BWcXV/A9V7VCDhv/s9LNvY2k1xw4L14+0EAQVDy5xunxyLEdRZ6i1Cno1ocOW1G6nwOAYMZOGE+uv3rjMTkZovmeq5LyVwMgJZUV5nM5AMDb3/4CADx/WlCVsHr6SxbICltH89Zuq/bwmwJAmtbzKwqQ77l48fJBBAAHR6WITIiYAQAc7p5bZRZAwPa9ejOCWb0GgJP58M4qmGiepPaaAwWk1akkD++sYj2/AmrAjJXIJt+SGW0IZZJqoxhZJDUEgG59qCU3wQMIDnfPw3wuB99z8frdB5wejzTmUlIsWXjy6J5aO9w9D4FMSY0IeGfrJBzHU82XlceTa1l9KP0y3wNSUqWwcBYYRKhh23bcxvFUVd9rDkIxS/oQ0iySGtG5XCtEs6raGVdzOHuWRVwzFdMEaWUgQ1KjeZI6034JrA1o89K2sDb/SbaopLY6lYRvARl8BrZNMED6baAB+BZJNd8TwJe7g99tL6NMBrIkdX+775iSurN14vAErOdXYB5fmu0GTQGYJ6mswCapkp3S/Zz2lCvXCknWDaoBmCepAIKziyvrhUIWfM9VMQRzgazevEOsLbBJKqCfClk9Wfv970tUG8Wk//6TWivXCpG3dlsWolkKgMFCQCWkHpiSKkAm9JX3hLTNvY3I/GZjILBVC6Ql1QJaAeq//8TTE/aag9CIp/bZALRZtbTLiaNJKvcKECFbtbm3YWPLykzmMZSbbYBkclh6ayYz/rexgAUicGD8z9w/O37m3kz/rGP3X00mWKjKpS3tX9TH+YSAxDb2AAAAAElFTkSuQmCC",$t="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAwCAYAAABwrHhvAAAAAXNSR0IArs4c6QAAA+pJREFUWIXtVrFqG0sUPasujbE3gd3OpFAcgjAYF8GBly6FCz+cIriUEbugL1iBPsCg/QLBChOXIUUMLlykS2GRIizoiYDiwiiVBI4wacxrvK+wzvjO7Kwiv5fqodsIzc6999xz75wZYGELW9jC/k+WdqvZfX1KvxPAaDy5t89cANJuNZunOt9zcXq8cy8W5gKwsXXkALAGl8BG4wl8z7XGKCpg7hYUBR+NJ0i71azdqmTbuydWoGm3mhW1JwegCGlRcN9zMRpPUG/0nXarkplAuZ/+vwQwC4SNBbaHPtu7J46slgCLLAfA7He7VVFgfM9V35u1csbEJgt/nQ21mLbqCbhkLthoJIiPH1Iw+cHhucPemixIo4+ZnKwoABwmABgOLkAW6o2+qvjV6w21h0HM6uqNvrP08AYAEEfrChAZNf0UAC6srj0GcNsKycIffz4FALxPznBweO6Yyc3ek7Uo7jnNWjljLJNdbQb48fnLTbRblYz0fR/8rQ1T2q1mZEka137+uAvLdtFXzlEOAKuQlTAAAHC4OHCATjMtintaW06PdxQD5kzkTsFwcAHfc1Ur5LDxPyuNo/UsinvOu7cVDQRBXV1e4+Dw3LEdRZ6i3CmoN/oOW7H67AYAgik74dXl9S9vPCYnQzTfc1VS/moApKSywqXlWxY+f/oCAHgTvlCVsHr6SxbICltHW370QLWH3xQA0rTi3QHyPRfv3lYSADg93knIhIgZAMDeft8qswACtu99cgazeg0AJ/PJ2iaYaJakRnFPAUm71ezJ2iZWPIAaMGUlscm3ZEYbQpmk3aokFkkNAaDe6GvJTfAAgr39fri0/Bi+5+LjhxQHh+caczkpliw8f6kCYW//NlmBpCYEvLF1FI7GE82XlV9dXsvqQ+lX+B6QkiqFhbPAIEINO7bjNhpPVPVR3AvFLOlDSLNIakLnZq2cTKvqFFzN4fRZlnDNVEwTpJWBAklNZknqVPslsA6gzUvHwtrsJ9m8kpp2qxnfAjL4FGyHYID820AD8F8k1XxPAHd3B7/bXkaFDBRJ6vbuiWNK6sbWkcMTsOLpiaXZbtAcgFmSygpskirZWX12oz3lmrVyVnSDagBmSSqAYDi4sF4oZMH3XBVDMBfI6s07xNoCm6QC+qmQ1ZO1b4MvaLcq2fBrSa01a+Vk+dEDWYhmOQAGCwGVkHpgSqoAmdFX3hPS4mg9Mb/ZGAhs1QJ5SbWAVoCGX0s8PWEU90IjntpnA9Bh1dJ+/ihpksq9AkTIVsXRuo0tKzOFx1ButgGSyWHprZnM+N/BHBaIwIHxv3D/9PiZewv9i47dvzWZYK4qF7awfwAJR/sa22/msgAAAABJRU5ErkJggg==",eo=""+new URL("Male_Average_Normal_east-Dp-W028J.png",import.meta.url).href,to=""+new URL("Male_Average_Normal_north-jjTiChVU.png",import.meta.url).href,oo=""+new URL("Male_Average_Normal_south-ChBeJhbM.png",import.meta.url).href,io="data:image/png;base64,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",no=""+new URL("Naked_Male_north-B44-odFG.png",import.meta.url).href,so=""+new URL("Naked_Male_south-BtPFzGMg.png",import.meta.url).href,ao="data:image/png;base64,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",ro="data:image/png;base64,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",lo="data:image/png;base64,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",co="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIAAAACACAYAAADDPmHLAAAACXBIWXMAAAEbAAABGwGN907lAAAIRklEQVR4nO2dT0wTWRzHf22hxahZNB70JEa8YcALbmJM8OQRjJdVD+J6ENyDekFvirf1oHhYE3c1gAcTvSxs1uxywjUxMTErxUSThRhw1cQ9ieLB0NLZ/F7fm755nSKUP/0NfD/kZabtQKf9fX9/3pv3BgIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAsomtMvu0LODYSd3WNFEXQBsRtWrD15X5N6aIKK3bqLUPhFJLRJeI6AMRecvUJoioVwsMCKJtmQ0f1vj9ri0iwogmKimgVhuh3X1h27Zt1NLSQnu/3Uu7G3ZTXV0dJVNJSlYnKZnMt+rqatVs0uk0TU1N0eTkJI2OjqrHDx8+/Np58AHdersqiIIA2PjDRNRkP9nY1Egnvz9JzXubfUOnkqki4xsBxGLz+6gsgsHBQRoYGFDiKHUYEZ1YDUWkdAEUGX/Dhg3Udb6L9u/fX2x4s58MCiAej5f15iyG/v5+6uvrK3UIR4MeXUhGEukCGLa7djvrd9Lly5dp69atVFVVRalUyje+b/hUUAR83GLhVHH9+nXq6elR+w5pHQ0i2XNICDiHUnDO/868xsa/evUqbd68WYVzk9cDLVmtwj/vG+PPN/TPRU1NjaozOjo6aN26dW6tsFWf539RFIHUCNCivV/BHn/z55sq/DNViaq8pzsRgB+rNKC3icTy6JsLxhMnTqitA0eCkvlCIhIjAOf9P/RWwZ7PImDYo9mzQyOAjgK8XSrvD4PPhaPBx48f6cmTJ/YR3E19HaVIUF51tLyctfvcp384rcK/gY2aiCdUYadaIq483W/x/P5yGd/m2rVr1Nvb6z7d6/ZYJCNNAOz1Z8wD7uodPnw4cEDA6PFEQQyJwvPlVv3l0N7eHiaCYTuCSUaaAC7aX9zx48eLDvA93xg9HveFsJLeb8Mi4GhgUasjgXgkCaDWHuk7ePAgNTY2Bg5gwwYEECuIwG6V4OzZs9TWFrh00LbAq5MVQZIA2mzvd0M/GQHE4oVmRGAZf6W934ZTQW1tIPJfrNjJzBNJAgjkfrvwMygDx2OB5np/JQXAxudIYNEivSCUIoBa+4vi8B8GG9eNAuq5eMzfVpozZ864UaC4kBGEFAEEcqWb+w1GAH7T0cBOB5WGjR9SC4hFigB87+dBFjPoY1Nk/BJNAq2trfZZ1ElOA1IE4Lv8zp3Fud9gjM4D2Gpf/5jHUnAiAEnuDUiqART19fWhBxgDK5PbItBCsI+RAF88sgjPaQIQlwLWb1hf8iBjeNJCKLwgy/hULACx08kiEwFCiWnjC7youX37dvshUsCy4Mk9NZ6bGAUkCGD+F008e9fzn/MkK6GASEVIEEBwsmeJMQDP8/KG9gpCCIiAX/fkCMGpAQgCWAq0t6sfzwsYXpLxSc8jjAKLnzG5xHz+/Nmf+uXyafoTbUltCRjdbeX2BngaOE/85Kngc0wHp6amJjXax1su9NjTed8lZLqYyLUEEgQQ+GJevXoVmgbYuLdv36aurq45BVAObKxDhw7N6zeNYe2JoSwIFgKPAPIgkHMtQDRS+k++5dj7eRpY2AWhY0eP0eBvg/nJoLrVpGoCjxc6DZy9fc+ePUsasnmCCGOtJ+CQsmPJ3mAJkZIC+sxkEE4BV368op60RfD48WN6//49jf0zRg0NDeTlPNVyuVygLRT2fMf4fC79Jf6MuWr5jd6G9u9DFpKIXUomRQDndJXsf6E3frpB+/bt8+uBoT+H1JbrgJyXC7Zczt8upA44d+6cm6v79NTuuRhwXmuylqmXuuhTSlAVR0ovgF3wgP3lcyQYGsobnT2fIwDz7O9nRV6v2mxhfz5wDueVPhZpLcSFktbL1ffoMG8vFZvSn0lsBJDWDeyzvyxj9Dv9d/wDxsbHwgWQW5gAeGGHhTHUYguBSS2iTVoMm6QvFJE4DjBodkbToyoSGCEwI89Ggl4/m6PZ3Gyhzc5+VQTd3d1uV697GRZzRGLlsMSVQV+IqMM8ePPvG9U1NMzMzNCu+l1Ut6MusBbAXiwy19oALviOHDlCX77w2yjS88j7qxaJESDgibb3Gx49euRHAPb4sFZqTIAHe5yqv5y8v2qQOhTsVtoBWAC8Lo9DfpgIstms2obhFH4PV9PdPspBqgC6Qwoy31BcFzz4/UHe2LPZgvGzhccsArcW4OFex/u7l/lziEeqANK6W9Wt2wHdfBHcu39PGdw2vDJ+Nm98IwQ7FfCtXyy4SFvT3k/CbxAxZYVoU1G/tkcMeZCoYXdDYWp4LB6YKm4vJSPd9bOKP+6eDVXos4khajOCAjmbLw5xSLcjgPL+bJYy2Uy+ZTIqFfDAjxP+xY7OrSRRnBLm522OArd+uRUwfKBltBgyGRoeHrb/xhTuBponigIIRIH79+/T06dPiw2fyfoRgJ9z7uuz5nO/IaqTQgPDthfOX6C3b94GvT6bCYiAbwZp8VcFz10UURXApJsKeKLIhw8f/NxvG39kZESNG1gg/GuiPC28x77QMj4+Tp2dnXkRZDJ+YyFMTEy4v4sUoIn2uoD8MK7vzeNj49TZ0UkvX770vX8mM0PPnz+3fwfev8rgWToj9l2+N27c6N29e9dLj6a9Fy9feM3NzfZdwCNx756VIuoRgKzJJH5Yn56eplOnTtHArwMqCrx7984+/nVFzhKsCL3u/f6PHj3q/g8A8TduAovj0lf+AURkbuIIyqe9xH8WKeoOgNVLk1McTsD71yai79EDAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAGIjof+Xf8eJsiF1GAAAAAElFTkSuQmCC",ho="data:image/png;base64,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",fo="data:image/png;base64,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",Ao=""+new URL("Bowlcut_east-BqNLAYRr.png",import.meta.url).href,uo=""+new URL("Bowlcut_north-CedmSNiQ.png",import.meta.url).href,po="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIAAAACACAYAAAG0OVFdAAAACXBIWXMAAAsTAAALEwEAmpwYAAAFHGlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS42LWMxNDIgNzkuMTYwOTI0LCAyMDE3LzA3LzEzLTAxOjA2OjM5ICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIgeG1sbnM6cGhvdG9zaG9wPSJodHRwOi8vbnMuYWRvYmUuY29tL3Bob3Rvc2hvcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RFdnQ9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZUV2ZW50IyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ0MgMjAxOCAoV2luZG93cykiIHhtcDpDcmVhdGVEYXRlPSIyMDE5LTA5LTI4VDEzOjI5OjE4KzAxOjAwIiB4bXA6TW9kaWZ5RGF0ZT0iMjAxOS0wOS0yOFQxMzozMTozOCswMTowMCIgeG1wOk1ldGFkYXRhRGF0ZT0iMjAxOS0wOS0yOFQxMzozMTozOCswMTowMCIgZGM6Zm9ybWF0PSJpbWFnZS9wbmciIHBob3Rvc2hvcDpDb2xvck1vZGU9IjMiIHBob3Rvc2hvcDpJQ0NQcm9maWxlPSJzUkdCIElFQzYxOTY2LTIuMSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDphNGY4M2QzMi1kMTA0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",go="data:image/png;base64,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",mo="data:image/png;base64,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",yo="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIAAAACACAYAAADDPmHLAAAACXBIWXMAAAEbAAABGwGN907lAAAF50lEQVR4nO3bP2hTWxzA8V/ew8WqTQaLQ7HNoojCiyAWitDUSUR5AQcdq4JO8tpNB23AQScDuhtXpywub9BUdFCXOii8yVTBQZfGv4u25/E7nt/lJE1VpEoOfj8QcnP/nHPt73d+9+TmKgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD6TO43CcioiFRE5K+wXF5lvzkRWRCRu9EyEqWBropIS0TcD77mRWRaRPIkQTo08PXvCfjg4KB/fWdy1EPb6FP51QKfz+fd+Pi4q9VqrtlsOnPq1Ck3MzPjPy0uLvptuo/u+5VEqFER+o+W6cXuYJXLZddoNNyDBw/c1atXXez27duuUqn417Nnzzq2Xbp0yd27d8/V63XfRo8kWAxziuT9kfg/QEdio3tUjo+PS7PZ9K9KpSILCwvy8OHDjgOfPn2aLT969Chb/vDhg9/35cuXMjU1lbWjbfbot556NUg5AfQP34xH4ujoqFy4cEGKxaKMjIx07GyBNa9fv86Wnzx5ki13J4rStoaGhuTcuXOSz3fEeyqcQ7JJkGoCWPBLtmJ6elrm5+dleXnZB/vatWsrDtJK8C299rl8+bJ/37Rpk7RaLV9VIqWUkyDVBOgIfr1el1qt5kenjWYNlI3mzZs3+/d4pOuINrt27cqW9TgJ1UTduXMnqxZ6vPbRaDR8n5FSuBwkJ8UEqMbBP3DggBw8eLDnjjaax8bGVmyLE8CCLeFSIVFSxBXBtqmJiQk5cuRI3GQlTEaTkloCaKRm7YOO+j179nSUe73+dxsYGPDrbXSrnTt3Zsu63eg+mjC2Lj4mTqTr16/Ljh07/KUnMpvapSC1BMiCXy6Xsz++lmYr74cOHcp2joM3OTnpR3A8+TOWNLb/3r17e3ZubeulRfvTJJmdnY0rSD61KpBSAuTDrNvTP7xEpVq/qqn9+/dn5T0Oto1eC3J83e8e7fFItza0ze6+tIronMDOJfhnjf/dP1VKCZBNvUulkq8AEka2dH19O3r0qH/XgNp1WwOogY2v6Rr4OBF0myaQJYQG3xLgxIkT2X5WbSxR9H5BVxVI5iZRSgnwty3oBMxoYDVoGmgLjH62wMYzfy3hcaJo6Y8ng7pvr0uItmXB1uO1r8OHD3ccG59TfK79LqUE8EN+/fr18vz5czl9+nQWIB3xOmqtNEsYsbouvuOngdR1VhXiBNCRbpNFo3cIdd2ZM2dWrIurjJ7LmzdvZN26dbZb9i2l36WSAKM2u9YEkBCw8+fP+2BqEDUgNjolBFeTIK4AEpLFyrpew23Cp8fFZV5CRdDgx0mi9wUs4ewcrL3BwUE7NJkE+LMPzuF7lGwCqAmwdetWf8inT59k27ZtMjw8LNu3b/d3Atvtdlb+NQl0e6FQsC4eDw0N/VcoFHQiMDc8PDxXKBT+1ct/oVBoh/VtEdkioWLEc4Rbt275wJ88edJ/1oS7f/9+tv3Fixfy8eNH+3g3hQdKUqkA2Xfrffv2rSjT5uzZs37URjds5orF4nER2Z37Qt8nw+t4LpebyeVy1bBs6/2+ekyxWJzRpJEw+q0i9OpbzylOFqytqv0UW61W3fv37/3v+PZz7qtXr7KfcnXb27dv551za1aGnXPld+/etbRto31a/3ouuq3rp+PVHjvrK0n+FqBl+OLFi1kluHnzZrztxsaNG3UkP16r/nK53NyGDRt2DwwMZG3qnUAJI1/PJb6bmJJUEqCdLbS/LOof/MqVK3Ls2DFfmsM3ghuhnLe/0tYPCW3qTYfH2pe+dNKo55Bq8FNSttI6MTHhVqFl/6ffh9c+nHOtXqeQ4iUgFVkCjIyMuM+fP3cHYNE598se2NT5RXfwl5aW5vXZwygBeG5wjcXP/I0uLS1VnHN155w+5fnLb70656ZD37Xl5WXr386v9Y3D8QOmEiiv9sBoMjeCUmOPX1X79Lwb/N8BAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPj9iMj/edM7Dd9CxrsAAAAASUVORK5CYII=",wo=""+new URL("Bravo_east-CJd2Z9hg.png",import.meta.url).href,bo=""+new URL("Bravo_north-D1RfI44O.png",import.meta.url).href,xo=""+new URL("Bravo_south-BjW4bVxW.png",import.meta.url).href,vo="data:image/png;base64,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",Mo="data:image/png;base64,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",ko="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIAAAACACAYAAADDPmHLAAAACXBIWXMAAAEbAAABGwGN907lAAAFy0lEQVR4nO3cO08bWRQH8LOPYiOBmC5GWhYjEkpw78YSEe1CEVpwuRWPimaz3pYiZj8BJFK2QNrAF8jaSHFaGySqYOGSDq+E5PGMzazOZe5wZ5ghxtjmDvx/0tWAbZyTOec+ZjxjAgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABdfffEM5MiIiPiuQoR1QccD/TZMhHtEdE5ETkdtjIR5YloHsmJL0786R2SHtW4cLaJKPnUd2hc8PBe6EHiw9r2LdNHbDyGNYDhzuUZ5bGKu80He2symaSVlRVKpVJkGIbYhikWi1Sv1+ng4ID29/epVquFvYzXCFki2u/ffw+iJN1e2FGPNQzD2d7edrpVLped5eXlqPfPI0uDlbvLcD0/P++cn593nXzV6empeL+IKQH6zIjq9clk0slkMk4qlfI9zr22H3g04VEFRTA4hntIdiPB3CtVq6urfU2+xNMCimAwbiSfdzwnICwp/DyPBIPAxcejT6AIck8hKYPkSz4nN2pO597PxdGrOb8TESNBRp/dF2/5TpPPeB1QKBQGlnxJjjxKO30M5wkeWuYuyWe5XG6QeffJ5/M4POyxwrfmfN3wCBQoApw27pKv929ubjrtdlv7AqhWqzgq6BHveH9kZMSp/1d3LMvSIMW3M03T2djYiM0o8L0GMUTxVtGvF19Tu9WmVqtFjuNoF6h0eXlJrXaLFhcXg09p+1GyrgVgqL3m1ewrslu2aFwEuuLYWnaLRkdHaW5uTo3yV11j1rUAfB/RvZx6KXYsN9u2RU/TTbvdFrGJ1rJpdnZWjVDbcwLaF8Dw8DA9++mZ2LGWbXk7WSc8LXnJd9vzxPNghFquA3SeAoSpqanr5FvXRaBOBfx5/UPiWESM1nWBzszMBCNCAXSDe5cv+dbVjm5aTTHssoWFBdra2nqQ+Dj5zWZTxMPxiSKw9BulomhfADzfyxFAJp53uNW0xFYWwdramigEvopnUGTyOS6OR2xtyyvUONB/BCDnasfK5u5o2et4K/FUMDExMZApQe353gjQVOK0rb7H0AvaFwC5K+xg0kUz/QXAeATgkYBbxHV89yIXfGbT9MUgRiQ5OlmWlkcqYWJRAOT2OK8IlPb15Gvo6+VokM1me1YInFSOwTRNkXguAlkIcsvP63yuIig2BSB7ntzZopkmVU+qwZf6FgE7OzuiEHhE6HZqEIm3rxLfaDSoYTbEz2ohyKKMy+JPik0BULAIzKsiODo6Ul/CyZ8gohuHBJx8LgIuBl4w8u+3LRj531J7vEh84zrxXhE0TW8aiFvy2Y8axBDGG7MPK4e+p2UR8Jbb8fGx+rS8n2+NiP4ioj/cu4I8PB3wIaM8bOT7AjKZDI2Pj4ufx34Zo7Gfx6h92RZrD/kZhDgN7Z6JLH0picemp6e9RV9w2D889Met3KugFe0LgJ2dnVEikfB+l0XAPbRQKKgvrQTeg2/a+NMtgqWwkzGVSkW0+5h8MUlLS0uUTqd9MQdoeaOprlNAUf0lpDcJu7u7dHFxoT70LuRlNfciTZ4aFtzpoaeHB7wOefP7G1/SA2uTYtjf6UDnNYDXLUufSzee5B38/t179aFaB8Psvjs9TLgt6xZEsRc99OM/H72fSyVfzFoO/6TxFEBubxYfCvHOVKcB7vXr6+vB3p+94/tzweyEPN7JJ3cyoRzfivy8/6R6Ih7kESswBRzcMTZw52vvqpqZ1Izz6d9Pzoe/PziTLyZ1uvgyF4yRt0ps50hm93yXhKfTaWdoaCiY/L0HjtFXAG/zb3GTSA8Z3/hih7IG197vqQWQSCSCvR/3BtxTKuIrXXS52va2L6BY1SC+RyGl9LRy8OTOA9uLSH7hUWYCbshoOjV15IcYxKi7mnKYV3cPX3/DV8wBAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwBUi+h8ZD3DYjvMBvwAAAABJRU5ErkJggg==",So=""+new URL("Cleopatra_east-B3qqZTHk.png",import.meta.url).href,Co=""+new URL("Cleopatra_north-DFb2lqEL.png",import.meta.url).href,Ro=""+new URL("Cleopatra_south-DYRggimK.png",import.meta.url).href,Bo="data:image/png;base64,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",To="data:image/png;base64,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",Io="data:image/png;base64,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",Po=""+new URL("Cute_east-DYRGxF50.png",import.meta.url).href,Eo=""+new URL("Cute_north-Dyfz5Iyy.png",import.meta.url).href,Do=""+new URL("Cute_south-CSpoY84q.png",import.meta.url).href,Fo=""+new URL("Decent_east-DDtNv2Dw.png",import.meta.url).href,Lo=""+new URL("Decent_north-DK7xoZDS.png",import.meta.url).href,No=""+new URL("Decent_south-DVJAzXst.png",import.meta.url).href,Wo=""+new URL("Elder_east-CcqrTIrj.png",import.meta.url).href,Go=""+new URL("Elder_north-IBsD-VXD.png",import.meta.url).href,Yo="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIAAAACACAYAAAG0OVFdAAAACXBIWXMAAAsTAAALEwEAmpwYAAAFHGlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS42LWMxNDIgNzkuMTYwOTI0LCAyMDE3LzA3LzEzLTAxOjA2OjM5ICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIgeG1sbnM6cGhvdG9zaG9wPSJodHRwOi8vbnMuYWRvYmUuY29tL3Bob3Rvc2hvcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RFdnQ9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZUV2ZW50IyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ0MgMjAxOCAoV2luZG93cykiIHhtcDpDcmVhdGVEYXRlPSIyMDE5LTA5LTI4VDEzOjU4OjMxKzAxOjAwIiB4bXA6TW9kaWZ5RGF0ZT0iMjAxOS0wOS0zMFQyMDoyMDoxMyswMTowMCIgeG1wOk1ldGFkYXRhRGF0ZT0iMjAxOS0wOS0zMFQyMDoyMDoxMyswMTowMCIgZGM6Zm9ybWF0PSJpbWFnZS9wbmciIHBob3Rvc2hvcDpDb2xvck1vZGU9IjMiIHBob3Rvc2hvcDpJQ0NQcm9maWxlPSJzUkdCIElFQzYxOTY2LTIuMSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDo0YzM4NTlhZS03YjM0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",zo=""+new URL("Fancybun_east-_VNdpRKg.png",import.meta.url).href,Ho=""+new URL("Fancybun_north-jN5WcBOL.png",import.meta.url).href,Oo=""+new URL("Fancybun_south-DplcV99p.png",import.meta.url).href,Qo="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIAAAACACAYAAADDPmHLAAAACXBIWXMAAAEbAAABGwGN907lAAAEWUlEQVR4nO3bv08bZxjA8cdxaRYj2MqELMHQIJA9sNWobJaY3H8gYWwVEJBK6WqUDmUiiAGJAcMW5EollRgJRsJKJZAwaga2ABNMZmBCwm/1vr077g6bGpSi8+vvJzm9vjtz3PE873M//FoAAAAAAAAAAAAAAAAAAAAAAAAAAABaVFpERp1d7xaRaRHZFpE/fMutE2uDbNXBHBeRlIgcisiqiFz41uvgFkQk6cwfO20ytJ1Zp72osw1ElO7VVRFRvunASQptPLSu2alaJ0EQMfWC7075ZoKfTCbvWl8g4NH22R+wzs5Of/Cq4eSYn58PBHh8fFxpdyTBdrv/gaMs7w/W2NiYWlpaatibV1ZWTLBzuZyZ162rUCiYZel0Wk1PT5MALcLr/f39/Wp3d1ft7e2p4eHhW8GfmJhQ19fXJty6CnR3d6tqteolgH6tE0K3+XyeBIi4bicwXqDe/PpGlctltb+/r4q/F28lwNHRkarVaibYBwcHXumvZ3R01LprgCcR2IcvaTt8z57JZMzNbiwWk2ffPpPJyUlv3cjIiCSTNxfz6XRapqammt2dk6gd/EPYlAB558rf09ffZ17q4JsnHjExAR4YGDDLdQK4yeHSSdBIpVLxr7HiOYAtCaBLv9d1e3p6TJtIJLw3xJx/+n+xWJSuri4ZGhoyS5t1cRGIeaXpH4wwWxIg53u4I69/ee0lgTjBdyuApoO/sbEhvb29Tf+CUqkUXnRc/52txZYE+N59oct+KpWS5y+e36yt08kHBwdNBWhWnfJPAkSIdyWX+S5j2mw2Kz3fOFXAvW4Xd1bde893dnb8s1aUf7HwLiBAnwrECbgJuu8m7r5JEDoF7DR+Z2uxLgEuLy9vL1RuowLJoJTyprusrq6GLwA3HuVgHoEtCeCV5HK5HFhhAiwqGOx7BF9bW1vzzx5zCogerySfnZ2Zyc8f7EZTI7Ozs+Hyv2DJ38ywJQECJfn8/Nx7XS/gNVW7tSxMl/yZmRnJ5/P+Nbr3v32sg3oMX1l0LBX3SeBh5dDcCrpMkGsq0NZqtcAUj8fNrZ6e9BW/fk4QOu9rPzz+Yf2/bEoAL1rhU4AJtqoF2tPTU9na2pKPf32UT39/kpOTOx/t623P2HTud9mUADvuB0H6QlDfDbiPgsM9fuHtgiwuLja73ZKtwdfiEdiHL0X30h/1tq6uruTp108llb45DegSH38Sl1c/v5L19fX/+pU62O9E5CcRmdNFJfqH/zC2jQoOfBy8vLzsfSLY0dEhc7/NyebmZvhnSk71KDlJZGVPbxdp/2CPvv4+9f7P92rrw5Z6OfEyPBhEjxpq/NkvWlZgPGA2mzVJkEgkwoNC235Yt80O/EmQSqfCvd/ab/rgX8k7vhPAYM42kWuQAPT+NpLzDRH/7HwbCAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAeSkT+AUPibJk5WdyzAAAAAElFTkSuQmCC",Uo="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIAAAACACAYAAADDPmHLAAAACXBIWXMAAAEbAAABGwGN907lAAAE50lEQVR4nO3bPU8bSRjA8Qd8bZCTlsbXHSjSbYMo0rgkTeLLBwgOSm/zDeATEEoqA31EIkVKCW1eFLiCJkjYlwRxSARM7AtnjHdOM/aYycbGdg47rP3/SaNd74tnvc+zM+P1WgAAAAAAAAAAAAAAAAAAAAAAAAAAAACERCTkgYqJSEJE4iLyt4jke1hvUkR+E5GciPzbo3rhmBMRFSjJHpygZIN65whMb603CIIuxyIS7eKRRGt1NKo7cx1PVD9aaBIAW+Jd/MzxFnUvDG5YeiPmnvBoNKo2Nzd/WgLouvUxBOqPXacT1m8ywQBoPysBtAYJSFfQRfX+N5lMKitwFbYaCCZqTbUeRxzXynptWaLFvkm39bH0sQTGIegCr9HVr8Xj8Vb9cLQ2Um82gAsGcK7JYLI+/tB1Wg1aAY8EuHqJYPNrpdPpYADdflhftdk2Ah8s2UBr4rkJpOt0BfZt1ZLgB9S/93ue983JX19fb3YVNw28brYXFhZMCTThjRLhu9ZD1+nSx8R9ge6qJ4Db/DbphxsWvZ8dL+jAW3re9uuB7qRp8gQF9iMBuuDSBLgsCWKxmFpbWzPbJBIJs0xPreCyTCZj9mk3+A3GIaFJgF+uwTFcmUwmI9PT07K4uCj5fF6i0ajcv39fksmLrtzzPHn27JlZb9l5vU7T2+uyvLwsz58/r79XKpWSeLyb3zJ7r68SQNMBuixIbuBbrbOJ0M+G+/rTBegA66tanKvdndfrLkuQfjRQCeA2/bo5t+y8Xqe3GSShTIDq1+7Ozc/P1/dZWVlpOO9uMwhCmwDlcrmjRNja2jJTPZjTNjY26uvsvF1nt+3keH40KX+2UCfA2dmZVCqVtk6+7uez2Wz99e3bt6VUKpmi5y29jTs+aMX3/Y6T8ToJZQLok66Df1Y+M1MdgHYSwR3kPZp5JMViUYr/FGVmZsYscweJ7RyDTUI91a/RXd88inVwcKAOPx+qfD6vCoWC+vr1qyqVSqpcLqtKpaJ85X93s8be3JmcnFTZXFbl/spVSy5nltmbRs34vq/Oz89NPaenp6pYLKqTkxN1dHQUvGEUmu+OYboPkHNfHH4+lFs3b4kf8SUSiZgyPDxcn7plaGjI3BzK5apvoe8TLC0tyds3b83riYkJs+zVq1dmmydPnkg6na737broK9wW3drYqS7Hx9/9ApwLLriuhsJyoM7zeIYO4NTU1EXwI8MSGb6Ybm9vy5cvX0x58eKFrK6udlTZw4cP5d69ezIyMmKKHidU/Grg/Ypfna9Uk+Dly5fy+PFjd/ebPXxCeaBs2mZ2bGxM7ezsqN3dXdOMf/z0UT19+lTdvXu305992y537twxvyns7++rT3uf1IcPH1Q2m1Xj4+Pue2wOepC6Ke0GK/FHQr1+81q933mvUqnUjwR1rVY62m92dtYk3rt379SDBw+C69NhOqFh6gKsrPvAx40bN0wTvbe312q/jVqz/Gdt/uJGQFW8Vn6vdTeX/uozOjoqhULBdDEO3ff/+r8+HVry2ni0a+6KH8vymvwRJfgQCo+C9YjX5M8hm10OgtfkKaP1sAY/jF2Ay6s11dEmzXq32O4iX6uzs3vHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACDER+Q9xEDTIkulSxgAAAABJRU5ErkJggg==",Xo="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIAAAACACAYAAADDPmHLAAAACXBIWXMAAAEbAAABGwGN907lAAAFOElEQVR4nO3aT2sTaRzA8adbxYuSHHrx0saTnmzegDaCFqGX4NVL34CQgEfpZl9BoG8g116koXhy0SgIVnCJXZAuLvYPdu220k1TbbfVJr/lN2ZmnzzOWKlJ7Oj3Aw+dZJ6Z5+nzb57nyRgAAAAAAAAAAAAAAAAAAAAAAAAAAAAA6LpxY0zVGCPGmGljTLqHRZ5upSmtPIxT3b1VaBW+HWrGmGQPcpFspeWmXzhKBfQ9Gw8pfD/0oid+6/Q76qeY5TdljCn6H5LJpEmlUu75XuTh40Eq5eXBUuxRHjombg2gaA/zxWLRbQBDPchDkIamrXmwJO0Gis7K2MNtLpcTVSgU7CG42oMy9yeeXtpK8+I8Cno5If1hlPwCTiaTUqvVvMKfnp52C7+bQ3DKTkvTVpoXzZN1rvSjV1Y31Nze7xe+0wByIWmnW0Nzxe7BIaHailOM6MU5+xq/EYaMArX4Fe/R1jb8V6tVsWWzWbvwF63/JNWq0KgKPyhUnBFl0Y+vado0T869Mj96pXVS0PN0qHWVSqWwUSBsr+CwoeD2fk3T5TwGwkaiI6cvJg1AK+BnPchkMqZSqXwS4cyZM2ZpaSnyBrpcy2az3sx9eHjYXb6Zzc1NMzc3592jXC57n6PoPRYXFz85e+nSJfPgwQP/4y9x2ByKyzIwcVCEUil63pXL5cyTJ0/M1atXzYkTJ7wGoA3JDvqdntM4GlevOUxa6I5i1LPX5i7HUqmU92y+d++ed50GPY7ixtNr9R5hy88wmUwmdlvDcRkB6v7B54Zm3ZQpFP4vdx3O8/m8efjwYfDd8+fPI6+3z+k1eq39WNF7Oxs/6JFgQnfx4kXZ39+P7IWqUqlIOp1u67kDAwMyOjoaOQr4vX9sbExOnz7ddq3eS+95kDiOAHERNIALFy7Izr878uHDB2k2m5+tEp2p20P48ePHveuvX78uk5OT8u7dOy/osX6n5zSO/QgJm+2HaTQbMjIyQgPokmAJlkgkpF6vy/b2tuzt7R04GvgNwV6i3blzR2ZnZ2VmZsYLeqzf2UvNYrH4RRWvjVDzsLu7G8tlYFy0bQS9efPG24V7+/at7OzsyPv376XRaHy2onRC51eQ9myN7wetQH+k0DjuRlMUvU4boeZha2srlhtBx45AHr5E28zv2bNn5vz586bZbJr+Y/0f//b3B6Gvr89b0+uavF6ve/F18qhrf/2rE7u7v979WE1aWyLBZE/j6ORP/6bTaZNIJLxloh77cTW9RqPRFjQNR/RsFYcS9K6pqSl5tfJKVldXZX19XTb+2fAeCyt/rcitW7dkaGioUzuAbfOBiYkJWVtb83q8jj6bm5uysbEha+trcvv2bfcadFiwD3/jxg15ufBSlpeXZWVlRVb/XpVyuSyDg4NuJdRa+/mH+T3Av67t9a/BoUFvvqAVr43v9eprrzHm8m17EJ9uE+KrBZWoy7X5P+blxZ8vZGFhQfL5vFt5pYhf877kp+KwOGn752gNN2/e9Cp+aXnJa4zXrl1zGw86LFgKnj17VuZ+n5PHs4/l8uXLbs/r5ssYGXskujJ6RZ7+9lTm5+fl3LlzLAG7rO1lzPuV+15DsL6b7uFbwcFopBX/6NEjdwTiNfEuSNuFfPLkSbvAv8X+bPD7xKlTp9wGwCthXRL2Pv637G1hr4jzNlAXuS95HIWhNmutGIq8CdR9462GEKv37wEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8F4wx/wE9mUF5CNZnBwAAAABJRU5ErkJggg==",qo="data:image/png;base64,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",jo=""+new URL("Flowy_north-CjN0OhUN.png",import.meta.url).href,Vo=""+new URL("Flowy_south-CP20N1Hd.png",import.meta.url).href,Zo=""+new URL("Fringe_east-D4I7-ug9.png",import.meta.url).href,Jo=""+new URL("Fringe_north-BaR1__6m.png",import.meta.url).href,Ko=""+new URL("Fringe_south-DYZWOYbC.png",import.meta.url).href,_o="data:image/png;base64,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",$o=""+new URL("ShirtBasic_Male_north-D0Q-ZKK7.png",import.meta.url).href,ei=""+new URL("ShirtBasic_Male_south-CIlSPWtc.png",import.meta.url).href,ti=""+new URL("Autopistol-4OG1LkWn.png",import.meta.url).href,oi=""+new URL("Revolver-C9k150bU.png",import.meta.url).href,ii=""+new URL("MachinePistol-DHmbj2Yf.png",import.meta.url).href,ni=""+new URL("HeavySMG-BUDFv7yG.png",import.meta.url).href,si=""+new URL("LMG-CoYfCHMK.png",import.meta.url).href,ai=""+new URL("Minigun-DxB8s9ao.png",import.meta.url).href,ri=""+new URL("AssaultRifle-DrEhipaR.png",import.meta.url).href,li=""+new URL("BoltActionRifle-BcSryIZ8.png",import.meta.url).href,ci=""+new URL("SniperRifle-Cs2KnCeL.png",import.meta.url).href,hi=""+new URL("Shotgun-BqgT2Xuu.png",import.meta.url).href,di=""+new URL("ChainShotgun-BRx0Lma4.png",import.meta.url).href,fi=""+new URL("RocketLauncher-1O-Mch50.png",import.meta.url).href,Ai="data:image/png;base64,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",ui=""+new URL("BowShort-BM14qosL.png",import.meta.url).href,pi=""+new URL("BowRecurve-DAXv2F8B.png",import.meta.url).href,gi=""+new URL("BowGreat-BvALv33r.png",import.meta.url).href,de=class de{constructor(){E(this,"images",new Map);E(this,"loaded",!1)}static getInstance(){return de.instance||(de.instance=new de),de.instance}async loadAssets(){const e=[{name:"house",path:Jt},{name:"wheat_stage_1",path:Kt},{name:"wheat_stage_2",path:_t},{name:"wheat_stage_3",path:$t}],o=[{name:"head_male_average_normal_east",path:eo},{name:"head_male_average_normal_north",path:to},{name:"head_male_average_normal_south",path:oo},{name:"body_naked_male_east",path:io},{name:"body_naked_male_north",path:no},{name:"body_naked_male_south",path:so},{name:"hair_afro_east",path:ao},{name:"hair_afro_north",path:ro},{name:"hair_afro_south",path:lo},{name:"hair_bob_east",path:co},{name:"hair_bob_north",path:ho},{name:"hair_bob_south",path:fo},{name:"hair_bowlcut_east",path:Ao},{name:"hair_bowlcut_north",path:uo},{name:"hair_bowlcut_south",path:po},{name:"hair_braidbun_east",path:go},{name:"hair_braidbun_north",path:mo},{name:"hair_braidbun_south",path:yo},{name:"hair_bravo_east",path:wo},{name:"hair_bravo_north",path:bo},{name:"hair_bravo_south",path:xo},{name:"hair_burgundy_east",path:vo},{name:"hair_burgundy_north",path:Mo},{name:"hair_burgundy_south",path:ko},{name:"hair_cleopatra_east",path:So},{name:"hair_cleopatra_north",path:Co},{name:"hair_cleopatra_south",path:Ro},{name:"hair_curly_east",path:Bo},{name:"hair_curly_north",path:To},{name:"hair_curly_south",path:Io},{name:"hair_cute_east",path:Po},{name:"hair_cute_north",path:Eo},{name:"hair_cute_south",path:Do},{name:"hair_decent_east",path:Fo},{name:"hair_decent_north",path:Lo},{name:"hair_decent_south",path:No},{name:"hair_elder_east",path:Wo},{name:"hair_elder_north",path:Go},{name:"hair_elder_south",path:Yo},{name:"hair_fancybun_east",path:zo},{name:"hair_fancybun_north",path:Ho},{name:"hair_fancybun_south",path:Oo},{name:"hair_firestarter_east",path:Qo},{name:"hair_firestarter_north",path:Uo},{name:"hair_firestarter_south",path:Xo},{name:"hair_flowy_east",path:qo},{name:"hair_flowy_north",path:jo},{name:"hair_flowy_south",path:Vo},{name:"hair_fringe_east",path:Zo},{name:"hair_fringe_north",path:Jo},{name:"hair_fringe_south",path:Ko},{name:"apparel_shirt_basic_male_east",path:_o},{name:"apparel_shirt_basic_male_north",path:$o},{name:"apparel_shirt_basic_male_south",path:ei}],i=[{name:"weapon_autopistol",path:ti},{name:"weapon_revolver",path:oi},{name:"weapon_machinepistol",path:ii},{name:"weapon_heavysmg",path:ni},{name:"weapon_lmg",path:si},{name:"weapon_minigun",path:ai},{name:"weapon_assaultrifle",path:ri},{name:"weapon_boltactionrifle",path:li},{name:"weapon_sniperrifle",path:ci},{name:"weapon_shotgun",path:hi},{name:"weapon_chainshotgun",path:di},{name:"weapon_rocketlauncher",path:fi},{name:"weapon_thumpcannon",path:Ai},{name:"weapon_bowshort",path:ui},{name:"weapon_bowrecurve",path:pi},{name:"weapon_bowgreat",path:gi}],l=[...e,...o,...i].map(s=>this.loadImage(s.name,s.path));try{await Promise.all(l),this.loaded=!0}catch{console.warn("Some assets failed to load, continuing with fallbacks"),this.loaded=!0}}loadImage(e,o){return new Promise((i,n)=>{const l=new Image;l.onload=()=>{this.images.set(e,l),console.log(`Loaded image: ${e}`),i()},l.onerror=()=>{console.warn(`Failed to load image: ${e} from ${o}`),n(new Error(`Failed to load ${e}`))},l.src=o})}getImage(e){return this.images.get(e)||null}getColonistSprite(e,o,i){const n=`${e}_${o}_${i}`;return this.images.get(n)||null}getAvailableHairStyles(){return["afro","bob","bowlcut","braidbun","bravo","burgundy","cleopatra","curly","cute","decent","elder","fancybun","firestarter","flowy","fringe"]}getAvailableHeadTypes(){return["male_average_normal"]}getAvailableBodyTypes(){return["naked_male"]}getAvailableApparelTypes(){return["shirt_basic_male"]}getItemIconKey(e){switch(e.toLowerCase()){case"pistol":case"autopistol":return"weapon_autopistol";case"revolver":return"weapon_revolver";case"machinepistol":return"weapon_machinepistol";case"heavysmg":return"weapon_heavysmg";case"lmg":return"weapon_lmg";case"minigun":return"weapon_minigun";case"assaultrifle":case"rifle":return"weapon_assaultrifle";case"boltactionrifle":return"weapon_boltactionrifle";case"sniperrifle":return"weapon_sniperrifle";case"shotgun":return"weapon_shotgun";case"chainshotgun":return"weapon_chainshotgun";case"rocketlauncher":return"weapon_rocketlauncher";case"thumpcannon":return"weapon_thumpcannon";case"bowshort":return"weapon_bowshort";case"bowrecurve":return"weapon_bowrecurve";case"bowgreat":return"weapon_bowgreat";default:return null}}getItemIcon(e){if(!e)return null;const o=this.getItemIconKey(e);return o&&this.images.get(o)||null}isLoaded(){return this.loaded}};E(de,"instance");let K=de;const fe=class fe{constructor(){E(this,"itemDefs",new Map);E(this,"loaded",!1)}static getInstance(){return fe.instance||(fe.instance=new fe),fe.instance}async loadItems(){if(!this.loaded)try{const e=[{defName:"Hoe",label:"hoe",description:"A simple farming tool for tilling soil and planting crops.",category:"Tool",equipSlot:"tool",maxDurability:100,stackable:!1,value:25,weight:2,workSpeedBonus:.2,workTypes:["Farming","Construction"]},{defName:"Axe",label:"axe",description:"A sturdy axe for chopping wood and basic construction work.",category:"Tool",equipSlot:"tool",maxDurability:120,stackable:!1,value:40,weight:3.5,workSpeedBonus:.3,workTypes:["Woodcutting","Construction"]},{defName:"Pickaxe",label:"pickaxe",description:"Heavy mining tool for extracting stone and ore.",category:"Tool",equipSlot:"tool",maxDurability:150,stackable:!1,value:60,weight:4,workSpeedBonus:.4,workTypes:["Mining","Construction"]},{defName:"Hammer",label:"hammer",description:"Essential construction tool for building and repairs.",category:"Tool",equipSlot:"tool",maxDurability:200,stackable:!1,value:35,weight:2.5,workSpeedBonus:.25,workTypes:["Construction","Crafting"]},{defName:"Revolver",label:"revolver",description:"Simple revolver. Reliable sidearm.",category:"Weapon",equipSlot:"weapon",stackable:!1,maxDurability:80,value:120,weight:1.1,damage:22,range:16,accuracy:.68,burstCount:1,warmup:.4,burstSpacing:0,cooldown:.55,projectileSpeed:660},{defName:"Autopistol",label:"autopistol",description:"Compact automatic pistol.",category:"Weapon",equipSlot:"weapon",stackable:!1,maxDurability:80,value:180,weight:1.25,damage:20,range:16,accuracy:.68,burstCount:2,warmup:.35,burstSpacing:.08,cooldown:.5,projectileSpeed:680},{defName:"MachinePistol",label:"machine pistol",description:"Very-fast-firing compact gun.",category:"Weapon",equipSlot:"weapon",stackable:!1,maxDurability:80,value:220,weight:1.6,damage:18,range:16,accuracy:.63,burstCount:3,warmup:.35,burstSpacing:.07,cooldown:.55,projectileSpeed:700},{defName:"HeavySMG",label:"heavy SMG",description:"Heavy submachine gun with decent range.",category:"Weapon",equipSlot:"weapon",stackable:!1,maxDurability:90,value:320,weight:3.2,damage:24,range:20,accuracy:.7,burstCount:3,warmup:.45,burstSpacing:.09,cooldown:.7,projectileSpeed:700},{defName:"LMG",label:"light machine gun",description:"Suppressive-fire capable LMG.",category:"Weapon",equipSlot:"weapon",stackable:!1,maxDurability:100,value:550,weight:5.5,damage:22,range:28,accuracy:.65,burstCount:6,warmup:.6,burstSpacing:.08,cooldown:1.2,projectileSpeed:700},{defName:"Minigun",label:"minigun",description:"Devastating rotary gun with huge burst.",category:"Weapon",equipSlot:"weapon",stackable:!1,maxDurability:100,value:1200,weight:8,damage:16,range:24,accuracy:.5,burstCount:12,warmup:.8,burstSpacing:.06,cooldown:1.8,projectileSpeed:700},{defName:"Shotgun",label:"shotgun",description:"Close-range powerhouse.",category:"Weapon",equipSlot:"weapon",stackable:!1,maxDurability:80,value:240,weight:3,damage:40,range:12,accuracy:.75,burstCount:1,warmup:.5,burstSpacing:0,cooldown:.9,projectileSpeed:620,minRange:1.2},{defName:"ChainShotgun",label:"chain shotgun",description:"Rapid-firing shotgun at close range.",category:"Weapon",equipSlot:"weapon",stackable:!1,maxDurability:80,value:300,weight:3.4,damage:30,range:12,accuracy:.7,burstCount:3,warmup:.5,burstSpacing:.08,cooldown:1,projectileSpeed:620,minRange:1.2},{defName:"BoltActionRifle",label:"bolt-action rifle",description:"Long-range rifle with high stopping power.",category:"Weapon",equipSlot:"weapon",stackable:!1,maxDurability:100,value:380,weight:3.8,damage:48,range:35,accuracy:.85,burstCount:1,warmup:.7,burstSpacing:0,cooldown:1.1,projectileSpeed:720},{defName:"SniperRifle",label:"sniper rifle",description:"Extremely accurate long-range rifle.",category:"Weapon",equipSlot:"weapon",stackable:!1,maxDurability:100,value:700,weight:4.5,damage:60,range:40,accuracy:.9,burstCount:1,warmup:.9,burstSpacing:0,cooldown:1.3,projectileSpeed:740},{defName:"AssaultRifle",label:"assault rifle",description:"General-purpose automatic rifle.",category:"Weapon",equipSlot:"weapon",stackable:!1,maxDurability:100,value:500,weight:3.8,damage:33,range:30,accuracy:.8,burstCount:3,warmup:.6,burstSpacing:.1,cooldown:.7,projectileSpeed:700},{defName:"RocketLauncher",label:"rocket launcher",description:"High-damage explosive launcher.",category:"Weapon",equipSlot:"weapon",stackable:!1,maxDurability:70,value:1e3,weight:6.5,damage:120,range:28,accuracy:.6,burstCount:1,warmup:1.2,burstSpacing:0,cooldown:2,projectileSpeed:380,minRange:1.6},{defName:"ThumpCannon",label:"thump cannon",description:"Concussive-impact launcher.",category:"Weapon",equipSlot:"weapon",stackable:!1,maxDurability:80,value:850,weight:5,damage:80,range:30,accuracy:.7,burstCount:1,warmup:1,burstSpacing:0,cooldown:1.6,projectileSpeed:420,minRange:1.5},{defName:"BowShort",label:"short bow",description:"Simple short bow.",category:"Weapon",equipSlot:"weapon",stackable:!1,maxDurability:60,value:80,weight:1,damage:18,range:20,accuracy:.65,burstCount:1,warmup:.55,burstSpacing:0,cooldown:.8,projectileSpeed:520},{defName:"BowRecurve",label:"recurve bow",description:"Improved bow with better range.",category:"Weapon",equipSlot:"weapon",stackable:!1,maxDurability:70,value:120,weight:1.1,damage:22,range:24,accuracy:.7,burstCount:1,warmup:.58,burstSpacing:0,cooldown:.85,projectileSpeed:540},{defName:"BowGreat",label:"great bow",description:"Large bow with strong draw.",category:"Weapon",equipSlot:"weapon",stackable:!1,maxDurability:80,value:160,weight:1.3,damage:26,range:26,accuracy:.72,burstCount:1,warmup:.62,burstSpacing:0,cooldown:.9,projectileSpeed:560},{defName:"Pistol",label:"pistol",description:"A reliable sidearm for personal protection.",category:"Weapon",equipSlot:"weapon",maxDurability:80,stackable:!1,value:150,weight:1.2,damage:25,range:15,accuracy:.7,ammoType:"Bullets",warmup:.35,cooldown:.5,burstCount:1,burstSpacing:.1,projectileSpeed:700,minRange:1.1},{defName:"Rifle",label:"assault rifle",description:"Military-grade automatic rifle with high damage output.",category:"Weapon",equipSlot:"weapon",maxDurability:100,stackable:!1,value:400,weight:3.8,damage:40,range:25,accuracy:.8,ammoType:"Bullets",warmup:.6,cooldown:.75,burstCount:3,burstSpacing:.1,projectileSpeed:760,minRange:1.25},{defName:"Knife",label:"combat knife",description:"Sharp blade suitable for close combat and utility work.",category:"Weapon",equipSlot:"weapon",maxDurability:60,stackable:!1,value:30,weight:.5,damage:15,range:1,accuracy:.9},{defName:"FlakVest",label:"flak vest",description:"Basic body armor that provides protection against projectiles.",category:"Armor",equipSlot:"armor",maxDurability:150,stackable:!1,value:200,weight:5,armorRating:.3,movementPenalty:.05},{defName:"TacticalArmor",label:"tactical armor",description:"Advanced military armor offering superior protection.",category:"Armor",equipSlot:"armor",maxDurability:200,stackable:!1,value:500,weight:8,armorRating:.5,movementPenalty:.1},{defName:"WorkClothes",label:"work clothes",description:"Durable clothing designed for manual labor.",category:"Clothing",equipSlot:"armor",maxDurability:80,stackable:!1,value:50,weight:1.5,armorRating:.05,workSpeedBonus:.1},{defName:"SimpleHelmet",label:"simple helmet",description:"Basic head protection for dangerous work environments.",category:"Helmet",equipSlot:"helmet",maxDurability:100,stackable:!1,value:75,weight:1,armorRating:.2},{defName:"TacticalHelmet",label:"tactical helmet",description:"Military-grade helmet with enhanced protection.",category:"Helmet",equipSlot:"helmet",maxDurability:150,stackable:!1,value:180,weight:2,armorRating:.35},{defName:"MedicineKit",label:"medicine kit",description:"Basic medical supplies for treating injuries and illnesses.",category:"Medical",equipSlot:"none",maxDurability:50,stackable:!0,maxStack:10,value:40,weight:.5,healAmount:25},{defName:"Bandages",label:"bandages",description:"Clean cloth bandages for wound treatment.",category:"Medical",equipSlot:"none",stackable:!0,maxStack:25,value:5,weight:.1,healAmount:10},{defName:"Wood",label:"wood",description:"Raw lumber for construction and crafting.",category:"Resource",equipSlot:"none",stackable:!0,maxStack:75,value:2,weight:1},{defName:"Stone",label:"stone blocks",description:"Cut stone blocks for sturdy construction.",category:"Resource",equipSlot:"none",stackable:!0,maxStack:75,value:3,weight:2},{defName:"Steel",label:"steel",description:"Refined metal suitable for advanced construction and weapons.",category:"Resource",equipSlot:"none",stackable:!0,maxStack:75,value:5,weight:1.5},{defName:"Bread",label:"bread",description:"Fresh baked bread that provides sustenance.",category:"Food",equipSlot:"none",stackable:!0,maxStack:10,value:8,weight:.3,nutrition:12,spoilage:7},{defName:"MealRation",label:"meal ration",description:"Preserved military ration with long shelf life.",category:"Food",equipSlot:"none",stackable:!0,maxStack:20,value:15,weight:.4,nutrition:20,spoilage:60},{defName:"WheatSeeds",label:"wheat seeds",description:"Seeds for growing wheat crops.",category:"Seeds",equipSlot:"none",stackable:!0,maxStack:50,value:3,weight:.1,cropType:"Wheat",growthTime:15},{defName:"CornSeeds",label:"corn seeds",description:"Seeds for growing corn crops.",category:"Seeds",equipSlot:"none",stackable:!0,maxStack:50,value:4,weight:.1,cropType:"Corn",growthTime:20},{defName:"ComponentElectronic",label:"electronic component",description:"Advanced electronic component for complex devices.",category:"Component",equipSlot:"none",stackable:!0,maxStack:25,value:25,weight:.2},{defName:"ComponentMechanical",label:"mechanical component",description:"Precision mechanical parts for machinery.",category:"Component",equipSlot:"none",stackable:!0,maxStack:25,value:20,weight:.5},{defName:"Gold",label:"gold",description:"Precious metal valuable for trade.",category:"Valuable",equipSlot:"none",stackable:!0,maxStack:25,value:50,weight:.8},{defName:"Silver",label:"silver",description:"Valuable metal used in electronics and trade.",category:"Valuable",equipSlot:"none",stackable:!0,maxStack:25,value:20,weight:.6}];for(const o of e)this.itemDefs.set(o.defName,o);this.loaded=!0,console.log(`Loaded ${this.itemDefs.size} item definitions`)}catch(e){console.error("Failed to load item definitions:",e)}}getItemDef(e){return this.itemDefs.get(e)}getAllItemDefs(){return Array.from(this.itemDefs.values())}getItemDefsByCategory(e){return Array.from(this.itemDefs.values()).filter(o=>o.category===e)}createItem(e,o=1,i){const n=this.getItemDef(e);return n?{name:n.label,quantity:Math.min(o,n.maxStack||o),description:n.description,quality:i||"normal",durability:n.maxDurability,maxDurability:n.maxDurability,stackable:n.stackable,category:n.category,value:n.value,weight:n.weight,defName:e}:(console.warn(`Item definition not found: ${e}`),null)}getWorkSpeedBonus(e){const o=this.getItemDef(e.defName||"");return(o==null?void 0:o.workSpeedBonus)||0}getArmorRating(e){const o=this.getItemDef(e.defName||"");return(o==null?void 0:o.armorRating)||0}getDamage(e){const o=this.getItemDef(e.defName||"");return(o==null?void 0:o.damage)||0}getHealAmount(e){const o=this.getItemDef(e.defName||"");return(o==null?void 0:o.healAmount)||0}getNutrition(e){const o=this.getItemDef(e.defName||"");return(o==null?void 0:o.nutrition)||0}getRandomItemsByCategory(e,o=1){const i=this.getItemDefsByCategory(e),n=[];for(let l=0;l<o&&i.length>0;l++){const s=Math.floor(Math.random()*i.length);n.push(i[s].defName)}return n}getItemsForBackground(e){const o=[],i=e.toLowerCase(),n=s=>Math.random()<s,l=s=>{const a=s.reduce((c,[,h])=>c+h,0);let r=Math.random()*a;for(const[c,h]of s)if((r-=h)<=0)return c;return s[s.length-1][0]};switch(i){case"farmer":{o.push("Hoe","WheatSeeds","WorkClothes"),n(.25)&&o.push(l([["BowShort",.7],["Revolver",.3]]));break}case"soldier":{const s=l([["AssaultRifle",40],["HeavySMG",20],["LMG",15],["Shotgun",10],["MachinePistol",10],["Revolver",5]]);o.push(s,"TacticalArmor","TacticalHelmet"),n(.5)&&o.push("MedicineKit");break}case"doctor":case"medic":{o.push("MedicineKit","Bandages"),n(.1)&&o.push("Revolver");break}case"engineer":{o.push("Hammer","ComponentElectronic","ComponentMechanical"),n(.5)&&o.push(l([["Autopistol",60],["Revolver",40]]));break}case"miner":case"laborer":{o.push("Pickaxe","SimpleHelmet","WorkClothes"),n(.15)&&o.push("Revolver");break}case"trader":case"merchant":{o.push("Gold","Silver"),n(.2)&&o.push("Revolver");break}case"hunter":{const s=l([["BoltActionRifle",45],["BowRecurve",25],["BowGreat",15],["BowShort",10],["SniperRifle",5]]);o.push(s,"Knife");break}case"scholar":break;case"noble":{n(.35)&&o.push("Revolver");break}case"assassin":{o.push(n(.65)?"MachinePistol":"Revolver","Knife");break}case"witch":break;case"hero":{const s=l([["AssaultRifle",60],["HeavySMG",20],["Shotgun",15],["Minigun",5]]);o.push(s),n(.4)&&o.push("TacticalArmor");break}case"mastermind":{n(.5)&&o.push("Revolver");break}default:o.push("Knife"),n(.25)&&o.push("Autopistol")}return o.filter(s=>!!this.getItemDef(s))}};E(fe,"instance");let Pe=fe;const H=Pe.getInstance(),ue=[{id:"farmer",name:"Farmer",description:"Spent years working the fields, knows the land well.",skillModifiers:{farming:3,construction:1,strength:2},startingItems:["seeds","hoe"],rarity:"common"},{id:"laborer",name:"Laborer",description:"Hard physical work has made them strong and resilient.",skillModifiers:{construction:3,strength:3,endurance:2},startingItems:["hammer","nails"],rarity:"common"},{id:"merchant",name:"Merchant",description:"Skilled in trade and negotiation, knows the value of goods.",skillModifiers:{social:3,intelligence:2,trade:3},startingItems:["coin_purse","ledger"],rarity:"common"},{id:"hunter",name:"Hunter",description:"Experienced in tracking and survival in the wilderness.",skillModifiers:{shooting:3,animals:2,survival:3},startingItems:["bow","arrows"],rarity:"common"},{id:"soldier",name:"Soldier",description:"Military training has prepared them for combat and discipline.",skillModifiers:{shooting:4,melee:3,discipline:3,strength:2},startingItems:["rifle","armor"],rarity:"uncommon"},{id:"scholar",name:"Scholar",description:"Years of study have made them knowledgeable but physically weak.",skillModifiers:{research:4,intelligence:4,medicine:2,strength:-2},startingItems:["books","research_notes"],rarity:"uncommon"},{id:"engineer",name:"Engineer",description:"Technical expertise in building and maintaining complex systems.",skillModifiers:{construction:4,crafting:3,intelligence:3,repair:4},startingItems:["toolbox","blueprints"],rarity:"uncommon"},{id:"medic",name:"Medic",description:"Trained in healing and medical procedures.",skillModifiers:{medicine:4,intelligence:2,social:2,dexterity:2},startingItems:["medical_kit","bandages"],rarity:"uncommon"},{id:"noble",name:"Noble",description:"Born into privilege, skilled in leadership but lacks practical experience.",skillModifiers:{social:4,leadership:4,intelligence:2,construction:-2,farming:-2},startingItems:["fine_clothes","signet_ring"],rarity:"rare"},{id:"assassin",name:"Assassin",description:"Trained in stealth and precision, deadly but antisocial.",skillModifiers:{melee:4,stealth:5,dexterity:3,social:-3},startingItems:["poison","throwing_knives"],rarity:"rare"},{id:"witch",name:"Witch",description:"Practitioner of ancient arts, mysterious and powerful.",skillModifiers:{medicine:3,research:3,intelligence:3,social:-2},startingItems:["herbs","ritual_components"],rarity:"rare"},{id:"hero",name:"Hero",description:"A legendary figure with exceptional abilities in all areas.",skillModifiers:{shooting:3,melee:3,leadership:4,strength:3,intelligence:2},startingItems:["legendary_weapon","hero_medal"],rarity:"legendary"},{id:"mastermind",name:"Mastermind",description:"Brilliant strategist and inventor, capable of incredible feats.",skillModifiers:{intelligence:5,research:5,leadership:3,crafting:4},startingItems:["advanced_tools","invention_plans"],rarity:"legendary"}],Ve=["Was a respected member of their community before the collapse.","Survived alone in the wilderness for months before joining the colony.","Lost their family in the great disaster and seeks a new beginning.","Was part of a failed expedition to establish another settlement.","Escaped from raiders who destroyed their previous home.","Voluntarily left their old life behind to join the colony.","Was rescued by the colony after being found injured and alone.","Brings tales of distant lands and strange discoveries.","Seeks redemption for past mistakes in their former life.","Dreams of rebuilding civilization better than it was before."];function mi(t){let e=ue;{const o=Math.random();o<.6?e=ue.filter(i=>i.rarity==="common"):o<.85?e=ue.filter(i=>i.rarity==="uncommon"):o<.98?e=ue.filter(i=>i.rarity==="rare"):e=ue.filter(i=>i.rarity==="legendary")}return e[Math.floor(Math.random()*e.length)]}function yi(){return Ve[Math.floor(Math.random()*Ve.length)]}const Fe=[{name:"Brown",hex:"#8B4513",rgb:[139,69,19],rarity:"common"},{name:"Black",hex:"#000000",rgb:[0,0,0],rarity:"common"},{name:"Blonde",hex:"#FFD700",rgb:[255,215,0],rarity:"common"},{name:"Dark Brown",hex:"#654321",rgb:[101,67,33],rarity:"common"},{name:"Auburn",hex:"#A0522D",rgb:[160,82,45],rarity:"uncommon"},{name:"Ginger",hex:"#FF6347",rgb:[255,99,71],rarity:"uncommon"},{name:"Strawberry Blonde",hex:"#FF8C69",rgb:[255,140,105],rarity:"uncommon"},{name:"Gray",hex:"#808080",rgb:[128,128,128],rarity:"uncommon"},{name:"White",hex:"#FFFFFF",rgb:[255,255,255],rarity:"rare"},{name:"Silver",hex:"#C0C0C0",rgb:[192,192,192],rarity:"rare"},{name:"Platinum Blonde",hex:"#F5F5DC",rgb:[245,245,220],rarity:"rare"}],Le=[{name:"Fair",hex:"#FDBCB4",rgb:[253,188,180],rarity:"common"},{name:"Light",hex:"#F1C27D",rgb:[241,194,125],rarity:"common"},{name:"Medium",hex:"#E0AC69",rgb:[224,172,105],rarity:"common"},{name:"Olive",hex:"#C68642",rgb:[198,134,66],rarity:"common"},{name:"Tan",hex:"#8D5524",rgb:[141,85,36],rarity:"common"},{name:"Dark",hex:"#5C4033",rgb:[92,64,51],rarity:"common"},{name:"Deep",hex:"#3C2415",rgb:[60,36,21],rarity:"common"}],Ne=[{name:"Brown",hex:"#8B4513",rgb:[139,69,19],rarity:"common"},{name:"Blue",hex:"#4169E1",rgb:[65,105,225],rarity:"common"},{name:"Green",hex:"#228B22",rgb:[34,139,34],rarity:"common"},{name:"Hazel",hex:"#8FBC8F",rgb:[143,188,143],rarity:"common"},{name:"Gray",hex:"#808080",rgb:[128,128,128],rarity:"uncommon"},{name:"Amber",hex:"#FFBF00",rgb:[255,191,0],rarity:"uncommon"},{name:"Violet",hex:"#8A2BE2",rgb:[138,43,226],rarity:"rare"},{name:"Heterochromia",hex:"#FF1493",rgb:[255,20,147],rarity:"rare"}],Ze=["afro","bob","bowlcut","braidbun","bravo","burgundy","cleopatra","curly","cute","decent","elder","fancybun","firestarter","flowy","fringe"],Je=["Male_Average_Normal"],wi=[{name:"White",hex:"#FFFFFF",rgb:[255,255,255],rarity:"common"},{name:"Black",hex:"#000000",rgb:[0,0,0],rarity:"common"},{name:"Gray",hex:"#808080",rgb:[128,128,128],rarity:"common"},{name:"Brown",hex:"#8B4513",rgb:[139,69,19],rarity:"common"},{name:"Blue",hex:"#4169E1",rgb:[65,105,225],rarity:"common"},{name:"Red",hex:"#DC143C",rgb:[220,20,60],rarity:"common"},{name:"Green",hex:"#228B22",rgb:[34,139,34],rarity:"common"},{name:"Purple",hex:"#800080",rgb:[128,0,128],rarity:"uncommon"},{name:"Orange",hex:"#FF8C00",rgb:[255,140,0],rarity:"uncommon"},{name:"Yellow",hex:"#FFD700",rgb:[255,215,0],rarity:"uncommon"},{name:"Gold",hex:"#FFD700",rgb:[255,215,0],rarity:"rare"},{name:"Silver",hex:"#C0C0C0",rgb:[192,192,192],rarity:"rare"}];function Me(t,e=!0){if(!e)return t[Math.floor(Math.random()*t.length)];const o=Math.random();let i;return o<.7?i=t.filter(n=>n.rarity==="common"):o<.9?i=t.filter(n=>n.rarity==="uncommon"):i=t.filter(n=>n.rarity==="rare"),i.length===0&&(i=t),i[Math.floor(Math.random()*i.length)]}function bi(){return Ze[Math.floor(Math.random()*Ze.length)]}function xi(){return Je[Math.floor(Math.random()*Je.length)]}function vi(){return{hairColor:Me(Fe),hairStyle:bi(),skinTone:Me(Le),eyeColor:Me(Ne),bodyType:xi(),height:["short","average","tall"][Math.floor(Math.random()*3)],build:["slim","average","stocky","muscular"][Math.floor(Math.random()*4)]}}const Mi=[{id:"fleet_footed",name:"Fleet-Footed",description:"Moves faster than average due to natural agility.",type:"positive",category:"physical",effects:[{stat:"movementSpeed",modifier:1.25,type:"multiplicative",description:"+25% movement speed"}],rarity:"uncommon",conflictsWith:["sluggish"]},{id:"sluggish",name:"Sluggish",description:"Naturally slow-moving, but often more careful and precise.",type:"negative",category:"physical",effects:[{stat:"movementSpeed",modifier:.8,type:"multiplicative",description:"-20% movement speed"},{stat:"accuracy",modifier:1,type:"additive",description:"+1 accuracy due to carefulness"}],rarity:"common",conflictsWith:["fleet_footed","nimble"]},{id:"strong_back",name:"Strong Back",description:"Can carry more items and work longer without fatigue.",type:"positive",category:"physical",effects:[{stat:"carryCapacity",modifier:1.5,type:"multiplicative",description:"+50% carry capacity"},{stat:"construction",modifier:2,type:"additive",description:"+2 construction skill"}],rarity:"uncommon",conflictsWith:["frail"]},{id:"frail",name:"Frail",description:"Physically weak but often compensates with intelligence.",type:"negative",category:"physical",effects:[{stat:"health",modifier:.75,type:"multiplicative",description:"-25% max health"},{stat:"intelligence",modifier:2,type:"additive",description:"+2 intelligence"}],rarity:"common",conflictsWith:["strong_back","tough"]},{id:"tough",name:"Tough",description:"Naturally resilient and hard to hurt.",type:"positive",category:"physical",effects:[{stat:"health",modifier:1.3,type:"multiplicative",description:"+30% max health"},{stat:"painTolerance",modifier:3,type:"additive",description:"+3 pain tolerance"}],rarity:"uncommon",conflictsWith:["frail"]},{id:"nimble",name:"Nimble",description:"Quick reflexes and excellent hand-eye coordination.",type:"positive",category:"physical",effects:[{stat:"dexterity",modifier:3,type:"additive",description:"+3 dexterity"},{stat:"accuracy",modifier:2,type:"additive",description:"+2 accuracy"}],rarity:"uncommon",conflictsWith:["clumsy"]},{id:"clumsy",name:"Clumsy",description:"Prone to accidents but oddly endearing to others.",type:"negative",category:"physical",effects:[{stat:"dexterity",modifier:-2,type:"additive",description:"-2 dexterity"},{stat:"social",modifier:1,type:"additive",description:"+1 social (endearing clumsiness)"}],rarity:"common",conflictsWith:["nimble"]}],ki=[{id:"quick_learner",name:"Quick Learner",description:"Gains experience and skills faster than others.",type:"positive",category:"mental",effects:[{stat:"experienceGain",modifier:1.5,type:"multiplicative",description:"+50% experience gain"}],rarity:"rare"},{id:"slow_learner",name:"Slow Learner",description:"Takes longer to learn new skills but retains them better.",type:"negative",category:"mental",effects:[{stat:"experienceGain",modifier:.7,type:"multiplicative",description:"-30% experience gain"},{stat:"skillRetention",modifier:1.2,type:"multiplicative",description:"+20% skill retention"}],rarity:"common"},{id:"photographic_memory",name:"Photographic Memory",description:"Never forgets anything and excels at research.",type:"positive",category:"mental",effects:[{stat:"research",modifier:4,type:"additive",description:"+4 research skill"},{stat:"intelligence",modifier:3,type:"additive",description:"+3 intelligence"}],rarity:"legendary"},{id:"absent_minded",name:"Absent-Minded",description:"Often forgets things but has moments of brilliant insight.",type:"negative",category:"mental",effects:[{stat:"taskCompletion",modifier:.85,type:"multiplicative",description:"-15% task completion rate"},{stat:"creativity",modifier:3,type:"additive",description:"+3 creativity bonus"}],rarity:"common"},{id:"perfectionist",name:"Perfectionist",description:"Works slower but produces higher quality results.",type:"neutral",category:"mental",effects:[{stat:"workSpeed",modifier:.8,type:"multiplicative",description:"-20% work speed"},{stat:"quality",modifier:1.4,type:"multiplicative",description:"+40% work quality"}],rarity:"uncommon"},{id:"focused",name:"Focused",description:"Excellent concentration allows for efficient work.",type:"positive",category:"mental",effects:[{stat:"workSpeed",modifier:1.2,type:"multiplicative",description:"+20% work speed"},{stat:"accuracy",modifier:2,type:"additive",description:"+2 accuracy"}],rarity:"uncommon"}],Si=[{id:"charismatic",name:"Charismatic",description:"Natural leader who inspires others.",type:"positive",category:"social",effects:[{stat:"social",modifier:4,type:"additive",description:"+4 social skill"},{stat:"leadership",modifier:3,type:"additive",description:"+3 leadership"}],rarity:"rare"},{id:"antisocial",name:"Antisocial",description:"Prefers solitude but works well independently.",type:"negative",category:"social",effects:[{stat:"social",modifier:-3,type:"additive",description:"-3 social skill"},{stat:"independentWork",modifier:1.3,type:"multiplicative",description:"+30% efficiency when working alone"}],rarity:"common"},{id:"empathetic",name:"Empathetic",description:"Deeply understands others emotions and needs.",type:"positive",category:"social",effects:[{stat:"medicine",modifier:2,type:"additive",description:"+2 medicine (bedside manner)"},{stat:"social",modifier:2,type:"additive",description:"+2 social skill"},{stat:"moodImpact",modifier:1.2,type:"multiplicative",description:"+20% positive mood impact on others"}],rarity:"uncommon"},{id:"intimidating",name:"Intimidating",description:"Natural presence that can be useful in conflict.",type:"neutral",category:"social",effects:[{stat:"melee",modifier:2,type:"additive",description:"+2 melee (intimidation factor)"},{stat:"social",modifier:-1,type:"additive",description:"-1 social (can be off-putting)"},{stat:"conflictResolution",modifier:1.5,type:"multiplicative",description:"+50% conflict resolution through intimidation"}],rarity:"uncommon"}],Ci=[{id:"green_thumb",name:"Green Thumb",description:"Plants seem to grow better under their care.",type:"positive",category:"special",effects:[{stat:"farming",modifier:4,type:"additive",description:"+4 farming skill"},{stat:"cropYield",modifier:1.25,type:"multiplicative",description:"+25% crop yield"},{stat:"plantGrowthSpeed",modifier:1.15,type:"multiplicative",description:"+15% plant growth speed"}],rarity:"rare"},{id:"animal_whisperer",name:"Animal Whisperer",description:"Has an uncanny ability to understand and work with animals.",type:"positive",category:"special",effects:[{stat:"animals",modifier:5,type:"additive",description:"+5 animal skill"},{stat:"animalProductivity",modifier:1.3,type:"multiplicative",description:"+30% animal productivity"},{stat:"tamingSpeed",modifier:2,type:"multiplicative",description:"100% faster animal taming"}],rarity:"rare"},{id:"night_owl",name:"Night Owl",description:"More productive during night hours.",type:"neutral",category:"special",effects:[{stat:"nightWorkBonus",modifier:1.5,type:"multiplicative",description:"+50% work efficiency at night"},{stat:"dayWorkPenalty",modifier:.9,type:"multiplicative",description:"-10% work efficiency during day"}],rarity:"uncommon"},{id:"early_bird",name:"Early Bird",description:"Most productive in the early morning hours.",type:"neutral",category:"special",effects:[{stat:"morningWorkBonus",modifier:1.4,type:"multiplicative",description:"+40% work efficiency in morning"},{stat:"eveningWorkPenalty",modifier:.9,type:"multiplicative",description:"-10% work efficiency in evening"}],rarity:"uncommon"},{id:"lucky",name:"Lucky",description:"Good things just seem to happen around them.",type:"positive",category:"special",effects:[{stat:"criticalSuccess",modifier:2,type:"multiplicative",description:"100% higher chance of critical success"},{stat:"resourceFind",modifier:1.2,type:"multiplicative",description:"+20% chance to find extra resources"}],rarity:"legendary"},{id:"jinxed",name:"Jinxed",description:"Prone to unfortunate accidents and bad luck.",type:"negative",category:"special",effects:[{stat:"criticalFailure",modifier:1.5,type:"multiplicative",description:"+50% chance of critical failure"},{stat:"equipmentBreakage",modifier:1.3,type:"multiplicative",description:"+30% equipment breakage rate"}],rarity:"uncommon"}],ke=[...Mi,...ki,...Si,...Ci];function Ri(t,e){let o=ke;if(t&&(o=o.filter(i=>i.category===t)),e)o=o.filter(i=>i.rarity===e);else{const i=Math.random();i<.5?o=o.filter(n=>n.rarity==="common"):i<.8?o=o.filter(n=>n.rarity==="uncommon"):i<.95?o=o.filter(n=>n.rarity==="rare"):o=o.filter(n=>n.rarity==="legendary")}return o.length===0&&(o=ke),o[Math.floor(Math.random()*o.length)]}function Bi(t=2){const e=[],o=new Set;for(let i=0;i<t;i++){let n=0,l;do l=Ri(),n++;while((o.has(l.id)||l.conflictsWith&&l.conflictsWith.some(s=>o.has(s)))&&n<50);n<50&&(e.push(l),o.add(l.id))}return e}function Ti(){return{background:mi(),appearance:vi(),passiveTraits:Bi(Math.floor(Math.random()*3)+1),originStory:yi()}}ke.map(t=>t.name);ke.map(t=>({name:t.name,description:t.description,effects:t.effects.reduce((e,o)=>(e[o.stat]=o.modifier,e),{}),rarity:t.rarity}));Fe.map(t=>t.name);Le.map(t=>t.name);Ne.map(t=>t.name);ue.map(t=>({name:t.name,description:t.description,effects:Object.entries(t.skillModifiers).reduce((e,[o,i])=>(e[o]=i,e),{}),startingSkills:t.startingItems||[]}));Le.map(t=>t.hex),Fe.map(t=>t.hex),Ne.map(t=>t.hex);const ee={FIRST:["Alex","Jordan","Taylor","Casey","Morgan","Riley","Jamie","Avery","Quinn","Sage","River","Rowan","Phoenix","Dakota","Skyler","Emery","Emma","Liam","Olivia","Noah","Ava","Ethan","Sophia","Mason","Isabella","William","Mia","James","Charlotte","Benjamin","Amelia","Lucas"],LAST:["Smith","Johnson","Williams","Brown","Jones","Garcia","Miller","Davis","Rodriguez","Martinez","Hernandez","Lopez","Gonzalez","Wilson","Anderson","Thomas"]},Ii=["Fresh Bread","Roasted Vegetables","Berry Pie","Hearty Stew","Honey Cakes","Grilled Fish","Wild Mushrooms","Apple Cider","Cheese & Crackers","Herbal Tea"];function ge(t){return t[Math.floor(Math.random()*t.length)]}const Pi=["Millhaven","Riverside","Oakwood","Stonecrest","Greenfield","Ashford","Fairview","Brookside","Clearwater","Redwood","Silverdale","Goldcrest","Ironport","Copper Hills","Crystal Lake","Shadowvale","Brightwater","Darkwood"],Ei=[{event:"Lost a parent at a young age",impact:"negative"},{event:"Won a local competition",impact:"positive"},{event:"Survived a natural disaster",impact:"neutral"},{event:"Fell in love and got heartbroken",impact:"negative"},{event:"Started their own small business",impact:"positive"},{event:"Served in the local militia",impact:"neutral"},{event:"Lost everything in a fire",impact:"negative"},{event:"Saved someone's life",impact:"positive"},{event:"Was betrayed by a close friend",impact:"negative"},{event:"Discovered a hidden talent",impact:"positive"},{event:"Moved frequently as a child",impact:"neutral"},{event:"Inherited property from a relative",impact:"positive"}],Di=["Cooking","Carpentry","Gardening","Mechanics","First Aid","Hunting","Fishing","Sewing","Music","Art","Writing","Leadership","Animal Care"],Fi=["heights","darkness","water","crowds","spiders","failure","abandonment","confined spaces","loud noises","authority figures"],Li=["once stole food to feed a starving family","has a photographic memory but hides it","is secretly afraid of butterflies","wrote anonymous love letters for years","saved someone's life and never told anyone","knows the location of hidden treasure","can't read but has never admitted it","has recurring dreams about flying"];class Ni{constructor(e){E(this,"seed");this.seed=e}next(){return this.seed=(this.seed*9301+49297)%233280,this.seed/233280}choice(e){return e[Math.floor(this.next()*e.length)]}choices(e,o){return[...e].sort(()=>this.next()-.5).slice(0,o)}range(e,o){return e+Math.floor(this.next()*(o-e+1))}}function Wi(t){let e=0;for(let o=0;o<t.length;o++){const i=t.charCodeAt(o);e=(e<<5)-e+i,e=e&e}return Math.abs(e)}function Gi(){const t=()=>.9+Math.random()*.2;return{workSpeed:Math.round(t()*100)/100,socialBonus:Math.round(t()*100)/100,hungerRate:Math.round(t()*100)/100,fatigueRate:Math.round(t()*100)/100}}function Yi(t,e,o){const i=t.choice(Pi),n=t.next()>.1,l=[];n&&(t.next()>.2&&l.push(`${t.choice(ee.FIRST)} ${o.split(" ")[1]} (Father)`),t.next()>.1&&l.push(`${t.choice(ee.FIRST)} ${t.choice(ee.LAST)} (Mother)`));const s=t.next()>.6?t.range(1,3):0,a=[];for(let v=0;v<s;v++){const k=t.choice(ee.FIRST),S=t.choice(["Brother","Sister"]);a.push(`${k} ${o.split(" ")[1]} (${S})`)}const r=e>25&&t.next()>.6?`${t.choice(ee.FIRST)} ${t.choice(ee.LAST)}`:void 0,c=r&&t.next()>.7?t.range(1,2):0,h=[];for(let v=0;v<c;v++){const k=t.choice(ee.FIRST),S=t.choice(["Son","Daughter"]);h.push(`${k} (${S})`)}const d=Math.min(t.range(2,5),Math.floor(e/8)),A=[];for(let v=0;v<d;v++){const k=t.choice(Ei),S=t.range(8,e-2);A.push({age:S,...k})}A.sort((v,k)=>v.age-k.age);const p=t.choices(Di,t.range(2,4)),f=t.choices(Fi,t.range(1,2)),g=t.next()>.7?[t.choice(Li)]:[],m=Math.min(t.range(1,3),Math.floor(e/12)),b=[],w=["Childhood Friend","Former Colleague","Neighbor","Mentor","Rival"];for(let v=0;v<m;v++){const k=`${t.choice(ee.FIRST)} ${t.choice(ee.LAST)}`,S=t.choice(w),R=t.choice(["good","bad","neutral"]);b.push({name:k,type:S,status:R})}return{birthplace:i,family:{parents:l,siblings:a,spouse:r,children:h},lifeEvents:A,skills:p,fears:f,secrets:g,relationships:b}}function zi(t){const{name:e,age:o,detailedInfo:i,background:n}=t;if(!i)return"A mysterious person with an unknown past.";let l=`${e} is ${o} years old and was born in ${i.birthplace}. `;if(i.family.parents.length>0?l+=`Raised by ${i.family.parents.join(" and ")}, `:l+="Growing up without parents, ",i.family.siblings.length>0?l+=`they have ${i.family.siblings.length} sibling${i.family.siblings.length>1?"s":""}. `:l+="they were an only child. ",i.lifeEvents.length>0){const s=i.lifeEvents.filter(a=>a.impact!=="neutral").slice(0,2);s.length>0&&(l+="Key moments in their life include: ",l+=s.map(a=>`at age ${a.age}, ${a.event.toLowerCase()}`).join("; ")+". ")}return i.family.spouse&&(l+=`They are married to ${i.family.spouse}`,i.family.children.length>0&&(l+=` and have ${i.family.children.length} child${i.family.children.length>1?"ren":""}: ${i.family.children.join(", ")}`),l+=". "),i.skills.length>0&&(l+=`They are skilled in ${i.skills.slice(0,2).join(" and ")}. `),i.fears.length>0&&(l+=`Despite their strengths, they have a deep fear of ${i.fears[0]}. `),i.secrets.length>0&&(l+=`What few know is that they ${i.secrets[0]}.`),l}function Hi(t,e,o){var h;const i={items:[],equipment:{},carryCapacity:50,currentWeight:0};H.loadItems();const n=H.getItemsForBackground(e);for(const d of n){const A=H.createItem(d,1,Ke(t));if(A)if(A.category==="Tool"||A.category==="Weapon"||A.category==="Armor"||A.category==="Helmet"){const p=Oi(A.category);p&&!i.equipment[p]?i.equipment[p]=A:i.items.push(A)}else i.items.push(A)}if(o.includes("Cooking")){const d=H.createItem("Knife",1);d&&i.items.push(d)}if(o.includes("First Aid")){const d=H.createItem("MedicineKit",1);d&&i.items.push(d)}const l=["Bread","Bandages"];for(const d of l){const A=H.createItem(d,t.range(1,3));A&&i.items.push(A)}if(!i.equipment.armor){const d=H.createItem("WorkClothes",1);d&&(i.equipment.armor=d)}const s=e.toLowerCase();if(!(!!i.equipment.weapon&&!!((h=H.getItemDef(i.equipment.weapon.defName||""))!=null&&h.range)&&H.getItemDef(i.equipment.weapon.defName||"").range>2)&&s!=="soldier"&&t.next()<.35){const d=H.createItem("Pistol",1,Ke(t));d&&(i.equipment.weapon=d)}let c=0;for(const d of i.items)c+=(d.weight||0)*d.quantity;for(const d of Object.values(i.equipment))d&&(c+=d.weight||0);return i.currentWeight=c,i}function Oi(t){switch(t){case"Tool":return"tool";case"Weapon":return"weapon";case"Armor":return"armor";case"Helmet":return"helmet";default:return null}}function Ke(t){const e=t.range(0,1);return e<.05?"poor":e<.15?"awful":e<.6?"normal":e<.85?"good":e<.95?"excellent":e<.99?"masterwork":"legendary"}function _e(){console.log("DEBUG: Generating new colonist profile...");const t=ge(ee.FIRST),e=ge(ee.LAST),o=`${t} ${e}`,i=Wi(o),n=new Ni(i),l=n.range(20,55),s=Ti();console.log("DEBUG: Generated traits:",s);const a=Yi(n,l,o),r=ge(Ii),c={skinTone:s.appearance.skinTone.hex,hairColor:s.appearance.hairColor.hex,eyeColor:s.appearance.eyeColor.hex,clothing:Me(wi).hex,sprites:{headType:ge(K.getInstance().getAvailableHeadTypes()),bodyType:s.appearance.bodyType,hairStyle:s.appearance.hairStyle,apparelType:ge(K.getInstance().getAvailableApparelTypes())}},h=Gi(),d={name:o,age:l,seed:i,background:s.background.name,personality:s.passiveTraits.map(A=>A.name),favoriteFood:r,backstory:"",detailedInfo:a,avatar:c,stats:h,startingInventory:Hi(n,s.background.name,a.skills)};return d.backstory=zi(d),d}function Qi(t){return`${t.name}, a ${t.personality.join(" and ").toLowerCase()} ${t.background.toLowerCase()}`}function $e(t){const e=t.hp||0,o=t.hunger||0,i=t.fatigue||0;return e<30?"Injured":o>80?"Starving":i>80?"Exhausted":t.inside?"Resting":t.state==="flee"?"Terrified":e>80&&o<30&&i<30?"Happy":e>60&&o<50&&i<50?"Content":"Okay"}function Bt(t,e,o,i="rifle"){const n=[];if(i==="bow")return n;const r=i==="sniper"?["#ffffff","#fff8dc","#ffe4b5"]:i==="rocket"?["#ff9800","#ff5722","#ffd54f","#ffab00"]:["#ffeb3b","#ffc107","#ff9800","#ff5722","#fff59d"],c={pistol:1.1,smg:1.2,rifle:1,shotgun:1.4,sniper:.7,minigun:1.3,rocket:1.6,bow:0,turret:1},h={pistol:[90,70],smg:[110,80],rifle:[120,90],shotgun:[140,100],sniper:[130,80],minigun:[100,90],rocket:[160,120],bow:[0,0],turret:[120,90]},d={pistol:[1.6,1.8],smg:[1.5,2],rifle:[1.8,2.2],shotgun:[2.2,2.6],sniper:[1.4,1.8],minigun:[1.2,1.6],rocket:[2.6,3.2],bow:[0,0],turret:[1.8,2.2]},A={pistol:[.1,.08],smg:[.1,.08],rifle:[.12,.08],shotgun:[.14,.1],sniper:[.1,.06],minigun:[.08,.06],rocket:[.16,.12],bow:[0,0],turret:[.12,.08]},p={pistol:[8,4],smg:[10,6],rifle:[12,6],shotgun:[14,8],sniper:[8,3],minigun:[6,4],rocket:[16,8],bow:[0,0],turret:[12,6]},[f,g]=p[i],m=f+Math.floor(Math.random()*g),b=c[i],[w,v]=h[i],[k,S]=d[i],[R,P]=A[i];for(let u=0;u<m;u++){const x=o+(Math.random()-.5)*b,M=w+Math.random()*v,B=r[Math.floor(Math.random()*r.length)];n.push({x:t+(Math.random()-.5)*6,y:e+(Math.random()-.5)*6,vx:Math.cos(x)*M,vy:Math.sin(x)*M,life:R+Math.random()*P,maxLife:R+Math.random()*P,size:k+Math.random()*S,color:B,alpha:.95})}return n}function Tt(t){const e=[],o=t.tx-t.x,i=t.ty-t.y,n=Math.sqrt(o*o+i*i),l=Math.atan2(i,o),a=Math.floor(n/{pistol:10,smg:11,rifle:10,shotgun:8,sniper:8,minigun:9,rocket:12,bow:6,turret:10}[t.kind||"rifle"])+2;for(let r=0;r<a;r++){const c=r/(a-1),h=t.x+o*c,d=t.y+i*c,A=t.kind==="rocket"?["#f2f2f2","#e0e0e0","#d0d0d0","#c0c0c0"]:t.kind==="bow"?["#a3824b","#7b5a2a"]:["#c0c0c0","#a8a8a8","#909090","#787878","#606060"],p=A[Math.floor(Math.random()*A.length)],f=l+Math.PI/2,g=(Math.random()-.5)*(t.kind==="sniper"?1:t.kind==="shotgun"?2:1.5);e.push({x:h+Math.cos(f)*g,y:d+Math.sin(f)*g,vx:Math.cos(l)*5+(Math.random()-.5)*8,vy:Math.sin(l)*5+(Math.random()-.5)*8,life:(t.kind==="rocket"?.25:.15)+Math.random()*.1,maxLife:(t.kind==="rocket"?.25:.15)+Math.random()*.1,size:(t.kind==="rocket"?1.2:.8)+Math.random()*.4,color:p,alpha:t.kind==="bow"?.5:.7})}return e}function me(t,e,o="rifle",i=1){const n=[],l=Math.max(.6,i),s={pistol:10,smg:12,rifle:14,shotgun:18,sniper:10,minigun:12,rocket:28,bow:6,turret:14}[o]*l,a=Math.floor(s)+Math.floor(Math.random()*6),r={pistol:60,smg:70,rifle:75,shotgun:90,sniper:80,minigun:70,rocket:120,bow:40,turret:75}[o]*l,c=o==="rocket"?["#ff9e3d","#ffb74d","#ffd54f","#fff176"]:o==="bow"?["#a3824b","#7b5a2a","#c6a168"]:["#ff5722","#ff7043","#ffab40","#ffa726","#ff8a65"];for(let h=0;h<a;h++){const d=Math.random()*Math.PI*2,A=r+Math.random()*(r*.6),p=c[Math.floor(Math.random()*c.length)];n.push({x:t+(Math.random()-.5)*(o==="rocket"?12:8),y:e+(Math.random()-.5)*(o==="rocket"?12:8),vx:Math.cos(d)*A,vy:Math.sin(d)*A,life:(o==="rocket"?.35:.25)+Math.random()*.2,maxLife:(o==="rocket"?.35:.25)+Math.random()*.2,size:(o==="rocket"?1.8:o==="shotgun"?1.5:1.2)+Math.random()*1.2,color:p,alpha:.9})}return n}function Ui(t,e,o,i=10,n=160){const l=[];for(let s=0;s<i;s++){const r=o+(Math.random()-.5)*1.4,c=n+Math.random()*n*.6,h=["#ffd54f","#ffeb3b","#fff59d","#ffffff"],d=h[Math.floor(Math.random()*h.length)];l.push({x:t+(Math.random()-.5)*4,y:e+(Math.random()-.5)*4,vx:Math.cos(r)*c,vy:Math.sin(r)*c,life:.18+Math.random()*.12,maxLife:.18+Math.random()*.12,size:.9+Math.random()*.6,color:d,alpha:.95})}return l}function et(t,e,o=12,i="#8d8d8d"){const n=[];for(let l=0;l<o;l++){const s=Math.random()*Math.PI*2,a=80+Math.random()*120;n.push({x:t+(Math.random()-.5)*6,y:e+(Math.random()-.5)*6,vx:Math.cos(s)*a,vy:Math.sin(s)*a,life:.5+Math.random()*.4,maxLife:.5+Math.random()*.4,size:1.2+Math.random()*1.3,color:i,alpha:.85})}return n}function tt(t,e,o=18,i=18){const n=[];for(let l=0;l<i;l++){const s=Math.random()*Math.PI*2,a=Math.random()*o,r=t+Math.cos(s)*a,c=e+Math.sin(s)*a,h=Math.random()*40+20,d=Math.cos(s)*h*.6,A=Math.sin(s)*h*.6,p=["#eeeeee","#e0e0e0","#cccccc","#bbbbbb"],f=p[Math.floor(Math.random()*p.length)],g=.6+Math.random()*.8;n.push({x:r,y:c,vx:d,vy:A,life:g,maxLife:g,size:2.2+Math.random()*2.8,color:f,alpha:.5})}return n}function ot(t,e){return t.filter(o=>(o.x+=o.vx*e,o.y+=o.vy*e,o.vy+=30*e,o.vx*=.98,o.vy*=.98,o.life-=e,o.alpha=Math.max(0,o.life/o.maxLife*.8),o.size*=.995,o.life>0))}function It(t,e){t.save();for(const o of e)t.globalAlpha=o.alpha,t.fillStyle=o.color,t.beginPath(),t.arc(o.x,o.y,o.size,0,Math.PI*2),t.fill(),o.alpha>.2&&(t.globalAlpha=o.alpha*.25,t.beginPath(),t.arc(o.x,o.y,o.size*2.5,0,Math.PI*2),t.fill()),o.life/o.maxLife>.7&&(t.globalAlpha=o.alpha*.8,t.fillStyle="#ffffff",t.beginPath(),t.arc(o.x,o.y,o.size*.4,0,Math.PI*2),t.fill());t.restore()}function Xi(t,e){t.setTransform(1,0,0,1,0,0),t.fillStyle=G.sky,t.fillRect(0,0,e.width,e.height)}function qi(t,e){t.translate(-e.x*e.zoom,-e.y*e.zoom),t.scale(e.zoom,e.zoom)}function ji(t){t.save(),t.fillStyle=G.ground,t.fillRect(0,0,N.w,N.h);const e=t.getTransform?t.getTransform():null,o=e?Math.max(.001,e.a):1;t.lineWidth=Math.max(1/o,.75/o),t.strokeStyle="#1e293b",t.globalAlpha=.5,t.beginPath();for(let i=0;i<=N.w;i+=y)t.moveTo(i,0),t.lineTo(i,N.h);for(let i=0;i<=N.h;i+=y)t.moveTo(0,i),t.lineTo(N.w,i);t.stroke(),t.globalAlpha=1,t.restore()}function it(t,e,o,i,n){t.fillStyle=n,t.beginPath(),t.arc(e,o,i,0,Math.PI*2),t.fill()}function Vi(t,e,o,i,n,l,s=0){t.fillStyle=l,t.beginPath();for(let a=0;a<n;a++){const r=s+a*2*Math.PI/n,c=e+Math.cos(r)*i,h=o+Math.sin(r)*i;a===0?t.moveTo(c,h):t.lineTo(c,h)}t.closePath(),t.fill()}function Zi(t,e,o,i=10,n=G.colonist){t.save(),t.translate(e,o);const l="#0b0f14",s=i*.32,a=-i*.3;t.fillStyle=n,t.beginPath(),t.arc(0,a,s,0,Math.PI*2),t.fill(),t.strokeStyle=l,t.lineWidth=1,t.beginPath(),t.arc(0,a,s+.5,0,Math.PI*2),t.stroke();const r=i*.55,c=i*.55,h=-i*.05;t.fillStyle=n,t.beginPath(),t.moveTo(-r/2,h-c/2),t.lineTo(r/2,h-c/2),t.lineTo(r/2,h+c/2),t.lineTo(-r/2,h+c/2),t.closePath(),t.fill(),t.strokeStyle=l,t.stroke();const d=i*.18,A=i*.5,p=h+c/2+A*.1;t.fillStyle=n,t.fillRect(-d-.6,p-A,d,A),t.fillRect(.6,p-A,d,A),t.strokeStyle=l,t.strokeRect(-d-.6,p-A,d,A),t.strokeRect(.6,p-A,d,A),t.restore()}function Pt(t,e,o,i,n=8,l=!1){var M,B,I,L,D,F;const s=i.profile;if(!s){t.fillStyle=l?"#93c5fd":G.colonist,t.beginPath(),t.arc(e,o,n,0,Math.PI*2),t.fill();return}t.save(),t.translate(e,o);let a="south";if(i.direction!==void 0){const T=(i.direction*180/Math.PI+360)%360;T>=315||T<45?a="east":T>=45&&T<135?a="south":T>=135&&T<225?a="east":a="north"}const r=i.direction!==void 0&&(i.direction*180/Math.PI+360)%360>=135&&(i.direction*180/Math.PI+360)%360<225,c=!!((M=i.health)!=null&&M.downed),h=32,d=48;l&&(t.fillStyle="#93c5fd",t.globalAlpha=.3,t.beginPath(),t.arc(0,0,n+2,0,Math.PI*2),t.fill(),t.globalAlpha=1);const A=K.getInstance();if(!A||!A.isLoaded()){console.log("Assets not loaded, using fallback circles for colonist:",(s==null?void 0:s.name)||"unknown"),t.fillStyle=s.avatar.clothing,t.beginPath(),t.arc(0,0,n,0,Math.PI*2),t.fill(),t.restore();return}const p=s.avatar.sprites,f=d*.6,g=(C,T)=>{const W=document.createElement("canvas");W.width=h,W.height=d;const Y=W.getContext("2d");Y.drawImage(C,0,0,h,d);const X=Y.getImageData(0,0,h,d),U=X.data,Z=T.replace("#",""),_=parseInt(Z.substr(0,2),16),J=parseInt(Z.substr(2,2),16),$=parseInt(Z.substr(4,2),16);for(let V=0;V<U.length;V+=4)if(U[V+3]>0){const te=(U[V]+U[V+1]+U[V+2])/765;U[V]=_*te,U[V+1]=J*te,U[V+2]=$*te}return Y.putImageData(X,0,0),W};t.save(),r&&t.scale(-1,1),c&&t.rotate(-Math.PI/2);const m=A.getColonistSprite("body",p.bodyType,a);if(m){const C=g(m,s.avatar.skinTone);t.drawImage(C,-h/2,-f)}const b=A.getColonistSprite("apparel",p.apparelType,a);if(b){const C=g(b,s.avatar.clothing);t.drawImage(C,-h/2,-f)}const w=A.getColonistSprite("head",p.headType,a);if(w){const C=g(w,s.avatar.skinTone);t.drawImage(C,-h/2,-f)}try{const T=(((B=i.inventory)==null?void 0:B.equipment)||{}).weapon,W=T&&T.defName&&T.defName!=="Knife",Y=i.combatTarget||(i.warmup||0)>0||(i.betweenShots||0)>0;if(!c&&W&&Y){const X=K.getInstance().getItemIcon(T.defName||T.name);if(X){let _=0,J=0;switch(a){case"east":_=6,J=-f+d*.55;break;case"north":_=-4,J=-f+d*.45;break;case"south":default:_=-2,J=-f+d*.6;break}let $=typeof i.direction=="number"?i.direction:0;typeof i.direction!="number"&&($=a==="east"?0:a==="north"?-Math.PI/2:Math.PI/2),t.save(),t.translate(_,J),t.rotate($),t.drawImage(X,-22/2,-10/2,22,10),t.restore()}}}catch{}const v=A.getColonistSprite("hair",p.hairStyle,a);if(v){const C=g(v,s.avatar.hairColor);t.drawImage(C,-h/2,-f)}t.restore(),t.save();const k=$e&&$e(i)||"Okay";let S="#22c55e";switch(k){case"Happy":S="#22c55e";break;case"Content":S="#84cc16";break;case"Okay":S="#eab308";break;case"Injured":S="#ef4444";break;case"Starving":S="#dc2626";break;case"Exhausted":S="#6b7280";break;case"Terrified":S="#7c2d12";break;case"Resting":S="#3b82f6";break;default:S="#eab308";break}t.fillStyle=S,t.beginPath(),t.arc(0,-f+d*.1,3,0,Math.PI*2),t.fill(),t.strokeStyle="#000000",t.lineWidth=.5,t.stroke();const R=i.fireCooldown||0,P=i.cooldownTotal||0,u=i.warmup||0,x=i.warmupTotal||0;if(x>0&&u>0||P>0&&R>0){const C=n+6;t.lineWidth=2,t.strokeStyle="#0b0f14aa",t.beginPath(),t.arc(0,-f+d*.1,C,0,Math.PI*2),t.stroke();const T=0,W=-f+d*.1;if(x>0&&u>0){const Y=1-Math.min(1,u/x);t.strokeStyle="#60a5fa",t.beginPath(),t.arc(T,W,C,-Math.PI/2,-Math.PI/2+Y*Math.PI*2),t.stroke()}else if(P>0&&R>0){const Y=1-Math.min(1,R/P);t.strokeStyle="#f59e0b",t.beginPath(),t.arc(T,W,C,-Math.PI/2,-Math.PI/2+Y*Math.PI*2),t.stroke()}}if((L=(I=i.game)==null?void 0:I.debug)!=null&&L.combat||(F=(D=window.game)==null?void 0:D.debug)!=null&&F.combat){t.fillStyle="#ffffff",t.font="10px system-ui";const C=x>0&&u>0?`WU ${(x-u).toFixed(2)}/${x.toFixed(2)}`:P>0&&R>0?`CD ${(P-R).toFixed(2)}/${P.toFixed(2)}`:"";C&&t.fillText(C,-16,-f+d*.1-(n+12))}t.restore(),t.restore()}function Ji(t,e,o,i=12,n="#60a5fa"){t.save(),t.translate(e,o),t.fillStyle=n,t.strokeStyle="#0b0f14",t.lineWidth=1,t.beginPath();const l=i,s=i*1.2;t.moveTo(0,-s*.5),t.lineTo(l*.35,-s*.25),t.lineTo(l*.35,s*.1),t.quadraticCurveTo(0,s*.55,-l*.35,s*.1),t.lineTo(-l*.35,-s*.25),t.closePath(),t.fill(),t.stroke(),t.restore()}function Ki(t,e){var o,i,n,l;if(e.kind==="path"){t.fillStyle="#1f2937",t.fillRect(e.x,e.y,e.w,e.h),t.strokeStyle="#0b0f14cc",t.strokeRect(e.x+.5,e.y+.5,e.w-1,e.h-1);return}if(e.kind==="house"){const s=K.getInstance(),a=s.getImage("house");a&&s.isLoaded()?(t.drawImage(a,e.x,e.y,e.w,e.h),t.strokeStyle="#0b0f14cc",t.strokeRect(e.x+.5,e.y+.5,e.w-1,e.h-1)):(t.fillStyle=e.color,t.fillRect(e.x,e.y,e.w,e.h),t.strokeStyle="#0b0f14cc",t.strokeRect(e.x+.5,e.y+.5,e.w-1,e.h-1))}else if(e.kind==="farm"&&e.done){const s=K.getInstance(),a=e.growth||0;let r="wheat_stage_1";a>=.67?r="wheat_stage_3":a>=.33&&(r="wheat_stage_2");const c=s.getImage(r);c&&s.isLoaded()?(t.drawImage(c,e.x,e.y,e.w,e.h),t.strokeStyle="#0b0f14cc",t.strokeRect(e.x+.5,e.y+.5,e.w-1,e.h-1)):(t.fillStyle=e.color,t.fillRect(e.x,e.y,e.w,e.h),t.strokeStyle="#0b0f14cc",t.strokeRect(e.x+.5,e.y+.5,e.w-1,e.h-1),a>0&&(t.fillStyle="#4ade80",t.fillRect(e.x+2,e.y+e.h-4,(e.w-4)*Math.min(a,1),2)))}else if(t.fillStyle=e.color,t.fillRect(e.x,e.y,e.w,e.h),t.strokeStyle="#0b0f14cc",t.strokeRect(e.x+.5,e.y+.5,e.w-1,e.h-1),e.kind==="turret"&&e.flashTimer>0&&(t.fillStyle="#ffffff88",t.fillRect(e.x,e.y,e.w,e.h)),e.kind==="turret"){const s=e.x+e.w/2,a=e.y+e.h/2,r=e.angle||0;t.save(),t.translate(s,a),t.rotate(r),t.fillStyle="#1f2937",t.fillRect(-2,-2,Math.max(8,e.w*.45),4),t.restore();const c=e.cooldown||0,h=e.cooldownTotal||0,d=e.warmup||0,A=e.warmupTotal||0,p=Math.max(10,Math.min(e.w,e.h)*.6);if(A>0||h>0){if(t.save(),t.lineWidth=2,t.strokeStyle="#0b0f14aa",t.beginPath(),t.arc(s,a,p,0,Math.PI*2),t.stroke(),A>0&&d>0){const f=1-Math.min(1,d/A);t.strokeStyle="#60a5fa",t.beginPath(),t.arc(s,a,p,-Math.PI/2,-Math.PI/2+f*Math.PI*2),t.stroke()}else if(h>0&&c>0){const f=1-Math.min(1,c/h);t.strokeStyle="#f59e0b",t.beginPath(),t.arc(s,a,p,-Math.PI/2,-Math.PI/2+f*Math.PI*2),t.stroke()}t.restore()}}if(!e.done){t.fillStyle="#0b1220",t.fillRect(e.x,e.y-6,e.w,4),t.fillStyle="#6ee7ff";const s=1-e.buildLeft/e.build;t.fillRect(e.x,e.y-6,s*e.w,4)}if(e.kind!=="house"&&!(e.kind==="farm"&&e.done)){t.fillStyle="#0b0f14aa",t.font="bold 12px system-ui";const s=e.x+e.w/2,a=e.y+e.h/2;let r="B";e.kind==="hq"?r="HQ":e.kind==="farm"?r="F":e.kind==="turret"?r="T":e.kind==="wall"?r="W":e.kind==="stock"?r="S":e.kind==="tent"?r="R":e.kind==="warehouse"?r="WH":e.kind==="well"?r="WL":e.kind==="infirmary"&&(r="I"),t.textAlign="center",t.textBaseline="middle",t.fillText(r,s,a)}if(e.kind==="turret"&&e.range){const s=e.x+e.w/2,a=e.y+e.h/2;t.globalAlpha=.07,t.fillStyle="#e2f3ff",t.beginPath(),t.arc(s,a,e.range,0,Math.PI*2),t.fill(),t.globalAlpha=1}if((i=(o=e.game)==null?void 0:o.debug)!=null&&i.combat||(l=(n=window.game)==null?void 0:n.debug)!=null&&l.combat){const s=e.x+e.w/2,a=e.y+e.h/2,r=e.cooldown||0,c=e.cooldownTotal||0,h=e.warmup||0,d=e.warmupTotal||0,A=d>0&&h>0?`WU ${(d-h).toFixed(2)}/${d.toFixed(2)}`:c>0&&r>0?`CD ${(c-r).toFixed(2)}/${c.toFixed(2)}`:"";A&&(t.save(),t.fillStyle="#ffffff",t.font="10px system-ui",t.fillText(A,s-16,a-Math.max(e.h,e.w)*.7),t.restore())}}function _i(t,e){for(const o of e)o.particles&&o.particles.length>0&&It(t,o.particles),t.globalAlpha=.15,t.strokeStyle="#e0f2fe",t.lineWidth=1,t.beginPath(),t.moveTo(o.x,o.y),t.lineTo(o.tx,o.ty),t.stroke(),t.globalAlpha=1}function $i(t,e,o,i){i.uiScale;const n=i.scale(i.isTouch?14:10),l=i.scale(i.isTouch?56:44),s=e.width;t.fillStyle="#0b122088",t.fillRect(0,0,s,l),t.strokeStyle="#1e293b",t.lineWidth=1,t.strokeRect(0,.5,s,l),t.fillStyle="#dbeafe",t.font=i.getScaledFont(i.isTouch?18:16,"600");let a=n;const r=Math.max(i.scale(i.isTouch?170:130),Math.min(i.scale(i.isTouch?260:220),Math.round(e.width*.14)));if(he(t,a,i.scale(12),`Wood: ${Math.floor(o.res.wood)}`,"#b08968",i),a+=r,he(t,a,i.scale(12),`Stone: ${Math.floor(o.res.stone)}`,"#9aa5b1",i),a+=Math.max(r,i.scale(i.isTouch?220:180)),he(t,a,i.scale(12),`Food: ${Math.floor(o.res.food)}`,"#9ae6b4",i),a+=r,o.storage){const m=Math.floor(o.storage.used/o.storage.max*100),b=m>90?"#ef4444":m>70?"#eab308":"#22c55e";he(t,a,i.scale(12),`Storage: ${Math.floor(o.storage.used)}/${o.storage.max} (${m}%)`,b,i),a+=Math.max(r,i.scale(i.isTouch?260:200))}const c=`Colonists: ${o.colonists}/${o.cap}`;he(t,a,i.scale(12),c,"#93c5fd",i),a+=Math.max(r,i.scale(i.isTouch?260:210));const h=`Hiding: ${o.hiding}`;he(t,a,i.scale(12),h,"#60a5fa",i),a+=Math.max(i.scale(i.isTouch?180:140),r*.9|0);const d=`Day ${o.day} — ${o.tDay*24|0}:00 ${o.isNight?"🌙":"☀️"}`;he(t,a,i.scale(12),d,o.isNight?"#ffd166":"#6ee7ff",i);const A=e.height-i.scale(i.isTouch?86:64),p=Math.max(i.scale(i.isTouch?170:140),Math.min(i.scale(i.isTouch?260:220),(e.width-n*2)/o.hotbar.length));a=n,t.fillStyle="#0b122088",t.fillRect(0,A,e.width,i.scale(i.isTouch?86:64)),t.strokeStyle="#1e293b",t.strokeRect(0,A+.5,e.width,i.scale(i.isTouch?86:64)),t.font=i.getScaledFont(i.isTouch?17:15);for(let m=0;m<o.hotbar.length;m++){const b=o.hotbar[m],w=a+i.scale(2),v=A+i.scale(i.isTouch?14:10),k=p-i.scale(6),S=i.scale(i.isTouch?60:44);en(t,w,v,k,S,`${m+1}. ${b.name}`,b.cost,b.selected,i),Array.isArray(i.hotbarRects)&&(i.hotbarRects[m]={index:m,x:w,y:v,w:k,h:S}),a+=p}let f=l+i.scale(i.isTouch?12:8);const g=Math.min(i.scale(i.isTouch?520:420),e.width-n*2);for(let m=o.messages.length-1;m>=0;m--){const b=o.messages[m];tn(t,s-g-n,f,b.text,g,i),f+=i.scale(i.isTouch?34:26)}}function he(t,e,o,i,n,l){const s=t.measureText(i).width+l.scale(l.isTouch?28:24),a=l.scale(l.isTouch?32:26);t.fillStyle="#0f172a",t.fillRect(e,o,s,a),t.strokeStyle="#1e293b",t.strokeRect(e+.5,o+.5,s-1,a-1),t.fillStyle=n,t.fillRect(e+l.scale(3),o+l.scale(3),l.scale(l.isTouch?10:8),a-l.scale(6)),t.fillStyle="#dbeafe",t.fillText(i,e+l.scale(l.isTouch?18:16),o+l.scale(l.isTouch?22:18))}function en(t,e,o,i,n,l,s,a,r){t.fillStyle=a?"#102034":"#0f172a",t.fillRect(e,o,i,n),t.strokeStyle=a?"#4b9fff":"#1e293b",t.strokeRect(e+.5,o+.5,i-1,n-1),t.fillStyle="#dbeafe",t.fillText(l,e+r.scale(10),o+r.scale(r.isTouch?36:28)),t.fillStyle="#9fb3c8",t.fillText(s,e+i-r.scale(r.isTouch?66:56),o+r.scale(r.isTouch?36:28))}function tn(t,e,o,i,n,l){const s=l.scale(l.isTouch?30:24);t.fillStyle="#0f172aee",t.fillRect(e,o,n,s),t.strokeStyle="#1e293b",t.strokeRect(e+.5,o+.5,n-1,s-1),t.fillStyle="#dbeafe",t.fillText(i,e+l.scale(10),o+l.scale(l.isTouch?20:16))}function We(t){return t.health||(t.health={bloodLoss:0,pain:0,injuries:[]}),t.health}const nt=["Head","Torso","Left Arm","Right Arm","Left Leg","Right Leg"];function on(){return nt[Math.random()*nt.length|0]}function nn(t){switch(t){case"cut":return{bleedPerSec:3,painPerSev:.5};case"bite":return{bleedPerSec:4,painPerSev:.7};case"gunshot":return{bleedPerSec:6,painPerSev:.9};case"bruise":return{bleedPerSec:.5,painPerSev:.2};default:return{bleedPerSec:2,painPerSev:.5}}}function sn(t,e,o,i="cut",n){if(!e.alive)return 0;const l=We(e),s=Math.max(1,Math.round(o)),a=nn(i),r={id:Math.random().toString(36).slice(2),kind:i,part:on(),severity:s,bleeding:a.bleedPerSec*(s/25),pain:Math.min(40,a.painPerSev*s)};return l.injuries.push(r),e.hp=Math.max(0,e.hp-o),o}function an(t,e=.5){const o=We(t);for(const i of o.injuries)i.tended||(i.tended=!0,i.bleeding*=1-Math.max(.2,Math.min(.9,.6*e)),i.pain*=.85)}function rn(t,e,o){const i=We(e),n=!!i.downed;let l=0,s=0;for(const r of i.injuries)l+=r.bleeding,s+=r.pain,!r.tended&&(r.kind==="cut"||r.kind==="bite"||r.kind==="gunshot")&&(r.infection=Math.min(100,(r.infection||0)+o*.4),(r.infection||0)>=25&&(r.infected=!0),r.infected&&(r.pain=Math.min(60,r.pain+o*.8)));l>0&&(i.bloodLoss=Math.min(100,i.bloodLoss+l*o*.2),e.hp=Math.max(0,e.hp-l*.05*o)),i.pain=Math.min(100,s);const a=i.pain>=60||i.bloodLoss>=50;if(i.downed=a||i.downed,!n&&i.downed&&e.inside){const r=e.inside;t.leaveBuilding&&t.leaveBuilding(e);const c=r.x,h=r.y,d=r.w;r.h;const A=c+d/2,p=h-(e.r||10)-6;e.x=Math.max(e.r||10,Math.min(A,t.WORLD?t.WORLD.w-(e.r||10):A)),e.y=Math.max(e.r||10,Math.min(p,t.WORLD?t.WORLD.h-(e.r||10):p))}if(i.downed){if(e.hp<=0){e.alive=!1;return}e.task=null,e.target=null}(i.bloodLoss>=100||e.hp<=0)&&(e.alive=!1)}function ve(t){var e;return!!((e=t.health)!=null&&e.downed)}function ln(t){const e=t.buildings.find(n=>n.kind==="infirmary"&&n.done);if(e)return e;const o=t.buildings.find(n=>n.kind==="house"&&n.done);return o||t.buildings.find(n=>n.kind==="hq")||null}function Se(t,e,o,i){for(const n of t.buildings){if(n.kind==="hq"||n.kind==="path"||n.kind==="house"||n.kind==="farm"||!n.done)continue;const l=Math.max(n.x,Math.min(e,n.x+n.w)),s=Math.max(n.y,Math.min(o,n.y+n.h)),a=e-l,r=o-s;if(a*a+r*r<=i*i)return!0}return!1}function cn(t,e){e.stuckTimer===void 0&&(e.stuckTimer=0),e.lastPos||(e.lastPos={x:e.x,y:e.y}),e.lastMoveCheck||(e.lastMoveCheck=0);const o=Se(t,e.x,e.y,e.r);e.lastMoveCheck+=1/60;let i=!1;if(e.lastMoveCheck>1&&(Math.hypot(e.x-e.lastPos.x,e.y-e.lastPos.y)<5&&(e.state==="chop"||e.state==="mine"||e.state==="build"||e.state==="harvest")&&(i=!0),e.lastPos={x:e.x,y:e.y},e.lastMoveCheck=0),o||i){if(e.stuckTimer+=1/60,e.stuckTimer>3){const l=[0,Math.PI/2,Math.PI,3*Math.PI/2,Math.PI/4,3*Math.PI/4,5*Math.PI/4,7*Math.PI/4];let s=!1;for(const a of[20,40,60,80]){for(const r of l){const c=e.x+Math.cos(r)*a,h=e.y+Math.sin(r)*a,d=Math.max(e.r,Math.min(c,N.w-e.r)),A=Math.max(e.r,Math.min(h,N.h-e.r));if(!Se(t,d,A,e.r)){e.x=d,e.y=A,e.stuckTimer=0,s=!0,console.log(`Rescued stuck colonist at (${e.x.toFixed(1)}, ${e.y.toFixed(1)}) using distance ${a}`);break}}if(s)break}if(!s){const a=t.buildings.find(r=>r.kind==="hq");a&&(e.x=a.x+a.w/2+(Math.random()-.5)*40,e.y=a.y-40+(Math.random()-.5)*20,e.stuckTimer=0,console.log("Emergency rescue: teleported stuck colonist to HQ area"))}return!0}}else e.stuckTimer=0;return!1}function hn(t,e,o){var k,S,R,P;if(!e.alive)return;if(e.t+=o,e.state||f("seekTask","initial state"),e.stateSince=(e.stateSince||0)+o,ve(e)&&e.state!=="downed"&&(e.task=null,e.target=null,t.clearPath&&t.clearPath(e),f("downed","incapacitated")),cn(t,e)){e.task=null,e.target=null,t.clearPath&&t.clearPath(e),f("seekTask","rescued from stuck");return}const i=e.state==="build"||e.state==="chop"||e.state==="mine"||e.state==="harvest"||e.state==="flee"||e.state==="move",n=((k=e.profile)==null?void 0:k.stats.hungerRate)||1,l=((S=e.profile)==null?void 0:S.stats.fatigueRate)||1,s=(i?.25:e.inside?.1:.15)*n;e.hunger=Math.max(0,Math.min(100,(e.hunger||0)+o*s));const a=(i?.8:.3)*l;if(e.inside||e.state==="resting"?e.fatigue=Math.max(0,(e.fatigue||0)-o*8):e.fatigue=Math.min(100,(e.fatigue||0)+o*a),e.fatigueSlow=(e.fatigue||0)>66?.8:(e.fatigue||0)>33?.9:1,(e.hunger||0)>=95){const u=2*o;e.hp=Math.max(0,e.hp-u),Math.random()<.05&&console.log(`Colonist starving: hunger=${(e.hunger||0).toFixed(1)}, hp=${e.hp.toFixed(1)}, damage=${u.toFixed(2)}/frame`)}(e.hunger||0)<30&&!i&&!e.inside&&(e.hp=Math.min(100,e.hp+.8*o));const r=t.buildings.find(u=>u.kind==="infirmary"&&u.done);if(r){const u=r.healRange||140,x=r.healRate||3;(e.x-(r.x+r.w/2))**2+(e.y-(r.y+r.h/2))**2<=u*u&&(e.hp=Math.min(100,e.hp+x*o))}const c=140*140,h=180*180,d=t.enemies.find(u=>Q(u,e)<c),A=e.state==="flee"&&e.lastDanger&&Q(e.lastDanger,e)<h,p=d||(A?e.lastDanger:null);d?e.lastDanger=d:A||(e.lastDanger=null),e.lastHp=e.lastHp??e.hp,e.hp<e.lastHp&&(e.hurt=1.5),e.lastHp=e.hp,e.hurt=Math.max(0,(e.hurt||0)-o);function f(u,x){if(!(!(B=>B==="flee"||B==="heal"||B==="sleep"&&t.isNight())(u)&&e.softLockUntil!=null&&e.t<(e.softLockUntil||0))&&e.state!==u){if(u==="sleep"||u==="flee"||u==="heal"||u==="goToSleep"||u==="eat"||u==="resting"){const I=e.task;I&&(I==="chop"||I==="mine"||I==="build"||I==="harvestFarm"||I==="harvestWell")&&(e.task==="build"&&e.target&&t.releaseBuildReservation&&t.releaseBuildReservation(e),e.target&&t.assignedTargets&&t.assignedTargets.has(e.target)&&t.assignedTargets.delete(e.target),e.task=null,e.target=null,t.clearPath&&t.clearPath(e),x&&Math.random()<.2&&console.log(`Cleared work task (${I}) when changing to ${u}: ${x}`))}const B=e.state;e.prevState=B,e.state=u,e.stateSince=0,e.lastStateChangeReason=x||"",u==="flee"&&p&&(e.dangerMemory=e.dangerMemory||[],e.dangerMemory.push({x:p.x,y:p.y,time:e.t,radius:180}),e.dangerMemory=e.dangerMemory.filter(I=>e.t-I.time<20)),u==="eat"?e.softLockUntil=e.t+1.5:u==="goToSleep"||u==="sleep"?e.softLockUntil=e.t+2:u==="resting"?e.softLockUntil=e.t+1:e.softLockUntil=void 0,x&&Math.random()<.1&&console.log(`Colonist state change: ${B} → ${u} (${x})`)}}const m=e.stateSince>1||e.state==="idle"||e.state==="seekTask"||e.state==="chop"||e.state==="mine"||e.state==="build"||e.state==="harvest"||p,b=80,w=20;function v(){let u=null;const x=(M,B,I)=>{(!u||B>u.prio)&&(u={state:M,prio:B,reason:I})};return!e.inside&&p&&x("flee",100,"danger detected"),!e.inside&&!p&&(e.hp||0)<35&&x("heal",90-Math.max(0,e.hp)*.1,"low health"),!e.inside&&!p&&t.isNight()&&x("sleep",80,"night time"),!e.inside&&!p&&!t.isNight()&&(e.fatigue||0)>=b&&x("goToSleep",70+Math.min(20,(e.fatigue||0)-b),"high fatigue"),!e.inside&&(e.hunger||0)>75&&(t.RES.food||0)>0&&x("eat",60+Math.min(25,(e.hunger||0)-75),"hunger"),x("seekTask",10,"default"),u}if(e.state!=="downed")if(e.inside&&e.state!=="resting")f("resting","entered building");else{const u=M=>{switch(M){case"flee":return 100;case"heal":return 90;case"sleep":return 80;case"goToSleep":return 75;case"eat":return 65;case"build":case"chop":case"mine":case"harvest":return 40;case"resting":return 35;case"move":return 25;case"idle":return 15;case"seekTask":return 10;default:return 0}},x=v();if(x&&x.state!==e.state){const M=x.state==="flee"||x.state==="heal"||x.state==="sleep"&&t.isNight(),B=u(e.state);(M||x.prio>B&&m)&&f(x.state,x.reason)}}switch(e.state){case"downed":break;case"tend":{const u=e.tendTarget||e,x=16,M=Math.hypot(u.x-e.x,u.y-e.y);u!==e&&M>x?t.moveAlongPath(e,o,u,x):(an(u,.5),e.tendTarget=null,f("seekTask","tended"));break}case"rescue":{const u=e.rescueTarget;if(!u||!ve(u)||!u.alive){f("seekTask","no rescue target");break}const x=14;if(Math.hypot(u.x-e.x,u.y-e.y)>x){t.moveAlongPath(e,o,u,x);break}const B=ln(t);if(!B){f("seekTask","no rescue destination");break}const I=t.centerOf(B);Math.hypot(e.x-I.x,e.y-I.y)<=20?(u.x=I.x+(Math.random()-.5)*16,u.y=I.y+(Math.random()-.5)*16,u.health&&(u.health.downed=!1),e.rescueTarget=null,t.msg(`${((R=e.profile)==null?void 0:R.name)||"Colonist"} rescued ${((P=u.profile)==null?void 0:P.name)||"colonist"}`,"good"),f("seekTask","rescued colonist")):(t.moveAlongPath(e,o,I,20),u.x=e.x,u.y=e.y);break}case"resting":{e.hideTimer=Math.max(0,(e.hideTimer||0)-o),e.hp=Math.min(100,e.hp+1.2*o);const x=(e.fatigue||0)<=w&&e.stateSince>=1;!t.isNight()&&!p&&(e.hurt||0)<=0&&(e.hideTimer||0)<=0&&x&&(t.leaveBuilding(e),e.safeTarget=null,e.safeTimer=0,f("seekTask","finished resting"));break}case"heal":{const u=t.buildings.filter(F=>F.kind==="infirmary"&&F.done);if(!u.length){f("seekTask","no infirmary");break}let x=u[0],M=Q(e,t.centerOf(x));for(let F=1;F<u.length;F++){const C=Q(e,t.centerOf(u[F]));C<M&&(M=C,x=u[F])}const B=t.centerOf(x),I=x.healRange||140,L=e.x>=x.x-8&&e.x<=x.x+x.w+8&&e.y>=x.y-8&&e.y<=x.y+x.h+8,D=Math.hypot(e.x-B.x,e.y-B.y);if(L&&t.tryEnterBuilding(e,x)){f("resting","entered infirmary");break}D<=I*.9?e.hp>=80&&f("seekTask","healed enough"):t.moveAlongPath(e,o,B,I*.9);break}case"eat":{const u=(t.RES.food||0)>0;if(Math.random()<.01&&console.log(`Colonist eating: food=${t.RES.food}, hunger=${e.hunger}, stateSince=${e.stateSince.toFixed(1)}`),!u){e.stateSince>1&&(e.hp=Math.max(0,e.hp-2.5*o)),console.log("NO FOOD AVAILABLE! Colonist will continue tasks or sleep."),f(t.isNight()?"sleep":"seekTask","no food available");break}if((e.hunger||0)>40&&(t.tryConsumeInventoryFood?t.tryConsumeInventoryFood(e):!1)){f("seekTask","ate from inventory");break}const x=t.buildings.filter(I=>(I.kind==="hq"||I.kind==="warehouse"||I.kind==="stock")&&I.done);if(Math.random()<.01&&console.log(`Food buildings found: ${x.length}, buildings: ${x.map(I=>I.kind).join(", ")}`),x.length===0){console.log(`No food buildings found! Available buildings: ${t.buildings.filter(I=>I.done).map(I=>I.kind).join(", ")}`),e.stateSince>1&&(t.RES.food-=1,e.hunger=Math.max(0,(e.hunger||0)-60),e.hp=Math.min(100,e.hp+2.5),f("seekTask","ate without building"),console.log(`Colonist ate without building! Food remaining: ${t.RES.food}`));break}let M=null,B=1/0;for(const I of x){const L=t.centerOf(I),D=Math.hypot(e.x-L.x,e.y-L.y);D<B&&(B=D,M=I)}if(M){const I=t.centerOf(M),L=Math.max(M.w,M.h)/2+e.r+15;Math.random()<.01&&console.log(`Eating: distance=${B.toFixed(1)}, reachDist=${L.toFixed(1)}, stateSince=${e.stateSince.toFixed(1)}`),B<=L?e.stateSince>.6&&(console.log("Colonist successfully ate from storage"),t.RES.food=Math.max(0,t.RES.food-1),e.hunger=Math.max(0,(e.hunger||0)-60),e.hp=Math.min(100,e.hp+2.5),f("seekTask","finished eating")):t.moveAlongPath(e,o,I,L)}break}case"flee":{if(ve(e)){f("downed","incapacitated");break}let u=null,x=null;const M=p?t.findSafeTurret(e,p):null;if(M){const B=M.range||120,I=t.centerOf(M),L=t.buildings.find(D=>D.kind==="house"&&D.done&&t.buildingHasSpace(D)&&Q(t.centerOf(D),I)<B*B);L&&(x=L,u=t.centerOf(L))}if(!u){const B=t.buildings.find(I=>I.kind==="hq"&&t.buildingHasSpace(I));B&&(x=B,u=t.centerOf(B))}if(!u&&M&&(u=t.centerOf(M)),u){const B=u.x-e.x,I=u.y-e.y,L=Math.hypot(B,I),D=x?e.x>=x.x-8&&e.x<=x.x+x.w+8&&e.y>=x.y-8&&e.y<=x.y+x.h+8:!1;if(L<=20||D)if(x&&t.tryEnterBuilding(e,x))e.hideTimer=3,f("resting","hid from danger");else{const F=t.buildings.filter(C=>C.done&&t.buildingHasSpace(C)&&(C.kind==="house"||C.kind==="hq"));if(F.length){const C=F.sort((W,Y)=>Q(e,t.centerOf(W))-Q(e,t.centerOf(Y)))[0],T=t.centerOf(C);x=C,u=T}}else t.moveAlongPath(e,o,u,20)}else if(p){const B=kt(St(e,p));e.direction=Math.atan2(B.y,B.x),e.x+=B.x*(e.speed+90)*o,e.y+=B.y*(e.speed+90)*o}p||f("seekTask","no more danger");break}case"sleep":{const u=C=>{if(!C.length)return null;const T=e.t||0,W=e.sleepTarget,Y=e.sleepTargetLockUntil||0;if(W&&C.includes(W)&&T<Y)return W;let X=C[0],U=-1/0;for(const Z of C){const _=Q(e,t.centerOf(Z)),J=t.buildingCapacity(Z),$=t.insideCounts.get(Z)||0,te=(J-$)*100-Math.sqrt(_);te>U&&(U=te,X=Z)}return e.sleepTarget=X,e.sleepTargetLockUntil=T+3,X},x=t.buildings.filter(C=>C.kind==="house"&&C.done&&t.isProtectedByTurret(C)&&t.buildingHasSpace(C));if(x.length===0){const C=t.buildings.filter(T=>(T.kind==="house"||T.kind==="hq")&&T.done&&t.buildingHasSpace(T));if(C.length>0){const T=u(C);if(!T){f("seekTask","no bed available");break}const W=t.centerOf(T);Math.hypot(W.x-e.x,W.y-e.y)<=20?t.tryEnterBuilding(e,T)?(e.hideTimer=0,e.sleepTarget=void 0,e.sleepTargetLockUntil=0,f("resting","sleeping in unprotected shelter")):(e.sleepTarget=void 0,e.sleepTargetLockUntil=0,f("resting","sleeping outside shelter")):t.moveAlongPath(e,o,W,20)}else{const T=t.buildings.find(W=>W.kind==="hq");if(T){const W=t.centerOf(T);Math.hypot(W.x-e.x,W.y-e.y)>50?t.moveAlongPath(e,o,W,40):f("resting","sleeping near HQ")}else f("resting","sleeping in place")}e.stateSince>15&&f("resting","sleep timeout - resting in place");break}if(!t.isNight()){f("seekTask","daybreak");break}let M=u(x);if(!M){f("seekTask","no bed available");break}let B=t.centerOf(M);const I=B.x-e.x,L=B.y-e.y,D=Math.hypot(I,L),F=e.x>=M.x-8&&e.x<=M.x+M.w+8&&e.y>=M.y-8&&e.y<=M.y+M.h+8;if(D<=20||F)if(t.tryEnterBuilding(e,M))e.hideTimer=0,e.sleepTarget=void 0,e.sleepTargetLockUntil=0,f("resting","fell asleep");else{e.sleepTarget=void 0,e.sleepTargetLockUntil=0;const C=t.buildings.filter(T=>T.done&&t.buildingHasSpace(T)&&(T.kind==="house"||T.kind==="hq")).sort((T,W)=>Q(e,t.centerOf(T))-Q(e,t.centerOf(W)))[0];if(C){const T=t.centerOf(C);M=C,B=T}else f("seekTask","no bed available")}else t.moveAlongPath(e,o,B,20),e.stateSince>15&&f("seekTask","sleep timeout");break}case"goToSleep":{const u=t.buildings.filter(C=>(C.kind==="house"||C.kind==="infirmary")&&C.done&&t.buildingHasSpace(C)),M=(e.fatigue||0)<=w&&e.stateSince>=2;if(u.length===0){e.stateSince>3&&(M?f("seekTask","no rest buildings, fatigue recovered"):e.fatigue=Math.max(0,(e.fatigue||0)-o*2));break}let B=u[0],I=Q(e,t.centerOf(B));for(let C=1;C<u.length;C++){const T=Q(e,t.centerOf(u[C]));T<I&&(I=T,B=u[C])}const L=t.centerOf(B),D=Math.hypot(L.x-e.x,L.y-e.y),F=e.x>=B.x-8&&e.x<=B.x+B.w+8&&e.y>=B.y-8&&e.y<=B.y+B.h+8;if(D<=20||F)if(t.tryEnterBuilding(e,B))e.hideTimer=0,f("resting","entered rest building");else{const C=u.filter(T=>T!==B&&t.buildingHasSpace(T)).sort((T,W)=>Q(e,t.centerOf(T))-Q(e,t.centerOf(W)))[0];C?(t.centerOf(C),t.clearPath(e)):M&&f("seekTask","no available rest buildings, fatigue recovered")}else t.moveAlongPath(e,o,L,20),M&&f("seekTask","fatigue recovered while searching for rest");break}case"seekTask":{const u=t.colonists.find(x=>x!==e&&x.alive&&ve(x));if(u){e.rescueTarget=u,f("rescue","rescue downed colonist");break}if(t.isNight()){f("sleep","night time");break}if(!e.task||e.task==="idle"&&Math.random()<.05){const x=e.task;t.pickTask(e),x!==e.task&&Math.random()<.1&&console.log(`Colonist assigned task: ${e.task}, target:`,e.target)}switch(e.task){case"build":f("build","assigned build task");break;case"harvestFarm":f("harvest","assigned farm task");break;case"harvestWell":f("harvest","assigned well task");break;case"chop":f("chop","assigned chop task");break;case"mine":f("mine","assigned mine task");break;case"idle":default:e.target||(e.target={x:e.x+(Math.random()-.5)*160,y:e.y+(Math.random()-.5)*160}),f("idle","no tasks available");break}break}case"idle":{if(t.isNight()){Math.random()<.1&&console.log("Colonist was idle during night time, forcing sleep transition"),f("sleep","night time while idle");break}const u=e.target;if(!u){f("seekTask","no target");break}t.moveAlongPath(e,o,u,8)&&(e.task=null,e.target=null,t.clearPath(e),f("seekTask","reached target"));break}case"build":{const u=e.target;if(!u||u.done){t.releaseBuildReservation(e),e.task=null,e.target=null,t.clearPath(e),f("seekTask","building complete");break}const x={x:u.x+u.w/2,y:u.y+u.h/2};if(e.stateSince>15){console.log(`Build task timeout after ${e.stateSince.toFixed(1)}s, abandoning building`),t.releaseBuildReservation(e),e.task=null,e.target=null,t.clearPath(e),f("seekTask","build timeout");break}const M=Math.hypot(e.x-x.x,e.y-x.y);if(e.lastDistToNode||(e.lastDistToNode=M),e.lastDistToNode=M,t.moveAlongPath(e,o,x,12)){const B=t.getWorkSpeedMultiplier?t.getWorkSpeedMultiplier(e,"Construction"):1;if(u.buildLeft-=25*o*B,u.buildLeft<=0){if(u.done=!0,u.kind==="farm"&&(u.growth=0,u.ready=!1),Se(t,e.x,e.y,e.r)){const I=[0,Math.PI/2,Math.PI,3*Math.PI/2,Math.PI/4,3*Math.PI/4,5*Math.PI/4,7*Math.PI/4];let L=!1;for(const D of I){const F=Math.max(u.w,u.h)/2+e.r+10,C=u.x+u.w/2+Math.cos(D)*F,T=u.y+u.h/2+Math.sin(D)*F,W=Math.max(e.r,Math.min(C,N.w-e.r)),Y=Math.max(e.r,Math.min(T,N.h-e.r));if(!Se(t,W,Y,e.r)){e.x=W,e.y=Y,L=!0,Math.random()<.1&&console.log(`Moved colonist to safety after building completion: (${e.x.toFixed(1)}, ${e.y.toFixed(1)})`);break}}if(!L){const D=t.buildings.find(F=>F.kind==="hq");D&&(e.x=D.x+D.w/2,e.y=D.y-30,console.log("Emergency teleport to HQ area after building completion"))}}t.msg(u.name?u.name+" complete":"Building complete"),t.rebuildNavGrid(),t.clearPath(e),t.releaseBuildReservation(e),e.task=null,e.target=null,f("seekTask","building complete")}}break}case"harvest":{const u=e.target;if(!u){e.task=null,e.target=null,t.clearPath(e),f("seekTask","no harvest target");break}if(u.kind==="farm"&&!u.ready){e.task=null,e.target=null,t.clearPath(e),f("seekTask","farm not ready");break}const x={x:u.x+u.w/2,y:u.y+u.h/2};if(t.moveAlongPath(e,o,x,12)){if(u.kind==="farm"){u.ready=!1,u.growth=0;const M=t.addResource("food",10);M>0&&t.msg(`Farm harvested (+${M} food)`,"good")}else if(u.kind==="well"){const M=t.addResource("food",5);M>0&&t.msg(`Well collected (+${M} food)`,"good")}e.task=null,e.target=null,t.clearPath(e),f("seekTask","harvest complete")}break}case"chop":{const u=e.target;if(!u||u.hp<=0){u&&t.assignedTargets.has(u)&&t.assignedTargets.delete(u),e.task=null,e.target=null,t.clearPath(e),f("seekTask","tree gone");break}const x=u.x-e.x,M=u.y-e.y,B=Math.hypot(x,M),I=(u.r||12)+e.r+4,L=2.5;if(B<=I+L+.1){const D=t.getWorkSpeedMultiplier?t.getWorkSpeedMultiplier(e,"Woodcutting"):1;if(u.hp-=18*o*D,u.hp<=0){const F=t.addResource("wood",6);t.trees.splice(t.trees.indexOf(u),1),t.assignedTargets.has(u)&&t.assignedTargets.delete(u),F>0&&t.msg(`+${F} wood`,"good"),t.rebuildNavGrid(),e.task=null,e.target=null,t.clearPath(e),f("seekTask","chopped tree")}break}else t.moveAlongPath(e,o,u,I+L),e.lastDistToNode||(e.lastDistToNode=B),e.lastDistToNode=B;e.stateSince&&e.stateSince>20&&(console.log(`Chop task timeout after ${e.stateSince.toFixed(1)}s, abandoning tree`),t.assignedTargets.has(u)&&t.assignedTargets.delete(u),e.task=null,e.target=null,t.clearPath(e),f("seekTask","chop timeout"));break}case"mine":{const u=e.target;if(!u||u.hp<=0){u&&t.assignedTargets.has(u)&&t.assignedTargets.delete(u),e.task=null,e.target=null,t.clearPath(e),f("seekTask","rock gone");break}const x=u.x-e.x,M=u.y-e.y,B=Math.hypot(x,M),I=(u.r||12)+e.r+4,L=2.5;if(Math.random()<.01&&console.log(`Mining: distance=${B.toFixed(1)}, interact=${I}, colonist at (${e.x.toFixed(1)}, ${e.y.toFixed(1)}), rock at (${u.x.toFixed(1)}, ${u.y.toFixed(1)})`),B<=I+L+.1){const D=t.getWorkSpeedMultiplier?t.getWorkSpeedMultiplier(e,"Mining"):1;if(u.hp-=16*o*D,u.hp<=0){const F=t.addResource("stone",5);t.rocks.splice(t.rocks.indexOf(u),1),t.assignedTargets.has(u)&&t.assignedTargets.delete(u),F>0&&t.msg(`+${F} stone`,"good"),t.rebuildNavGrid(),e.task=null,e.target=null,t.clearPath(e),f("seekTask","mined rock")}break}else t.moveAlongPath(e,o,u,I+L),Math.random()<.01&&console.log(`Moving toward rock: target=(${u.x.toFixed(1)}, ${u.y.toFixed(1)}), distance=${B.toFixed(1)}`);e.stateSince&&e.stateSince>15&&(console.log(`Colonist stuck mining for ${e.stateSince.toFixed(1)}s, abandoning`),t.assignedTargets.has(u)&&t.assignedTargets.delete(u),e.task=null,e.target=null,t.clearPath(e),f("seekTask","mine timeout"));break}}e.overlapTimers||(e.overlapTimers=new Map);for(const u of t.colonists){if(u===e||!u.alive)continue;if((e.state==="mine"||e.state==="chop")&&e.target){const C=(e.target.r||12)+e.r+4;if(Math.hypot(e.x-e.target.x,e.y-e.target.y)<=C+2.5)continue}if(e.inside||u.inside)continue;const x=e.x-u.x,M=e.y-u.y,B=x*x+M*M,I=e.r+u.r+8,L=I*I,D=u.id||u,F=e.overlapTimers;if(B>0&&B<L){if(F.has(D)||F.set(D,0),F.set(D,F.get(D)+o),F.get(D)>=1){const T=Math.sqrt(B)||1,Y=(I-T)/I*.3;e.x+=x/T*Y*o*3,e.y+=M/T*Y*o*3}}else F.delete(D)}}function Be(t,e,o,i){for(const n of t.buildings){if(n.kind==="hq"||n.kind==="path"||n.kind==="house"||n.kind==="farm"||!n.done)continue;const l=Math.max(n.x,Math.min(e,n.x+n.w)),s=Math.max(n.y,Math.min(o,n.y+n.h)),a=e-l,r=o-s;if(a*a+r*r<=i*i)return!0}return!1}function dn(t,e,o){const i=t.buildings.find(h=>h.kind==="hq");let n=i,l=Q(e,t.centerOf(i));for(const h of t.colonists){const d=Q(e,h);d<l&&(l=d,n=h)}const s=n.w?t.centerOf(n):n,a=kt(St(s,e)),r=e.x+a.x*e.speed*o,c=e.y+a.y*e.speed*o;if(!Be(t,r,c,e.r))e.x=r,e.y=c;else{const h=-a.y,d=a.x,A=e.x+h*e.speed*o*.5,p=e.y+d*e.speed*o*.5;if(!Be(t,A,p,e.r))e.x=A,e.y=p;else{const f=e.x-h*e.speed*o*.5,g=e.y-d*e.speed*o*.5;Be(t,f,g,e.r)||(e.x=f,e.y=g)}}if(n.w){const h=n;t.pointInRect(e,h)&&(h.hp-=e.dmg*o),h.hp<=0&&(h.kind==="hq"?t.lose():(t.evictColonistsFrom(h),t.buildings.splice(t.buildings.indexOf(h),1),t.msg((h.name||h.kind)+" destroyed","warn")))}else{const h=n;Math.hypot(e.x-h.x,e.y-h.y)<e.r+8&&(sn(t,h,e.dmg*o,"bite"),h.hp<=0&&(h.alive=!1,t.colonists.splice(t.colonists.indexOf(h),1),t.msg("A colonist has fallen","warn")))}}function fn(t){const e=t.ctx,o=t.canvas.width,i=t.canvas.height,n=t.isTouch,l=Math.min(t.scale(n?980:860),o-t.scale(n?28:40)),s=Math.min(t.scale(n?720:620),i-t.scale(n?60:80)),a=(o-l)/2,r=(i-s)/2;e.save(),e.fillStyle="#0b1628dd",e.fillRect(a,r,l,s),e.strokeStyle="#1e293b",e.strokeRect(a+.5,r+.5,l-1,s-1),e.fillStyle="#dbeafe",e.font=t.getScaledFont(n?22:18,"600"),e.fillText("Build Menu (B to close)",a+t.scale(14),r+t.scale(24));const c=Zt(z),h=Object.keys(c),d=t.scale(n?36:28),A=Math.floor((l-d)/Math.max(1,h.length));t.menuRects=[];let p=null;for(let m=0;m<h.length;m++){const b=a+t.scale(12)+m*A;let w=r+t.scale(50);const v=h[m];e.fillStyle="#93c5fd",e.font=t.getScaledFont(n?18:15,"600"),e.fillText(v,b,w),w+=t.scale(n?12:8);const k=c[v];for(const[S,R]of k){w+=t.scale(n?12:8);const P=t.scale(n?78:58),u=A-t.scale(18),x=b,M=w,B=t.mouse.x*t.DPR,I=t.mouse.y*t.DPR,L=B>=x&&B<=x+u&&I>=M&&I<=M+P;e.fillStyle=t.selectedBuild===S?"#102034":L?"#1a1f2e":"#0f172a",e.fillRect(x,M,u,P),e.strokeStyle=t.selectedBuild===S?"#4b9fff":L?"#3b82f6":"#1e293b",e.strokeRect(x+.5,M+.5,u-1,P-1),e.fillStyle="#dbeafe",e.font=t.getScaledFont(n?18:15,"600"),e.fillText(R.name,x+t.scale(10),M+t.scale(n?22:18));const D=t.costText(R.cost||{});e.fillStyle="#9fb3c8",e.font=t.getScaledFont(n?14:12);const F=Math.min(t.scale(n?120:100),e.measureText(D).width+t.scale(4));if(e.fillText(D,x+u-F,M+t.scale(n?22:18)),R.description){e.fillStyle="#94a3b8",e.font=t.getScaledFont(n?14:12);const C=u-t.scale(18);let T=R.description;for(;e.measureText(T).width>C&&T.length>10;)T=T.substring(0,T.length-4)+"...";e.fillText(T,x+t.scale(10),M+t.scale(n?46:36))}if(L&&R.description&&(p={key:S,desc:R.description}),t.menuRects.push({key:S,x,y:M,w:u,h:P}),w+=P,w>r+s-t.scale(n?90:70))break}}if(p){const m=t.scale(n?16:14),b=t.scale(n?420:360);e.font=t.getScaledFont(n?16:14);const w=An(t,p.desc,b-m*2),v=t.scale(n?20:18),k=w.length*v+m*2,S=t.mouse.x*t.DPR,R=t.mouse.y*t.DPR;let P=S+t.scale(20),u=R-k-t.scale(10);P+b>o&&(P=S-b-t.scale(20)),u<0&&(u=R+t.scale(20)),e.fillStyle="#0f1419f0",e.fillRect(P,u,b,k),e.strokeStyle="#374151",e.strokeRect(P+.5,u+.5,b-1,k-1),e.fillStyle="#e5e7eb";for(let x=0;x<w.length;x++)e.fillText(w[x],P+m,u+m+(x+1)*v-t.scale(4))}e.fillStyle="#9fb3c8",e.font=t.getScaledFont(n?16:14);const f="Click a building to select • Hover for details • Press B to close",g=e.measureText(f).width;e.fillText(f,(o-g)/2,r+s+t.scale(n?30:24)),e.restore()}function st(t){const e=t.mouse.x*t.DPR,o=t.mouse.y*t.DPR;for(const i of t.menuRects)if(e>=i.x&&e<=i.x+i.w&&o>=i.y&&o<=i.y+i.h){t.selectedBuild=i.key,t.showBuildMenu=!1,t.toast("Selected: "+z[i.key].name);return}t.showBuildMenu=!1}function An(t,e,o){const i=t.ctx,n=e.split(" "),l=[];let s="";for(const a of n){const r=s+(s?" ":"")+a;i.measureText(r).width<=o?s=r:(s&&l.push(s),s=a)}return s&&l.push(s),l}function un(t,e){const o=t.ctx,i=t.canvas.width,n=t.canvas.height,l=Math.min(860,Math.floor(i*.72)),s=Math.min(600,Math.floor(n*.78)),a=Math.min(t.scale(580),l),r=Math.min(t.scale(480),s),c=t.scale(12),h=Math.max(c,Math.floor(i*.02)),d=Math.max(t.scale(110),Math.floor(n*.08)),A=Math.min(d,n-r-c);o.save(),o.fillStyle="#0b1220cc",o.fillRect(h,A,a,r),o.strokeStyle="#1e293b",o.strokeRect(h+.5,A+.5,a-1,r-1);const p=t.scale(36);o.fillStyle="#0f172a",o.fillRect(h,A,a,p),o.strokeStyle="#1e293b",o.strokeRect(h+.5,A+.5,a-1,p-1);const f=t.scale(28),g=t.scale(6),m=h+a-g-f,b=A+Math.floor((p-f)/2);o.fillStyle="#0f172a",o.fillRect(m,b,f,f),o.strokeStyle="#1e293b",o.strokeRect(m+.5,b+.5,f-1,f-1),o.fillStyle="#dbeafe",o.font=t.getScaledFont(16,"700"),o.textAlign="center",o.textBaseline="middle",o.fillText("✕",m+f/2,b+f/2+t.scale(1)),o.fillStyle="#9fb3c8",o.textAlign="left",o.font=t.getScaledFont(14,"600"),o.fillText("Colonist",h+t.scale(12),A+Math.floor(p/2)+t.scale(1));const w=t.scale(32),v=A+p+t.scale(8),k=[{id:"bio",label:"Bio",icon:"👤"},{id:"health",label:"Health",icon:"❤️"},{id:"gear",label:"Gear",icon:"🎒"},{id:"social",label:"Social",icon:"👥"},{id:"stats",label:"Stats",icon:"📊"},{id:"log",label:"Log",icon:"📜"}];t.colonistTabRects=[];const S=Math.max(t.scale(70),(a-t.scale(32))/k.length);for(let u=0;u<k.length;u++){const x=k[u],M=h+t.scale(16)+u*S,B=t.colonistProfileTab===x.id;o.fillStyle=B?"#1e293b":"#0f172a",o.fillRect(M,v,S,w),o.strokeStyle=B?"#3b82f6":"#1e293b",o.strokeRect(M+.5,v+.5,S-1,w-1),o.fillStyle=B?"#60a5fa":"#9ca3af",o.font=t.getScaledFont(10,"600"),o.textAlign="center",o.textBaseline="middle";const I=v+w/2;o.fillText(`${x.icon} ${x.label}`,M+S/2,I),t.colonistTabRects.push({tab:x.id,x:M,y:v,w:S,h:w})}const R=v+w+t.scale(10),P=r-(R-A)-t.scale(16);switch(o.save(),o.beginPath(),o.rect(h+t.scale(8),R,a-t.scale(16),P),o.clip(),t.colonistProfileTab){case"bio":pn(t,e,h+t.scale(16),R,a-t.scale(32),P);break;case"health":gn(t,e,h+t.scale(16),R,a-t.scale(32),P);break;case"gear":mn(t,e,h+t.scale(16),R,a-t.scale(32),P);break;case"social":yn(t,e,h+t.scale(16),R,a-t.scale(32));break;case"stats":wn(t,e,h+t.scale(16),R,a-t.scale(32));break;case"log":bn(t,e,h+t.scale(16),R,a-t.scale(32),P);break}o.restore(),o.fillStyle="#4b5563",o.font=t.getScaledFont(9),o.textAlign="left",o.fillText(t.follow?"Following (Esc to stop)":"Click to follow",h+t.scale(16),A+r-t.scale(8)),t.colonistPanelRect={x:h,y:A,w:a,h:r},t.colonistPanelCloseRect={x:m,y:b,w:f,h:f},o.restore()}function pn(t,e,o,i,n,l){var g;const s=t.ctx;let a=i+t.scale(8);const r=t.scale(64),c=o+t.scale(8),h=a;s.fillStyle="#0f172a",s.fillRect(c,h,r,r),s.strokeStyle="#1e293b",s.strokeRect(c+.5,h+.5,r-1,r-1),s.save(),s.translate(c+r/2,h+r/2),s.scale(t.uiScale*2,t.uiScale*2),Pt(s,0,0,e,16,!0),s.restore();const d=e.profile,A=c+r+t.scale(16);let p=h+t.scale(8);if(s.fillStyle="#dbeafe",s.font=t.getScaledFont(18,"700"),s.textAlign="left",d){s.fillText(d.name,A,p),p+=t.scale(22),s.font=t.getScaledFont(13,"400"),s.fillStyle="#94a3b8",s.fillText(d.background,A,p),p+=t.scale(16),s.fillStyle="#60a5fa";const m=d.age||Math.floor(Math.random()*30)+20;s.fillText(`Age: ${m}`,A,p),p+=t.scale(14),(g=d.detailedInfo)!=null&&g.birthplace&&(s.fillStyle="#a78bfa",s.fillText(`From: ${d.detailedInfo.birthplace}`,A,p),p+=t.scale(14)),s.fillStyle="#fbbf24",s.fillText(`Favorite Food: ${d.favoriteFood}`,A,p)}else s.fillText("Unnamed Colonist",A,p),p+=t.scale(22),s.font=t.getScaledFont(13,"400"),s.fillStyle="#94a3b8",s.fillText("No background available",A,p);a=h+r+t.scale(20);const f=d==null?void 0:d.detailedInfo;if(d&&d.personality.length>0){s.fillStyle="#f1f5f9",s.font=t.getScaledFont(14,"600"),s.fillText("Personality Traits",o,a),a+=t.scale(18);for(const m of d.personality)s.fillStyle="#60a5fa",s.font=t.getScaledFont(12,"400"),s.fillText(`• ${m}`,o+t.scale(8),a),a+=t.scale(16);a+=t.scale(8)}if(f&&f.family&&(s.fillStyle="#f1f5f9",s.font=t.getScaledFont(14,"600"),s.fillText("Family",o,a),a+=t.scale(18),s.fillStyle="#10b981",s.font=t.getScaledFont(11,"400"),f.family.parents.length>0&&(s.fillText(`Parents: ${f.family.parents.join(", ")}`,o+t.scale(8),a),a+=t.scale(14)),f.family.siblings.length>0&&(s.fillText(`Siblings: ${f.family.siblings.join(", ")}`,o+t.scale(8),a),a+=t.scale(14)),f.family.spouse&&(s.fillText(`Spouse: ${f.family.spouse}`,o+t.scale(8),a),a+=t.scale(14)),f.family.children.length>0&&(s.fillText(`Children: ${f.family.children.join(", ")}`,o+t.scale(8),a),a+=t.scale(14)),a+=t.scale(8)),f&&f.skills&&f.skills.length>0&&(s.fillStyle="#f1f5f9",s.font=t.getScaledFont(14,"600"),s.fillText("Skills",o,a),a+=t.scale(18),s.fillStyle="#f59e0b",s.font=t.getScaledFont(11,"400"),s.fillText(`• ${f.skills.join(", ")}`,o+t.scale(8),a),a+=t.scale(16)),d&&d.backstory){s.fillStyle="#f1f5f9",s.font=t.getScaledFont(14,"600"),s.fillText("Backstory",o,a),a+=t.scale(18),s.fillStyle="#94a3b8",s.font=t.getScaledFont(11,"400");const m=d.backstory.split(" "),b=n-t.scale(16);let w="";for(let v of m){const k=w+v+" ";if(s.measureText(k).width>b&&w!==""){if(s.fillText(w.trim(),o+t.scale(8),a),a+=t.scale(14),w=v+" ",a>i+l-t.scale(20))break}else w=k}w.trim()&&a<=i+l-t.scale(20)&&s.fillText(w.trim(),o+t.scale(8),a)}}function gn(t,e,o,i,n,l){const s=t.ctx;let a=i+t.scale(8);const r=Math.max(0,Math.min(100,e.hp|0)),c=Math.max(0,Math.min(100,(e.fatigue||0)|0)),h=Math.max(0,Math.min(100,(e.hunger||0)|0)),d=t.getColonistMood?t.getColonistMood(e):"OK";s.fillStyle="#f1f5f9",s.font=t.getScaledFont(16,"600"),s.textAlign="left",s.fillText("Overall Condition",o,a),a+=t.scale(24);const A=t.scale(22),p=n-t.scale(16);t.barRow(o,a,"Health",r,"#22c55e",p),a+=A,t.barRow(o,a,"Energy",100-c,"#eab308",p),a+=A,t.barRow(o,a,"Fullness",100-h,"#f87171",p),a+=A,a+=t.scale(8);const f=e.health;if(f){const g=Math.round(f.bloodLoss||0),m=Math.round(f.pain||0);if(t.barRow(o,a,"Blood Loss",100-g,"#60a5fa",p),a+=A,t.barRow(o,a,"Pain",m,"#ef4444",p),a+=A,a+=t.scale(8),s.fillStyle="#f1f5f9",s.font=t.getScaledFont(14,"600"),s.fillText("Injuries",o,a),a+=t.scale(18),!f.injuries||f.injuries.length===0)s.fillStyle="#6b7280",s.font=t.getScaledFont(12,"400"),s.fillText("No injuries",o+t.scale(8),a),a+=t.scale(16);else for(const R of f.injuries){const P=`${R.part} — ${R.kind} (sev ${R.severity})`+(R.tended?" [tended]":"")+(R.infected?" [infected]":"");if(s.fillStyle=R.infected?"#f87171":R.tended?"#22c55e":"#dbeafe",s.font=t.getScaledFont(12,"500"),s.fillText(P,o+t.scale(8),a),a+=t.scale(16),a>i+l-t.scale(60))break}a+=t.scale(8);const b=t.scale(110),w=t.scale(24),v=o,k=o+b+t.scale(8),S=a;s.fillStyle="#0f172a",s.fillRect(v,S,b,w),s.strokeStyle="#1e293b",s.strokeRect(v+.5,S+.5,b-1,w-1),s.fillStyle="#22c55e",s.font=t.getScaledFont(12,"600"),s.textAlign="center",s.textBaseline="middle",s.fillText("Tend",v+b/2,S+w/2+t.scale(1)),s.fillStyle="#0f172a",s.fillRect(k,S,b,w),s.strokeStyle="#1e293b",s.strokeRect(k+.5,S+.5,b-1,w-1),s.fillStyle="#60a5fa",s.font=t.getScaledFont(12,"600"),s.textAlign="center",s.textBaseline="middle",s.fillText("Rescue",k+b/2,S+w/2+t.scale(1)),t.colonistHealthActions={tend:{x:v,y:S,w:b,h:w},rescue:{x:k,y:S,w:b,h:w}}}a+=t.scale(16),s.fillStyle="#f1f5f9",s.font=t.getScaledFont(14,"600"),s.fillText("Mental State",o,a),a+=t.scale(18),s.fillStyle="#9fb3c8",s.font=t.getScaledFont(12,"400"),s.fillText(`Current Mood: ${d}`,o+t.scale(8),a)}function mn(t,e,o,i,n,l){const s=t.ctx;let a=i+t.scale(8);if(s.fillStyle="#f1f5f9",s.font=t.getScaledFont(16,"600"),s.textAlign="left",s.fillText("Equipment & Inventory",o,a),a+=t.scale(24),!e.inventory){s.fillStyle="#6b7280",s.font=t.getScaledFont(12,"400"),s.fillText("No inventory data available",o,a);return}s.fillStyle="#f1f5f9",s.font=t.getScaledFont(14,"600"),s.fillText("Equipment",o,a),a+=t.scale(18);const r=["helmet","armor","weapon","tool","shield","accessory"];for(const c of r){const h=e.inventory.equipment[c];s.fillStyle="#94a3b8",s.font=t.getScaledFont(12,"500");const d=c.charAt(0).toUpperCase()+c.slice(1);if(s.fillText(`${d}:`,o,a),h){const A=K.getInstance().getItemIcon(h.defName||h.name);if(A){const p=t.scale(18);s.drawImage(A,o+t.scale(70),a-p+t.scale(12),p,p)}s.fillStyle=at(t,h.quality||"normal"),s.font=t.getScaledFont(12,"400"),s.fillText(h.name,o+t.scale(94),a),s.fillStyle="#6b7280",s.font=t.getScaledFont(10,"400"),s.fillText(`(${h.quality||"normal"})`,o+t.scale(180),a)}else s.fillStyle="#6b7280",s.font=t.getScaledFont(12,"400"),s.fillText("None",o+t.scale(80),a);a+=t.scale(16)}if(a+=t.scale(12),s.fillStyle="#f1f5f9",s.font=t.getScaledFont(14,"600"),s.fillText("Inventory Items",o,a),a+=t.scale(18),e.inventory.items.length===0)s.fillStyle="#6b7280",s.font=t.getScaledFont(12,"400"),s.fillText("No items in inventory",o+t.scale(8),a);else for(const c of e.inventory.items){s.fillStyle=at(t,c.quality||"normal"),s.font=t.getScaledFont(12,"400");const h=K.getInstance().getItemIcon(c.defName||c.name);let d=t.scale(8);if(h){const p=t.scale(16);s.drawImage(h,o+d,a-p+t.scale(12),p,p),d+=t.scale(20)}const A=`${c.name} (${c.quantity})`;if(s.fillText(A,o+d,a),s.fillStyle="#6b7280",s.font=t.getScaledFont(10,"400"),s.fillText(`${c.quality||"normal"}`,o+t.scale(150),a),c.durability!==void 0&&s.fillText(`${Math.round(c.durability)}%`,o+t.scale(200),a),a+=t.scale(16),a>i+l-t.scale(20)){s.fillStyle="#6b7280",s.font=t.getScaledFont(10,"400"),s.fillText("...more items",o+t.scale(8),a);break}}e.carrying&&(a+=t.scale(12),s.fillStyle="#f1f5f9",s.font=t.getScaledFont(14,"600"),s.fillText("Currently Carrying",o,a),a+=t.scale(18),s.fillStyle="#22c55e",s.font=t.getScaledFont(12,"400"),s.fillText(`${e.carrying.type||"Item"}`,o+t.scale(8),a))}function yn(t,e,o,i,n,l){var c;const s=t.ctx;let a=i+t.scale(8);s.fillStyle="#f1f5f9",s.font=t.getScaledFont(16,"600"),s.textAlign="left",s.fillText("Social Relationships",o,a),a+=t.scale(24),s.fillStyle="#94a3b8",s.font=t.getScaledFont(12,"400"),s.fillText("Social skill: Novice",o,a),a+=t.scale(16),a+=t.scale(16),s.fillStyle="#f1f5f9",s.font=t.getScaledFont(14,"600"),s.fillText("Colony Relationships",o,a),a+=t.scale(18);const r=t.colonists.filter(h=>h!==e&&h.alive);if(r.length>0)for(let h=0;h<Math.min(r.length,3);h++){const d=r[h],A=["Neutral","Friend","Good friend","Rival"][Math.floor(Math.random()*4)],p=A==="Friend"||A==="Good friend"?"#22c55e":A==="Rival"?"#ef4444":"#94a3b8";s.fillStyle="#dbeafe",s.font=t.getScaledFont(11,"500"),s.fillText(((c=d.profile)==null?void 0:c.name)||"Colonist",o+t.scale(8),a),s.fillStyle=p,s.font=t.getScaledFont(11,"400"),s.fillText(A,o+t.scale(120),a),a+=t.scale(16)}else s.fillStyle="#6b7280",s.font=t.getScaledFont(11,"400"),s.fillText("No other colonists in colony",o+t.scale(8),a)}function wn(t,e,o,i,n,l){const s=t.ctx;let a=i+t.scale(8);s.fillStyle="#f1f5f9",s.font=t.getScaledFont(16,"600"),s.textAlign="left",s.fillText("Skills & Abilities",o,a),a+=t.scale(24);const r=e.profile;if(r&&r.stats){const h=[{name:"Work Speed",value:Math.round(r.stats.workSpeed*100),suffix:"%"},{name:"Social Bonus",value:Math.round(r.stats.socialBonus*100),suffix:"%"},{name:"Hunger Rate",value:Math.round(r.stats.hungerRate*100),suffix:"%"},{name:"Fatigue Rate",value:Math.round(r.stats.fatigueRate*100),suffix:"%"}];for(const d of h)s.fillStyle="#94a3b8",s.font=t.getScaledFont(12,"500"),s.fillText(`${d.name}:`,o,a),s.fillStyle="#dbeafe",s.font=t.getScaledFont(12,"400"),s.fillText(`${d.value}${d.suffix}`,o+t.scale(120),a),a+=t.scale(18)}a+=t.scale(16),s.fillStyle="#f1f5f9",s.font=t.getScaledFont(14,"600"),s.fillText("Skills",o,a),a+=t.scale(18);const c=["Construction","Farming","Mining","Research","Combat"].map(h=>({name:h,level:Math.floor(Math.random()*10)+1}));for(const h of c){s.fillStyle="#94a3b8",s.font=t.getScaledFont(11,"400"),s.fillText(`${h.name}:`,o+t.scale(8),a);const d=h.level>=8?"#22c55e":h.level>=5?"#eab308":"#6b7280";s.fillStyle=d,s.fillText(`Level ${h.level}`,o+t.scale(100),a),a+=t.scale(16)}}function bn(t,e,o,i,n,l){const s=t.ctx;let a=i+t.scale(8);s.fillStyle="#f1f5f9",s.font=t.getScaledFont(16,"600"),s.textAlign="left",s.fillText("Activity Log",o,a),a+=t.scale(24);const r=[{time:`Day ${t.day} 08:30`,action:"Started construction work",type:"work"},{time:`Day ${t.day} 07:45`,action:"Finished eating breakfast",type:"need"},{time:`Day ${t.day} 07:00`,action:"Woke up",type:"rest"},{time:`Day ${t.day-1} 22:30`,action:"Went to sleep",type:"rest"},{time:`Day ${t.day-1} 19:15`,action:"Had dinner",type:"need"}];for(const c of r){const h=c.type==="work"?"#60a5fa":c.type==="need"?"#22c55e":c.type==="rest"?"#a78bfa":"#94a3b8";if(s.fillStyle="#6b7280",s.font=t.getScaledFont(10,"400"),s.fillText(c.time,o,a),s.fillStyle=h,s.font=t.getScaledFont(11,"400"),s.fillText(c.action,o+t.scale(100),a),a+=t.scale(16),a>i+l-t.scale(20))break}}function at(t,e){switch(e.toLowerCase()){case"legendary":return"#a855f7";case"masterwork":return"#f59e0b";case"excellent":return"#10b981";case"good":return"#3b82f6";case"normal":return"#6b7280";case"poor":return"#ef4444";case"awful":return"#991b1b";default:return"#6b7280"}}function rt(t,e,o,i){var c;const n=!e.task||e.task==="idle",l=e.hp<50,s=(e.hunger||0)>60,a=(e.fatigue||0)>60,r=!!((c=e.health)!=null&&c.downed);t.contextMenu={visible:!0,x:o,y:i,target:e,openSubmenu:void 0,items:[{id:"prioritize",label:"Prioritize",icon:"⚡",enabled:!0,submenu:[{id:"prioritize_work",label:"Work Tasks",icon:"🔨",enabled:!0},{id:"prioritize_build",label:"Construction",icon:"🏗️",enabled:!0},{id:"prioritize_haul",label:"Hauling",icon:"📦",enabled:!0},{id:"prioritize_research",label:"Research",icon:"🔬",enabled:!0}]},{id:"force",label:"Force",icon:"❗",enabled:!0,submenu:[{id:"force_rest",label:"Rest Now",icon:"😴",enabled:a},{id:"force_eat",label:"Eat Now",icon:"🍽️",enabled:s},{id:"force_work",label:"Work",icon:"⚒️",enabled:n},{id:"force_guard",label:"Guard Area",icon:"🛡️",enabled:!0}]},{id:"goto",label:"Go To",icon:"🎯",enabled:!0,submenu:[{id:"goto_hq",label:"HQ",icon:"🏠",enabled:!0},{id:"goto_safety",label:"Safe Room",icon:"🛡️",enabled:!0},{id:"goto_bed",label:"Nearest Bed",icon:"🛏️",enabled:!0},{id:"goto_food",label:"Food Storage",icon:"🥘",enabled:!0}]},{id:"medical",label:"Medical",icon:"🏥",enabled:l||r,submenu:[{id:"medical_treat",label:"Treat Wounds",icon:"🩹",enabled:l&&!r},{id:"medical_rescue",label:"Rescue Downed",icon:"🚑",enabled:r},{id:"medical_rest",label:"Bed Rest",icon:"🛌",enabled:l},{id:"medical_surgery",label:"Surgery",icon:"⚕️",enabled:!1}]},{id:"cancel",label:"Cancel Current Task",icon:"❌",enabled:!!e.target},{id:"follow",label:t.follow&&t.selColonist===e?"Stop Following":"Follow",icon:"👁️",enabled:!0}]}}function xn(t){t.contextMenu=null,t.contextMenuRects=[]}function vn(t){if(!t.contextMenu||!t.contextMenu.visible)return;const e=t.ctx,o=t.contextMenu;e.save();const i=t.scale(32),n=t.scale(220),l=t.scale(8),s=t.scale(24),a=o.items,r=a.length*i+l*2;let c=o.x,h=o.y;c+n>t.canvas.width&&(c=t.canvas.width-n-t.scale(10)),h+r>t.canvas.height&&(h=t.canvas.height-r-t.scale(10)),e.fillStyle="rgba(0, 0, 0, 0.4)",e.fillRect(c+3,h+3,n,r),e.fillStyle="#1e293b",e.fillRect(c,h,n,r),e.strokeStyle="#374151",e.lineWidth=1,e.strokeRect(c+.5,h+.5,n-1,r-1),t.contextMenuRects=[];let d=h+l;for(let A=0;A<a.length;A++){const p=a[A],f=d+A*i,g=Et(t.mouse.x*t.DPR,t.mouse.y*t.DPR,{x:c,y:f,w:n,h:i});if(t.contextMenuRects.push({id:p.id,x:c,y:f,w:n,h:i}),g&&p.enabled&&(e.fillStyle="#374151",e.fillRect(c+1,f,n-2,i)),p.submenu&&o.openSubmenu===p.id&&(e.fillStyle="#475569",e.fillRect(c+1,f,n-2,i)),e.fillStyle=p.enabled?"#f1f5f9":"#6b7280",e.font=t.getScaledFont(16,"400"),e.textAlign="left",e.textBaseline="middle",e.fillText(p.icon,c+l,f+i/2),e.fillStyle=p.enabled?"#f1f5f9":"#6b7280",e.font=t.getScaledFont(14,"400"),e.fillText(p.label,c+l+s,f+i/2),p.submenu){e.fillStyle=p.enabled?"#9ca3af":"#4b5563";const m=o.openSubmenu===p.id?"▼":"▶";e.fillText(m,c+n-l-t.scale(16),f+i/2),o.openSubmenu===p.id&&Mn(t,p,c+n+t.scale(5),f)}}e.restore()}function Mn(t,e,o,i){const n=t.ctx,l=e.submenu;if(!l||l.length===0)return;const s=t.scale(30),a=t.scale(200),r=t.scale(8),c=t.scale(22),h=l.length*s+r*2;let d=o,A=i;d+a>t.canvas.width&&(d=o-a-t.scale(225)),A+h>t.canvas.height&&(A=t.canvas.height-h-t.scale(10)),n.fillStyle="rgba(0, 0, 0, 0.4)",n.fillRect(d+3,A+3,a,h),n.fillStyle="#1e293b",n.fillRect(d,A,a,h),n.strokeStyle="#374151",n.strokeRect(d+.5,A+.5,a-1,h-1);for(let p=0;p<l.length;p++){const f=l[p],g=A+r+p*s,m=Et(t.mouse.x*t.DPR,t.mouse.y*t.DPR,{x:d,y:g,w:a,h:s});t.contextMenuRects.push({id:f.id,x:d,y:g,w:a,h:s,isSubmenu:!0,parentId:e.id}),m&&f.enabled&&(n.fillStyle="#374151",n.fillRect(d+1,g,a-2,s)),n.fillStyle=f.enabled?"#f1f5f9":"#6b7280",n.font=t.getScaledFont(14,"400"),n.textAlign="left",n.textBaseline="middle",n.fillText(f.icon,d+r,g+s/2),n.fillStyle=f.enabled?"#f1f5f9":"#6b7280",n.font=t.getScaledFont(13,"400"),n.fillText(f.label,d+r+c,g+s/2)}}function Et(t,e,o){return t>=o.x&&t<=o.x+o.w&&e>=o.y&&e<=o.y+o.h}function xe(t,e,o,i){const n=e.w??e.size.w*y,l=e.h??e.size.h*y,s={x:o,y:i,w:n,h:l};if(s.x<0||s.y<0||s.x+s.w>N.w||s.y+s.h>N.h)return!1;for(const r of t.buildings)if(!(s.x+s.w<=r.x||s.x>=r.x+r.w||s.y+s.h<=r.y||s.y>=r.y+r.h))return!1;const a=(r,c)=>{const h=Math.max(c.x,Math.min(r.x,c.x+c.w)),d=Math.max(c.y,Math.min(r.y,c.y+c.h)),A=r.x-h,p=r.y-d;return A*A+p*p<=r.r*r.r};for(const r of t.trees)if(a(r,s))return!1;for(const r of t.rocks)if(a(r,s))return!1;return!0}function Ge(t,e,o,i,n){const l=z[e];if(!l)return;const s=be(e,o,i);if(n&&(s.rot=n,n===90||n===270)){const a=s.w;s.w=s.h,s.h=a}if(!xe(t,s,s.x,s.y)){t.toast("Can't place here");return}if(!pe(t.RES,l.cost)){t.toast("Not enough resources");return}if(De(t.RES,l.cost),s.kind!=="path")for(let a=t.buildings.length-1;a>=0;a--){const r=t.buildings[a];r.kind==="path"&&!(s.x+s.w<=r.x||s.x>=r.x+r.w||s.y+s.h<=r.y||s.y>=r.y+r.h)&&t.buildings.splice(a,1)}t.buildings.push(s),t.rebuildNavGrid()}function kn(t){if(t.paused)return;const e=t.selectedBuild;if(!(!e||!z[e])){if(!t.debug.forceDesktopMode&&t.isActuallyTouchDevice&&t.lastInputWasTouch){const i=Math.floor(t.mouse.wx/y)*y,n=Math.floor(t.mouse.wy/y)*y;t.pendingPlacement={key:e,x:i,y:n,rot:0};return}Ge(t,e,t.mouse.wx,t.mouse.wy)}}function Sn(t,e,o){if(!t.pendingPlacement)return;const i=z[t.pendingPlacement.key],n=t.pendingPlacement.x+e*y,l=t.pendingPlacement.y+o*y,s=t.pendingPlacement.rot||0,a=s===90||s===270,r=(a?i.size.h:i.size.w)*y,c=(a?i.size.w:i.size.h)*y;t.pendingPlacement.x=q(n,0,N.w-r),t.pendingPlacement.y=q(l,0,N.h-c)}function Cn(t,e){if(!t.pendingPlacement)return;const o=z[t.pendingPlacement.key],i=((t.pendingPlacement.rot||0)+e+360)%360;t.pendingPlacement.rot=i;const n=i===90||i===270,l=(n?o.size.h:o.size.w)*y,s=(n?o.size.w:o.size.h)*y;t.pendingPlacement.x=q(t.pendingPlacement.x,0,N.w-l),t.pendingPlacement.y=q(t.pendingPlacement.y,0,N.h-s)}function Rn(t){if(!t.pendingPlacement)return;const{key:e,x:o,y:i,rot:n}=t.pendingPlacement,l=z[e],s=be(e,o+1,i+1);if(n&&(s.rot=n,n===90||n===270)){const r=s.w;s.w=s.h,s.h=r}if(!(xe(t,s,s.x,s.y)&&pe(t.RES,l.cost))){t.toast("Can't place here");return}t.pendingPlacement=null,Ge(t,e,o+1,i+1,n)}function Bn(t){t.pendingPlacement=null}function Tn(t,e=!1){const o=Math.floor(t.mouse.wx/y),i=Math.floor(t.mouse.wy/y);if(!e&&t.lastPaintCell&&t.lastPaintCell.gx===o&&t.lastPaintCell.gy===i)return;const n=(f,g)=>{const m=f*y+1,b=g*y+1,w=be("path",m,b);if(t.buildings.some(S=>S.kind==="path"&&S.x===w.x&&S.y===w.y))return;!t.buildings.some(S=>S.kind==="path"?!1:!(w.x+w.w<=S.x||w.x>=S.x+S.w||w.y+w.h<=S.y||w.y>=S.y+S.h))&&pe(t.RES,z.path.cost)&&(De(t.RES,z.path.cost),t.buildings.push(w))};if(t.lastPaintCell==null){n(o,i),t.lastPaintCell={gx:o,gy:i},t.rebuildNavGrid();return}let l=t.lastPaintCell.gx,s=t.lastPaintCell.gy,a=o,r=i;const c=Math.abs(a-l),h=Math.abs(r-s),d=l<a?1:-1,A=s<r?1:-1;let p=c-h;for(;n(l,s),!(l===a&&s===r);){const f=2*p;f>-h&&(p-=h,l+=d),f<c&&(p+=c,s+=A)}t.lastPaintCell={gx:o,gy:i},t.rebuildNavGrid()}function In(t,e=!1){const o=Math.floor(t.mouse.wx/y),i=Math.floor(t.mouse.wy/y);if(!e&&t.lastPaintCell&&t.lastPaintCell.gx===o&&t.lastPaintCell.gy===i)return;const n=(f,g)=>{const m=f*y+1,b=g*y+1,w=be("wall",m,b);t.buildings.some(k=>k.kind==="wall"&&k.x===w.x&&k.y===w.y)||pe(t.RES,z.wall.cost)&&xe(t,w,w.x,w.y)&&(De(t.RES,z.wall.cost),t.buildings.push(w))};if(t.lastPaintCell==null){n(o,i),t.lastPaintCell={gx:o,gy:i},t.rebuildNavGrid();return}let l=t.lastPaintCell.gx,s=t.lastPaintCell.gy,a=o,r=i;const c=Math.abs(a-l),h=Math.abs(r-s),d=l<a?1:-1,A=s<r?1:-1;let p=c-h;for(;n(l,s),!(l===a&&s===r);){const f=2*p;f>-h&&(p-=h,l+=d),f<c&&(p+=c,s+=A)}t.lastPaintCell={gx:o,gy:i},t.rebuildNavGrid()}function Pn(t,e){const o=t.buildings.length;for(let n=t.buildings.length-1;n>=0;n--){const l=t.buildings[n];if(l.kind==="hq")continue;!(e.x+e.w<=l.x||e.x>=l.x+l.w||e.y+e.h<=l.y||e.y>=l.y+l.h)&&(Ye(t,l),t.buildings.splice(n,1),t.buildReservations.delete(l),t.insideCounts.delete(l))}const i=o-t.buildings.length;i>0&&(t.msg(`Removed ${i} structure(s)`),t.rebuildNavGrid())}function En(t){const e={x:t.mouse.wx,y:t.mouse.wy};for(let o=t.buildings.length-1;o>=0;o--){const i=t.buildings[o];if(i.kind!=="hq"&&e.x>=i.x&&e.x<=i.x+i.w&&e.y>=i.y&&e.y<=i.y+i.h){Ye(t,i),t.buildings.splice(o,1),t.msg("Building removed"),t.rebuildNavGrid();return}}t.selectedBuild=null,t.toast("Build canceled")}function Ye(t,e){const o=e.x+e.w/2,i=e.y+e.h/2;for(const n of t.colonists)if(n.inside===e){t.leaveBuilding(n),n.safeTarget=null,n.safeTimer=0;const l=Math.random()*Math.PI*2,s=(e.w/2+10)*Math.cos(l),a=(e.h/2+10)*Math.sin(l);n.x=q(o+s,0,N.w),n.y=q(i+a,0,N.h)}}function Dn(t){const e=t.pendingPlacement;if(!e)return;const o=z[e.key],i=t.ctx,n=o.size.w*y,l=o.size.h*y,a=((R,P)=>({x:(R-t.camera.x)*t.camera.zoom,y:(P-t.camera.y)*t.camera.zoom}))(e.x,e.y);let r=n*t.camera.zoom,c=l*t.camera.zoom;const h=e.rot||0;if(h===90||h===270){const R=r;r=c,c=R}i.save();const A=be(e.key,e.x+1,e.y+1),p=xe(t,A,A.x,A.y)&&pe(t.RES,o.cost);i.globalAlpha=.6,i.fillStyle=p?G.ghost:"#ff6b6b88",i.fillRect(a.x,a.y,r,c),i.globalAlpha=1,i.strokeStyle="#4b9fff",i.setLineDash([4,3]),i.strokeRect(a.x+.5,a.y+.5,r-1,c-1),i.setLineDash([]),i.restore();const f=t.scale(10),g=t.scale(42);let m=a.x+r+f,b=a.y;const w=t.canvas.width;m+g*3>w-t.scale(6)&&(m=Math.max(t.scale(6),a.x-f-g*3));const v=(R,P,u)=>({id:R,x:P,y:u,w:g,h:g}),k=[v("up",m+g,b),v("left",m,b+g),v("right",m+g*2,b+g),v("down",m+g,b+g*2),v("rotL",m,b+g*3+t.scale(6)),v("rotR",m+g*2,b+g*3+t.scale(6)),v("cancel",m,b+g*4+t.scale(6)),v("ok",m+g*2,b+g*4+t.scale(6))];t.placeUIRects=k,i.save(),i.fillStyle="#0f172aee",i.strokeStyle="#1e293b";const S=(R,P,u=!1)=>{i.save(),i.globalAlpha=u?.5:1,i.fillRect(R.x,R.y,R.w,R.h),i.strokeRect(R.x+.5,R.y+.5,R.w-1,R.h-1),i.fillStyle="#dbeafe",i.font=t.getScaledFont(18,"600"),i.textAlign="center",i.textBaseline="middle",i.fillText(P,R.x+R.w/2,R.y+R.h/2+t.scale(2)),i.restore(),i.fillStyle="#0f172aee"};for(const R of k)R.id==="up"?S(R,"↑"):R.id==="down"?S(R,"↓"):R.id==="left"?S(R,"←"):R.id==="right"?S(R,"→"):R.id==="rotL"?S(R,"⟲"):R.id==="rotR"?S(R,"⟳"):R.id==="ok"?S(R,"OK",!p):R.id==="cancel"&&S(R,"X");i.fillStyle="#dbeafe",i.font=t.getScaledFont(14,"500"),i.textAlign="left",i.textBaseline="top",i.fillText("Drag to move • Tap OK to place",Math.max(t.scale(6),a.x),Math.max(t.scale(6),a.y-t.scale(26))),i.restore()}function Dt(t,e,o,i,n){const l=n.x,s=n.x+n.w,a=n.y,r=n.y+n.h,c=Math.min(t,o),h=Math.max(t,o),d=Math.min(e,i),A=Math.max(e,i);if(h<l||c>s||A<a||d>r)return!1;const p=(f,g,m,b,w,v,k,S)=>{const R=(f-m)*(v-S)-(g-b)*(w-k);if(R===0)return!1;const P=((f-w)*(v-S)-(g-v)*(w-k))/R,u=((f-w)*(g-b)-(g-v)*(f-m))/R;return P>=0&&P<=1&&u>=0&&u<=1};return!!(p(t,e,o,i,l,a,s,a)||p(t,e,o,i,s,a,s,r)||p(t,e,o,i,s,r,l,r)||p(t,e,o,i,l,r,l,a))}function ze(t,e,o){for(const i of t.buildings)if(!(i.kind==="hq"||i.kind==="path"||i.kind==="house"||i.kind==="farm"||!i.done||e.x>=i.x&&e.x<=i.x+i.w&&e.y>=i.y&&e.y<=i.y+i.h)&&Dt(e.x,e.y,o.x,o.y,i))return!1;return!0}function Fn(t,e,o,i,n,l,s){const a=o-t,r=i-e,c=t-n,h=e-l,d=a*a+r*r,A=2*(c*a+h*r),p=c*c+h*h-s*s;let f=A*A-4*d*p;if(f<0)return!1;f=Math.sqrt(f);const g=(-A-f)/(2*d),m=(-A+f)/(2*d);return g>=0&&g<=1||m>=0&&m<=1}function Ln(t,e,o){let i=0;for(const n of t.buildings){if(!n.done||n.kind!=="wall")continue;const l=n.x+n.w/2,s=n.y+n.h/2,a=o.x-e.x,r=o.y-e.y,c=l-e.x,h=s-e.y,d=a*a+r*r||1,A=Math.max(0,Math.min(1,(c*a+h*r)/d)),p=e.x+A*a,f=e.y+A*r,g=Math.hypot(p-l,f-s);A>.75&&g<Math.max(12,Math.min(n.w,n.h)*.6)&&(i+=.25)}return Math.min(.6,i)}function He(t,e){const o=Math.max(1,Math.round(e));return t.hp-=o,o}function Nn(t,e,o){let i=null,n=1/0;for(const l of t.enemies){const s=Math.hypot(l.x-e.x,l.y-e.y);s<=o&&s<n&&ze(t,e,l)&&(i=l,n=s)}return i}function Wn(t,e,o){if(!("range"in e)||!e.range)return;e.cooldown=Math.max(0,(e.cooldown||0)-o),e.warmup=Math.max(0,(e.warmup||0)-o),"flashTimer"in e&&(e.flashTimer=Math.max(0,(e.flashTimer||0)-o));const i=t.centerOf(e),n=e.range||160,l=e.fireRate||.6,s=e.dps||12;let a=e.target||null;if((!a||a.hp<=0||Math.hypot(a.x-i.x,a.y-i.y)>n||!ze(t,i,a))&&(a=Nn(t,i,n),e.target=a||null,a&&(e.warmup=e.warmupTime??.4,e.warmupTotal=e.warmup)),!!a&&(e.angle=Math.atan2(a.y-i.y,a.x-i.x),!((e.warmup||0)>0)&&(e.cooldown||0)<=0)){const r=Math.hypot(a.x-i.x,a.y-i.y),c=Math.max(.35,Math.min(.95,.85-r/n*.3)),h=Math.atan2(a.y-i.y,a.x-i.x),A=(1-c)*18*Math.PI/180,p=(Math.random()-.5)*A,f=h+p,g=r,m=i.x+Math.cos(f)*g,b=i.y+Math.sin(f)*g,w={x:i.x,y:i.y,tx:m,ty:b,t:.12,speed:700,dmg:s,life:0,maxLife:Math.max(.12,r/700+.1),owner:"turret",kind:"turret"},v=m-i.x,k=b-i.y,S=Math.hypot(v,k)||1;w.vx=v/S*w.speed,w.vy=k/S*w.speed,w.particles=Tt(w),t.bullets.push(w);const R=Bt(i.x,i.y,h,"turret");t.particles.push(...R),e.flashTimer=.08,e.cooldown=l,e.cooldownTotal=l}}function lt(t){switch(t.kind){case"wall":return G.wall;case"house":return G.wood;case"turret":return G.metal;case"warehouse":return G.metal;case"stock":return G.metal;case"path":return"#475569";case"farm":return G.ground;case"infirmary":return t.color||G.bld;case"tent":return t.color||G.tent;case"hq":return t.color||G.bld;default:return t.color||"#8d8d8d"}}function Gn(t,e){if(e.hp>0)return;if(e.kind==="hq"){t.lose();return}t.evictColonistsFrom&&t.evictColonistsFrom(e);const o=t.buildings.indexOf(e);o>=0&&t.buildings.splice(o,1),t.msg((e.name||e.kind)+" destroyed","warn"),t.rebuildNavGrid&&t.rebuildNavGrid()}function ct(t,e,o,i,n=2){const l=n*y;for(const s of t.enemies){const a=s.x-e,r=s.y-o,c=Math.hypot(a,r);if(c>l)continue;const h=1-c/l,d=Math.max(1,Math.round(i*(.4+.6*h)));if(He(s,d),c>1){const A=18*h,p=a/c,f=r/c;s.x+=p*A,s.y+=f*A}}for(const s of t.colonists){if(!s.alive)continue;const a=s.x-e,r=s.y-o,c=Math.hypot(a,r);if(c>l)continue;const h=1-c/l,d=Math.max(1,Math.round(i*.35*(.4+.6*h)));if(t.applyDamageToColonist?t.applyDamageToColonist(s,d):s.hp=Math.max(0,s.hp-d),c>1){const A=16*h,p=a/c,f=r/c;s.x+=p*A,s.y+=f*A}}for(const s of t.buildings.slice()){if(!s.done||s.kind==="path"||s.kind==="farm")continue;const a=s.x+s.w/2,r=s.y+s.h/2,c=a-e,h=r-o,d=Math.hypot(c,h);if(d>l+Math.max(s.w,s.h)*.5)continue;const A=Math.max(0,d-Math.min(s.w,s.h)*.5);if(A>l)continue;const p=1-A/l,f=s.kind==="wall"?.95:.6,g=Math.max(1,Math.round(i*f*(.4+.6*p)));s.hp-=g,Gn(t,s)}}function Yn(t,e){for(let o=t.bullets.length-1;o>=0;o--){const i=t.bullets[o];if(i.vx!=null&&i.vy!=null){const n=i.x,l=i.y;i.x+=i.vx*e,i.y+=i.vy*e,i.life=(i.life||0)+e;let s=!1,a=null;for(const c of t.buildings)if(!(c.kind==="hq"||c.kind==="path"||c.kind==="house"||c.kind==="farm"||!c.done||n>=c.x&&n<=c.x+c.w&&l>=c.y&&l<=c.y+c.h)&&Dt(n,l,i.x,i.y,c)){s=!0,a=c;break}let r=null;if(!s)for(const c of t.enemies){const h=i.x-n,d=i.y-l,A=n-c.x,p=l-c.y,f=h*h+d*d,g=2*(A*h+p*d),m=A*A+p*p-c.r*c.r;let b=g*g-4*f*m;if(b>=0){b=Math.sqrt(b);const w=(-g-b)/(2*f),v=(-g+b)/(2*f);if(w>=0&&w<=1||v>=0&&v<=1){r=c;break}}}if(r){const c=Math.max(1,Math.round(i.dmg||10)),h=i.kind||"rifle";if(h==="rocket"){const d=Math.max(c,60);t.particles.push(...me(r.x,r.y,h,Math.min(2,d/60))),t.particles.push(...tt(r.x,r.y,32,30)),ct(t,r.x,r.y,d,2.2)}else{He(r,c);const d=me(r.x,r.y,h,Math.min(2,(i.dmg||10)/20));t.particles.push(...d),h==="minigun"&&t.particles.push(...Ui(r.x,r.y,Math.atan2(i.vy||0,i.vx||1),12,200))}t.bullets.splice(o,1);continue}if(s||i.maxLife!=null&&i.life>=i.maxLife){const c=i.kind||"rifle";if(c==="rocket"){const h=Math.max(i.dmg||60,60);t.particles.push(...me(i.x,i.y,c,Math.min(2,h/60))),t.particles.push(...tt(i.x,i.y,32,30)),a&&t.particles.push(...et(i.x,i.y,22,lt(a))),ct(t,i.x,i.y,h,2.2)}else{const h=me(i.x,i.y,c,Math.min(2,(i.dmg||10)/20));t.particles.push(...h),a&&t.particles.push(...et(i.x,i.y,10,lt(a)))}t.bullets.splice(o,1);continue}}else if(i.t-=e,i.t<=0){const n=me(i.tx,i.ty);t.particles.push(...n),t.bullets.splice(o,1);continue}i.particles&&(i.particles=ot(i.particles,e),i.particles&&i.particles.length===0&&delete i.particles)}t.particles=ot(t.particles,e)}function zn(t,e,o,i){for(const n of t.colonists){if(n===i||!n.alive||n.inside)continue;const l=(n.r||8)+6;if(Fn(e.x,e.y,o.x,o.y,n.x,n.y,l))return!0}return!1}function Hn(t){var g;const o=(((g=t.inventory)==null?void 0:g.equipment)||{}).weapon;if(!o||!o.defName)return null;const i=H.getItemDef(o.defName);if(!i)return null;const n=32,l=(i.range||10)*n,s=i.damage||12,a=i.accuracy??.7,r=i.burstCount??(i.defName==="Rifle"?3:1),c=i.warmup??(i.defName==="Rifle"?.6:.4),h=i.burstSpacing??.1,d=i.cooldown??(i.defName==="Rifle"?.7:.5),A=i.projectileSpeed??680,p=(i.minRange??1.25)*n,f=(i.range||0)<=2;return{rangePx:l,damage:s,accuracy:a,burst:r,warmup:c,betweenShots:h,cooldown:d,speed:A,minRangePx:p,isMelee:f}}function On(t){const e=t.toLowerCase();return e.includes("bow")?"bow":e.includes("rocket")?"rocket":e.includes("minigun")?"minigun":e.includes("shotgun")?"shotgun":e.includes("sniper")?"sniper":e.includes("smg")||e.includes("machinepistol")?"smg":e.includes("pistol")||e==="revolver"?"pistol":"rifle"}function Qn(t,e,o){let i=null,n=1/0;for(const l of t.enemies){const s=Math.hypot(l.x-e.x,l.y-e.y);s<=o&&s<n&&ze(t,e,l)&&(i=l,n=s)}return i}function Un(t,e,o){var M,B;if(!e.alive||e.inside)return;const i=Hn(e);if(!i||i.isMelee){const L=41.6+e.r;let D=null,F=1/0;for(const C of t.enemies){const T=Math.hypot(C.x-e.x,C.y-e.y);T<F&&(F=T,D=C)}if(D&&F<=L&&(e.meleeCd=Math.max(0,(e.meleeCd||0)-o),(e.meleeCd||0)<=0)){const C=(i==null?void 0:i.damage)||10;He(D,C),e.meleeCd=.8}return}e.fireCooldown=Math.max(0,(e.fireCooldown||0)-o),e.betweenShots=Math.max(0,(e.betweenShots||0)-o),e.warmup=Math.max(0,(e.warmup||0)-o);let n=e.combatTarget||null;if((!n||n.hp<=0)&&(n=Qn(t,e,i.rangePx),e.combatTarget=n,n&&(e.warmup=i.warmup,e.warmupTotal=i.warmup)),!n)return;const l=Math.hypot(n.x-e.x,n.y-e.y);if(l>i.rangePx*1.1){e.combatTarget=null;return}if(l<=i.minRangePx){if(e.meleeCd=Math.max(0,(e.meleeCd||0)-o),(e.meleeCd||0)<=0){const I=Math.max(8,Math.round(i.damage*.6));n.hp-=I,e.meleeCd=.9,e.fireCooldown=Math.max(e.fireCooldown||0,.3)}return}const s=Math.atan2(n.y-e.y,n.x-e.x);if(e.direction=s,(e.warmup||0)>0)return;if(e.burstLeft==null||e.burstLeft<=0){if((e.fireCooldown||0)>0)return;e.burstLeft=i.burst}if((e.betweenShots||0)>0)return;const a=i.accuracy,r=Math.max(.5,1-l/i.rangePx*.5);let c=Ln(t,e,n);{const I=n.x,L=n.y,D=Math.atan2(e.y-L,e.x-I),F=20;for(const C of t.buildings){if(!C.done||C.kind!=="wall")continue;const T=C.x+C.w/2,W=C.y+C.h/2;if(Math.hypot(T-I,W-L)<F){const X=Math.atan2(W-L,T-I);if(Math.abs(Math.atan2(Math.sin(D-X),Math.cos(D-X)))<Math.PI/3){c=Math.min(.7,c+.2);break}}}}const d=e.path&&e.pathIndex!=null&&e.pathIndex<(e.path.length||0)?.75:1,A=Math.max(.1,a*r*d*(1-c)),p=Math.atan2(n.y-e.y,n.x-e.x),f=(1-A)*20*(Math.PI/180),g=p+(Math.random()-.5)*f,m=e.x+Math.cos(g)*l,b=e.y+Math.sin(g)*l;if(zn(t,e,{x:m,y:b},e)){e.betweenShots=Math.max(e.betweenShots||0,.15);return}const v=((B=(((M=e.inventory)==null?void 0:M.equipment)||{}).weapon)==null?void 0:B.defName)||"",k=On(v),S={x:e.x,y:e.y,tx:m,ty:b,t:.12,speed:i.speed,dmg:i.damage,life:0,maxLife:Math.max(.12,l/i.speed+.12),owner:"colonist",kind:k},R=m-e.x,P=b-e.y,u=Math.hypot(R,P)||1;S.vx=R/u*i.speed,S.vy=P/u*i.speed,S.particles=Tt(S),t.bullets.push(S);const x=Bt(e.x,e.y,p,k);t.particles.push(...x),e.burstLeft-=1,e.betweenShots=i.betweenShots,e.burstLeft<=0&&(e.fireCooldown=i.cooldown,e.cooldownTotal=i.cooldown,e.combatTarget=null)}function Xn(t){t.debugConsole={open:!1,input:"",history:[],historyIndex:-1,output:[],commands:new Map};const e=(o,i,n)=>{t.debugConsole.commands.set(o,i),n&&(i.help=n)};e("help",(o,i)=>{const n=o.debugConsole;if(i.length){const l=n.commands.get(i[0]);return l&&l.help?l.help:`No help for '${i[0]}'`}return"commands: help, toggle, spawn, speed, pause, give, select, clear"},"help [cmd] — show commands or help for cmd"),e("toggle",(o,i)=>{const n=(i[0]||"").toLowerCase();if(!n)return"usage: toggle <nav|colonists|combat>";if(n==="nav")o.debug.nav=!o.debug.nav;else if(n==="colonists")o.debug.colonists=!o.debug.colonists;else if(n==="combat")o.debug.combat=!o.debug.combat;else return`unknown toggle '${n}'`;return`${n} = ${n==="combat"?o.debug.combat:o.debug[n]}`},"toggle nav|colonists|combat — flip debug flags"),e("spawn",(o,i)=>{const n=(i[0]||"enemy").toLowerCase(),l=Math.max(1,Math.min(20,parseInt(i[1]||"1",10)||1));if(n==="enemy"){for(let s=0;s<l;s++)o.spawnEnemy();return`spawned ${l} enemy`}if(n==="colonist"){for(let s=0;s<l;s++)o.spawnColonist({x:o.camera.x+100+s*8,y:o.camera.y+100});return`spawned ${l} colonist`}return`unknown spawn '${n}'`},"spawn enemy [n] | spawn colonist [n]"),e("speed",(o,i)=>{const n=parseFloat(i[0]||"");return!isFinite(n)||n<=0?"usage: speed <number> e.g. 1 or 6":(o.fastForward=n,`speed = ${o.fastForward}`)},"speed <n> — set game speed multiplier"),e("pause",o=>(o.paused=!o.paused,`paused = ${o.paused}`),"pause — toggle pause"),e("weapons",o=>{const i=H.getItemDefsByCategory("Weapon");return i.length?"weapons: "+i.map(n=>n.defName).sort().join(", "):"no weapons loaded"},"weapons — list available weapon defNames"),e("give",(o,i)=>{const n=(i[0]||"").trim();if(!n)return"usage: give <ItemDefName> [all]";const l=H.getItemDef(n)||H.getItemDef(n[0].toUpperCase()+n.slice(1));if(!l)return`unknown item: ${n}`;const a=(i[1]||"").toLowerCase()==="all"?o.colonists:o.selColonist?[o.selColonist]:[];if(!a.length)return"no colonist selected (use 'select next') or add 'all'";for(const r of a){r.inventory||(r.inventory={items:[],equipment:{},carryCapacity:50,currentWeight:0});const c=H.createItem(l.defName,1,"normal");r.inventory.equipment||(r.inventory.equipment={}),r.inventory.equipment.weapon=c||null,o.recalcInventoryWeight(r)}return`gave ${l.label} to ${a.length} colonist(s)`},"give <ItemDefName> [all] — equip item to selected or all"),e("select",(o,i)=>{var r;if((i[0]||"").toLowerCase()!=="next")return"usage: select next";const l=o.colonists.filter(c=>c.alive);if(!l.length)return"no colonists";const s=Math.max(0,l.indexOf(o.selColonist||l[0])),a=l[(s+1)%l.length];return o.selColonist=a,o.follow=!0,`selected ${((r=a.profile)==null?void 0:r.name)||"colonist"}`},"select next — select next colonist"),e("clear",(o,i)=>{const n=(i[0]||"messages").toLowerCase();return n==="messages"?(o.messages.length=0,"cleared messages"):n==="bullets"?(o.bullets.length=0,"cleared bullets"):"usage: clear messages|bullets"},"clear messages|bullets — clear logs or bullets")}function qn(t){const e=t.debugConsole;e&&(e.open=!e.open)}function jn(t,e){const o=t.debugConsole;if(!o||!o.open)return!1;if(e.key==="Escape")return o.open=!1,!0;if(e.key==="Enter"){const i=o.input.trim();return i.length&&(o.history.unshift(i),o.historyIndex=-1,Vn(t,i),o.input=""),!0}return e.key==="Backspace"?(o.input=o.input.slice(0,-1),!0):e.key==="ArrowUp"?(o.history.length&&(o.historyIndex=Math.min(o.historyIndex+1,o.history.length-1),o.input=o.history[o.historyIndex]),!0):e.key==="ArrowDown"?(o.historyIndex>0?(o.historyIndex-=1,o.input=o.history[o.historyIndex]):(o.historyIndex=-1,o.input=""),!0):e.key.length===1&&!e.ctrlKey&&!e.metaKey?(o.input+=e.key,!0):!1}function Vn(t,e){const o=t.debugConsole,[i,...n]=e.split(/\s+/),l=o.commands.get(i.toLowerCase());if(!l){o.output.push(`unknown command: ${i}`),ht(o);return}try{const s=l(t,n);s&&o.output.push(s)}catch(s){o.output.push(`error: ${(s==null?void 0:s.message)||s}`)}ht(o)}function ht(t){t.output.length>10&&t.output.splice(0,t.output.length-10)}function Zn(t){const e=t.debugConsole;if(!e||!e.open)return;const o=t.ctx,i=10,n=t.canvas.width,l=t.canvas.height,a=t.scale(t.isTouch?86:64)+8,r=Math.min(220,Math.max(140,Math.round(l*.25)));o.save(),o.resetTransform(),o.globalAlpha=.92,o.fillStyle="#0b1220cc";const c=l-a-r;o.fillRect(0,c,n,r),o.globalAlpha=1,o.strokeStyle="#ffffffff",o.lineWidth=1,o.strokeRect(.5,c+.5,n-1,r-1),o.globalAlpha=1,o.fillStyle="#c7d2fe";const h=t.isTouch?17:15;o.font=`${h}px ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace`,o.textAlign="left",o.textBaseline="alphabetic";let d=c+i+4;for(const g of e.output)o.fillText(g,i,d),d+=h+5;const A=`> ${e.input}`;o.fillStyle="#e5e7eb";const p=l-a-i;if(o.fillText(A,i,p),performance.now()%1e3<600){const g=o.measureText(A),m=g.width,b=g.actualBoundingBoxAscent||h*.9,w=g.actualBoundingBoxDescent||h*.2,v=i+m+2;o.strokeStyle="#e5e7eb",o.lineWidth=1,o.beginPath(),o.moveTo(v,p-b),o.lineTo(v,p+w),o.stroke()}o.restore()}class Jn{constructor(e){E(this,"canvas");E(this,"ctx");E(this,"DPR",1);E(this,"camera",{x:0,y:0,zoom:1});E(this,"uiScale",1);E(this,"baseFontSize",14);E(this,"isTouch",!1);E(this,"isActuallyTouchDevice",!1);E(this,"lastInputWasTouch",!1);E(this,"RES",{wood:0,stone:0,food:0});E(this,"BASE_STORAGE",200);E(this,"storageFullWarned",!1);E(this,"day",1);E(this,"tDay",0);E(this,"dayLength",180);E(this,"fastForward",1);E(this,"paused",!1);E(this,"prevIsNight",!1);E(this,"colonists",[]);E(this,"enemies",[]);E(this,"trees",[]);E(this,"rocks",[]);E(this,"buildings",[]);E(this,"bullets",[]);E(this,"particles",[]);E(this,"messages",[]);E(this,"selectedBuild","house");E(this,"hotbar",["house","farm","turret","wall","stock","tent","warehouse","well","infirmary"]);E(this,"showBuildMenu",!1);E(this,"debug",{nav:!1,paths:!0,colonists:!1,forceDesktopMode:!1});E(this,"selColonist",null);E(this,"follow",!1);E(this,"touchLastPan",null);E(this,"touchLastDist",null);E(this,"keyState",{});E(this,"once",new Set);E(this,"mouse",{x:0,y:0,wx:0,wy:0,down:!1,rdown:!1});E(this,"lastPaintCell",null);E(this,"eraseDragStart",null);E(this,"menuRects",[]);E(this,"hotbarRects",[]);E(this,"pendingPlacement",null);E(this,"placeUIRects",[]);E(this,"pendingDragging",!1);E(this,"colonistPanelRect",null);E(this,"colonistPanelCloseRect",null);E(this,"colonistProfileTab","bio");E(this,"colonistTabRects",[]);E(this,"colonistHealthActions",null);E(this,"contextMenu",null);E(this,"contextMenuRects",[]);E(this,"longPressTimer",null);E(this,"longPressStartPos",null);E(this,"longPressStartTime",null);E(this,"longPressTarget",null);E(this,"handleResize",()=>{const e=document.querySelector("header"),o=e?Math.ceil(e.getBoundingClientRect().height):48,i=window.innerWidth,n=window.innerHeight-o;this.canvas.style.width=i+"px",this.canvas.style.height=n+"px",this.canvas.width=Math.floor(i*this.DPR),this.canvas.height=Math.floor(n*this.DPR),this.calculateUIScale(),this.clampCameraToWorld()});E(this,"screenToWorld",(e,o)=>({x:e*this.DPR/this.camera.zoom+this.camera.x,y:o*this.DPR/this.camera.zoom+this.camera.y}));E(this,"respawnTimer",0);E(this,"assignedTargets",new WeakSet);E(this,"buildReservations",new Map);E(this,"insideCounts",new Map);E(this,"last",performance.now());E(this,"frame",e=>{const o=Math.min(.033,(e-this.last)/1e3);this.last=e,this.update(o),this.draw(),requestAnimationFrame(this.frame)});E(this,"grid",Gt());const o=e.getContext("2d");if(!o)throw new Error("no ctx");this.canvas=e,this.ctx=o,this.DPR=Math.max(1,Math.min(2,window.devicePixelRatio||1)),this.handleResize(),window.addEventListener("resize",()=>this.handleResize()),this.bindInput(),this.newGame(),this.rebuildNavGrid(),this.RES.wood=50,this.RES.stone=30,this.RES.food=20,this.day=1,this.tDay=0,this.fastForward=1,this.camera.zoom=1;const i=this.canvas.width/this.DPR/this.camera.zoom,n=this.canvas.height/this.DPR/this.camera.zoom;this.camera.x=j.x-i/2,this.camera.y=j.y-n/2,this.clampCameraToWorld(),H.loadItems(),Xn(this),requestAnimationFrame(this.frame)}getStorageCapacity(){let e=this.BASE_STORAGE;for(const o of this.buildings)o.done&&o.storageBonus&&(e+=o.storageBonus);return e}getPopulationCap(){return(this.buildings.find(e=>e.kind==="hq")?3:0)+this.buildings.filter(e=>e.kind==="house"&&e.done).reduce((e,o)=>e+(o.popCap||0),0)}addResource(e,o){const i=this.RES.wood+this.RES.stone+this.RES.food,n=this.getStorageCapacity(),l=Math.max(0,n-i),s=Math.min(Math.floor(o),l);return s>0&&(this.RES[e]+=s),s===0&&o>0&&!this.storageFullWarned?(this.msg(`Storage full! Cannot store more ${String(e)}`,"warn"),this.storageFullWarned=!0):s>0&&(this.storageFullWarned=!1),s}getEquippedItems(e){var i;const o=((i=e.inventory)==null?void 0:i.equipment)||{};return[o.helmet,o.armor,o.weapon,o.tool,o.accessory].filter(Boolean)}getMoveSpeedMultiplier(e){let o=0;for(const n of this.getEquippedItems(e)){if(!(n!=null&&n.defName))continue;const l=H.getItemDef(n.defName);l!=null&&l.movementPenalty&&(o+=l.movementPenalty)}o=Math.min(.4,Math.max(0,o));const i=1-o;return Math.max(.6,i)}getWorkSpeedMultiplier(e,o){let i=0;for(const n of this.getEquippedItems(e)){if(!(n!=null&&n.defName))continue;const l=H.getItemDef(n.defName);l!=null&&l.workSpeedBonus&&(!l.workTypes||l.workTypes.includes(o))&&(i+=l.workSpeedBonus)}return i=Math.min(.8,Math.max(0,i)),1+i}getArmorReduction(e){var l;let o=0;const i=((l=e.inventory)==null?void 0:l.equipment)||{},n=[i.helmet,i.armor];for(const s of n){if(!(s!=null&&s.defName))continue;const a=H.getItemDef(s.defName);a!=null&&a.armorRating&&(o+=a.armorRating)}return Math.min(.8,Math.max(0,o))}applyDamageToColonist(e,o){const i=this.getArmorReduction(e),n=o*(1-i);e.hp=Math.max(0,e.hp-n)}tryConsumeInventoryFood(e){var i,n,l;if(!e.inventory)return!1;const o=e.inventory.items;for(let s=0;s<o.length;s++){const a=o[s];if(!(a.category==="Food"||!!a.defName&&((i=H.getItemDef(a.defName))==null?void 0:i.category)==="Food")||a.quantity<=0)continue;const c=a.defName&&((n=H.getItemDef(a.defName))==null?void 0:n.nutrition)||10,h=Math.max(20,Math.min(70,Math.round(c*3)));return e.hunger=Math.max(0,(e.hunger||0)-h),e.hp=Math.min(100,e.hp+1.5),this.msg(`${((l=e.profile)==null?void 0:l.name)||"Colonist"} ate ${a.name}`,"good"),a.quantity-=1,a.quantity<=0&&o.splice(s,1),this.recalcInventoryWeight(e),!0}return!1}recalcInventoryWeight(e){if(!e.inventory)return;let o=0;for(const n of e.inventory.items)o+=(n.weight||0)*(n.quantity||1);const i=e.inventory.equipment||{};for(const n of["helmet","armor","weapon","tool","accessory"]){const l=i[n];l&&(o+=l.weight||0)}e.inventory.currentWeight=Math.round(o*100)/100}clampCameraToWorld(){const e=this.canvas.width/this.DPR/this.camera.zoom,o=this.canvas.height/this.DPR/this.camera.zoom,i=Math.max(0,N.w-e),n=Math.max(0,N.h-o);Number.isFinite(this.camera.x)||(this.camera.x=0),Number.isFinite(this.camera.y)||(this.camera.y=0),this.camera.x=q(this.camera.x,0,i),this.camera.y=q(this.camera.y,0,n)}calculateUIScale(){const i=this.canvas.width/this.DPR,n=this.canvas.height/this.DPR,l=i/1920,s=n/1080;let a=Math.min(l,s);const r="ontouchstart"in window||navigator.maxTouchPoints>0;this.isTouch=r,this.isActuallyTouchDevice=r&&i<900,r?i<600?a=Math.max(a*1.9,1.6):i<=900?a=Math.max(a*1.7,1.5):i<=1200?a=Math.max(a*1.5,1.35):a=Math.max(a*1.25,a):i<1200&&(a*=1.1),a=Math.max(1.1,Math.min(a,3)),this.uiScale=a,console.log(`UI Scale calculated: ${a.toFixed(2)} for ${i}x${n}`)}getScaledFont(e,o="500",i="system-ui,Segoe UI,Roboto"){return`${o} ${Math.round(e*this.uiScale)}px ${i}`}scale(e){return Math.round(e*this.uiScale)}bindInput(){const e=this.canvas;e.addEventListener("mousemove",o=>{const i=e.getBoundingClientRect();this.mouse.x=o.clientX-i.left,this.mouse.y=o.clientY-i.top;const n=this.screenToWorld(this.mouse.x,this.mouse.y);if(this.mouse.wx=n.x,this.mouse.wy=n.y,this.pendingPlacement&&this.mouse.down){const l=z[this.pendingPlacement.key],s=this.pendingPlacement.rot||0,a=s===90||s===270,r=Math.floor(this.mouse.wx/y)*y,c=Math.floor(this.mouse.wy/y)*y,h=(a?l.size.h:l.size.w)*y,d=(a?l.size.w:l.size.h)*y;this.pendingPlacement.x=q(r,0,N.w-h),this.pendingPlacement.y=q(c,0,N.h-d);return}this.mouse.down&&(this.selectedBuild==="path"?this.paintPathAtMouse():this.selectedBuild==="wall"&&this.paintWallAtMouse())}),e.addEventListener("mousedown",o=>{var i;if(o.preventDefault(),this.lastInputWasTouch=!1,o.button===0){if(this.mouse.down=!0,this.selColonist){const s=this.mouse.x*this.DPR,a=this.mouse.y*this.DPR;if(this.colonistPanelCloseRect){const r=this.colonistPanelCloseRect;if(s>=r.x&&s<=r.x+r.w&&a>=r.y&&a<=r.y+r.h){this.selColonist=null,this.follow=!1;return}}if(this.colonistTabRects){for(const r of this.colonistTabRects)if(s>=r.x&&s<=r.x+r.w&&a>=r.y&&a<=r.y+r.h){this.colonistProfileTab=r.tab;return}}if(this.colonistPanelRect){const r=this.colonistPanelRect;if(!(s>=r.x&&s<=r.x+r.w&&a>=r.y&&a<=r.y+r.h)){this.selColonist=null,this.follow=!1;return}if(this.selColonist&&this.colonistProfileTab==="health"&&this.colonistHealthActions){const h=this.colonistHealthActions,d=A=>s>=A.x&&s<=A.x+A.w&&a>=A.y&&a<=A.y+A.h;if(d(h.tend)){const A=this.selColonist,p=this.colonists.filter(g=>{var m;return g!==A&&g.alive&&!((m=g.health)!=null&&m.downed)&&!g.inside});let f=p[0];if(p.length>1){const g=m=>(m.x-A.x)*(m.x-A.x)+(m.y-A.y)*(m.y-A.y);f=p.sort((m,b)=>g(m)-g(b))[0]}!f&&A&&A.alive&&!((i=A.health)!=null&&i.downed)&&(f=A),f?(f.task=null,f.target=null,this.clearPath&&this.clearPath(f),f.tendTarget=A,f.state="tend",f.stateSince=0,this.msg("Tend ordered","info")):this.msg("No available tender","warn");return}if(d(h.rescue)){const A=this.selColonist,p=this.colonists.find(f=>{var g;return f!==A&&f.alive&&!((g=f.health)!=null&&g.downed)&&!f.inside});p?(p.task=null,p.target=null,this.clearPath&&this.clearPath(p),p.rescueTarget=A,p.state="rescue",p.stateSince=0,this.msg("Rescue ordered","info")):this.msg("No available rescuer","warn");return}}}}if(this.pendingPlacement){const s=this.mouse.x*this.DPR,a=this.mouse.y*this.DPR;if(this.placeUIRects.length){for(const k of this.placeUIRects)if(s>=k.x&&s<=k.x+k.w&&a>=k.y&&a<=k.y+k.h){k.id==="up"?this.nudgePending(0,-1):k.id==="down"?this.nudgePending(0,1):k.id==="left"?this.nudgePending(-1,0):k.id==="right"?this.nudgePending(1,0):k.id==="ok"?this.confirmPending():k.id==="cancel"?this.cancelPending():k.id==="rotL"?this.rotatePending(-90):k.id==="rotR"&&this.rotatePending(90);return}}const r=this.pendingPlacement,c=z[r.key],d=((k,S)=>({x:(k-this.camera.x)*this.camera.zoom,y:(S-this.camera.y)*this.camera.zoom}))(r.x,r.y),A=c.size.w*y*this.camera.zoom,p=c.size.h*y*this.camera.zoom;if(s>=d.x&&s<=d.x+A&&a>=d.y&&a<=d.y+p){this.pendingDragging=!0;return}const f=r.rot||0,g=f===90||f===270,m=Math.floor(this.mouse.wx/y)*y,b=Math.floor(this.mouse.wy/y)*y,w=(g?c.size.h:c.size.w)*y,v=(g?c.size.w:c.size.h)*y;r.x=q(m,0,N.w-w),r.y=q(b,0,N.h-v);return}const n=this.mouse.x*this.DPR,l=this.mouse.y*this.DPR;for(const s of this.hotbarRects)if(n>=s.x&&n<=s.x+s.w&&l>=s.y&&l<=s.y+s.h){const a=this.hotbar[s.index];a&&(this.selectedBuild=a,this.toast("Selected: "+z[a].name));return}if(this.contextMenu){const s=this.mouse.x*this.DPR,a=this.mouse.y*this.DPR;let r=!1;for(const c of this.contextMenuRects)if(s>=c.x&&s<=c.x+c.w&&a>=c.y&&a<=c.y+c.h&&this.contextMenu.target){const h=this.contextMenu.items.find(d=>d.id===c.id);if(h&&h.submenu){this.contextMenu.openSubmenu===c.id?this.contextMenu.openSubmenu=void 0:this.contextMenu.openSubmenu=c.id,r=!0;return}else{this.handleContextMenuAction(c.id,this.contextMenu.target),this.contextMenu=null,this.contextMenuRects=[],r=!0;return}}r||(this.contextMenu=null,this.contextMenuRects=[])}if(this.showBuildMenu){st(this);return}if(window._eraseOnce){window._eraseOnce=!1,this.cancelOrErase();return}if(this.selectedBuild==="path")this.paintPathAtMouse(!0);else if(this.selectedBuild==="wall")this.paintWallAtMouse(!0);else{const s=this.findColonistAt(this.mouse.wx,this.mouse.wy);s?(this.selColonist=s,this.follow=!0):this.placeAtMouse()}}if(o.button===2){if(this.mouse.rdown=!0,this.showBuildMenu){this.showBuildMenu=!1;return}const n=this.findColonistAt(this.mouse.wx,this.mouse.wy);if(n){rt(this,n,this.mouse.x,this.mouse.y);return}this.eraseDragStart={x:this.mouse.wx,y:this.mouse.wy}}}),e.addEventListener("mouseup",o=>{if(o.preventDefault(),o.button===0&&(this.mouse.down=!1,this.lastPaintCell=null,this.pendingDragging=!1),o.button===2){if(this.eraseDragStart){const i=Math.min(this.eraseDragStart.x,this.mouse.wx),n=Math.min(this.eraseDragStart.y,this.mouse.wy),l=Math.max(this.eraseDragStart.x,this.mouse.wx),s=Math.max(this.eraseDragStart.y,this.mouse.wy);(l-i)*(s-n)<12*12?this.cancelOrErase():this.eraseInRect({x:i,y:n,w:l-i,h:s-n})}this.mouse.rdown=!1,this.eraseDragStart=null}}),e.addEventListener("contextmenu",o=>o.preventDefault()),e.addEventListener("wheel",o=>{o.preventDefault();const i=o.deltaY<0?1.1:.9,n=e.getBoundingClientRect(),l=o.clientX-n.left,s=o.clientY-n.top,a=this.screenToWorld(l,s),r=Math.max(.6,Math.min(2.2,this.camera.zoom*i));this.camera.zoom=r;const c=this.screenToWorld(l,s);this.camera.x+=a.x-c.x,this.camera.y+=a.y-c.y,this.clampCameraToWorld()}),window.addEventListener("keydown",o=>{const i=this.debugConsole;if(i&&i.open)return;const n=o.key.toLowerCase();this.keyState[n]=!0,this.once.has(n)||this.once.add(n),(n===" "||n==="h"||n==="b"||n==="f"||n==="g"||n==="j"||n==="k"||n==="escape"||/^[1-9]$/.test(n)||n==="w"||n==="a"||n==="s"||n==="d"||n==="+"||n==="="||n==="-"||n==="_")&&o.preventDefault()}),window.addEventListener("keyup",o=>{const i=this.debugConsole;i&&i.open||(this.keyState[o.key.toLowerCase()]=!1)}),window.addEventListener("keydown",o=>{const i=o;if(i.key==="`"||i.code==="Backquote"){o.preventDefault(),qn(this);return}jn(this,o)&&(o.preventDefault(),o.stopPropagation())}),e.addEventListener("touchstart",o=>{if(o.preventDefault(),this.lastInputWasTouch=!0,this.isActuallyTouchDevice=!0,o.touches.length===1){this.touchLastPan={x:o.touches[0].clientX,y:o.touches[0].clientY};const i=e.getBoundingClientRect(),n=o.touches[0].clientX-i.left,l=o.touches[0].clientY-i.top,s=this.screenToWorld(n,l),a=this.findColonistAt(s.x,s.y);a&&(this.longPressStartPos={x:n,y:l},this.longPressStartTime=performance.now(),this.longPressTarget=a,this.longPressTimer=window.setTimeout(()=>{rt(this,a,n,l),navigator.vibrate&&navigator.vibrate(50),this.longPressStartTime=null,this.longPressTarget=null},500))}else if(o.touches.length===2){this.longPressTimer&&(clearTimeout(this.longPressTimer),this.longPressTimer=null);const i=o.touches[0].clientX-o.touches[1].clientX,n=o.touches[0].clientY-o.touches[1].clientY;this.touchLastDist=Math.hypot(i,n)}},{passive:!1}),e.addEventListener("touchmove",o=>{if(o.preventDefault(),this.lastInputWasTouch=!0,this.longPressTimer&&this.longPressStartPos&&o.touches.length===1){const i=e.getBoundingClientRect(),n=o.touches[0].clientX-i.left,l=o.touches[0].clientY-i.top;Math.hypot(n-this.longPressStartPos.x,l-this.longPressStartPos.y)>20&&(clearTimeout(this.longPressTimer),this.longPressTimer=null,this.longPressStartTime=null,this.longPressTarget=null)}if(o.touches.length===1&&this.touchLastPan){if(this.pendingPlacement){const a=e.getBoundingClientRect(),r=o.touches[0].clientX-a.left,c=o.touches[0].clientY-a.top,h=this.screenToWorld(r,c);this.mouse.x=r,this.mouse.y=c,this.mouse.wx=h.x,this.mouse.wy=h.y;const d=z[this.pendingPlacement.key],A=this.pendingPlacement.rot||0,p=A===90||A===270,f=Math.floor(this.mouse.wx/y)*y,g=Math.floor(this.mouse.wy/y)*y,m=(p?d.size.h:d.size.w)*y,b=(p?d.size.w:d.size.h)*y;this.pendingPlacement.x=q(f,0,N.w-m),this.pendingPlacement.y=q(g,0,N.h-b);return}const i=o.touches[0].clientX,n=o.touches[0].clientY,l=i-this.touchLastPan.x,s=n-this.touchLastPan.y;this.touchLastPan={x:i,y:n},this.camera.x-=l/this.camera.zoom,this.camera.y-=s/this.camera.zoom,this.clampCameraToWorld()}else if(o.touches.length===2){const i=o.touches[0].clientX-o.touches[1].clientX,n=o.touches[0].clientY-o.touches[1].clientY,l=Math.hypot(i,n);if(this.touchLastDist!=null&&this.touchLastDist>0){const s=l/this.touchLastDist,a=e.getBoundingClientRect(),r=(o.touches[0].clientX+o.touches[1].clientX)/2-a.left,c=(o.touches[0].clientY+o.touches[1].clientY)/2-a.top,h=this.screenToWorld(r,c),d=Math.max(.6,Math.min(2.2,this.camera.zoom*s));this.camera.zoom=d;const A=this.screenToWorld(r,c);this.camera.x+=h.x-A.x,this.camera.y+=h.y-A.y,this.clampCameraToWorld()}this.touchLastDist=l}},{passive:!1}),e.addEventListener("touchend",o=>{if(o.preventDefault(),this.lastInputWasTouch=!0,this.longPressTimer&&(clearTimeout(this.longPressTimer),this.longPressTimer=null),this.longPressStartPos=null,this.longPressStartTime=null,this.longPressTarget=null,o.changedTouches.length===1&&o.touches.length===0){const i=e.getBoundingClientRect(),n=o.changedTouches[0].clientX-i.left,l=o.changedTouches[0].clientY-i.top;this.handleTapOrClickAtScreen(n,l)}o.touches.length===0&&(this.touchLastPan=null,this.touchLastDist=null)},{passive:!1})}handleTapOrClickAtScreen(e,o){this.canvas.getBoundingClientRect(),this.mouse.x=e,this.mouse.y=o;const n=this.screenToWorld(this.mouse.x,this.mouse.y);if(this.mouse.wx=n.x,this.mouse.wy=n.y,this.pendingPlacement){const r=this.mouse.x*this.DPR,c=this.mouse.y*this.DPR;if(this.placeUIRects.length){for(const k of this.placeUIRects)if(r>=k.x&&r<=k.x+k.w&&c>=k.y&&c<=k.y+k.h){k.id==="up"?this.nudgePending(0,-1):k.id==="down"?this.nudgePending(0,1):k.id==="left"?this.nudgePending(-1,0):k.id==="right"?this.nudgePending(1,0):k.id==="ok"?this.confirmPending():k.id==="cancel"?this.cancelPending():k.id==="rotL"?this.rotatePending(-90):k.id==="rotR"&&this.rotatePending(90);return}}const h=this.pendingPlacement,d=z[h.key],p=((k,S)=>({x:(k-this.camera.x)*this.camera.zoom,y:(S-this.camera.y)*this.camera.zoom}))(h.x,h.y),f=d.size.w*y*this.camera.zoom,g=d.size.h*y*this.camera.zoom;if(r>=p.x&&r<=p.x+f&&c>=p.y&&c<=p.y+g){this.confirmPending();return}const m=Math.floor(this.mouse.wx/y)*y,b=Math.floor(this.mouse.wy/y)*y,w=d.size.w*y,v=d.size.h*y;h.x=q(m,0,N.w-w),h.y=q(b,0,N.h-v);return}if(this.selColonist){const r=this.mouse.x*this.DPR,c=this.mouse.y*this.DPR;if(this.colonistPanelCloseRect){const h=this.colonistPanelCloseRect;if(r>=h.x&&r<=h.x+h.w&&c>=h.y&&c<=h.y+h.h){this.selColonist=null,this.follow=!1;return}}if(this.colonistTabRects){for(const h of this.colonistTabRects)if(r>=h.x&&r<=h.x+h.w&&c>=h.y&&c<=h.y+h.h){this.colonistProfileTab=h.tab;return}}if(this.isTouch&&this.colonistPanelRect){const h=this.colonistPanelRect;if(!(r>=h.x&&r<=h.x+h.w&&c>=h.y&&c<=h.y+h.h)){this.selColonist=null,this.follow=!1;return}}}const l=this.mouse.x*this.DPR,s=this.mouse.y*this.DPR;for(const r of this.hotbarRects)if(l>=r.x&&l<=r.x+r.w&&s>=r.y&&s<=r.y+r.h){const c=this.hotbar[r.index];c&&(this.selectedBuild=c,this.toast("Selected: "+z[c].name));return}if(this.contextMenu){const r=this.mouse.x*this.DPR,c=this.mouse.y*this.DPR;let h=!1;for(const d of this.contextMenuRects)if(r>=d.x&&r<=d.x+d.w&&c>=d.y&&c<=d.y+d.h&&this.contextMenu.target){const A=this.contextMenu.items.find(p=>p.id===d.id);if(A&&A.submenu){this.contextMenu.openSubmenu===d.id?this.contextMenu.openSubmenu=void 0:this.contextMenu.openSubmenu=d.id,h=!0;return}else{this.handleContextMenuAction(d.id,this.contextMenu.target),this.contextMenu=null,this.contextMenuRects=[],h=!0;return}}h||(this.contextMenu=null,this.contextMenuRects=[])}if(this.showBuildMenu){st(this);return}if(window._eraseOnce){window._eraseOnce=!1,this.cancelOrErase();return}if(this.selectedBuild==="path"){this.paintPathAtMouse(!0);return}if(this.selectedBuild==="wall"){this.paintWallAtMouse(!0);return}if(!this.debug.forceDesktopMode&&this.isActuallyTouchDevice&&this.lastInputWasTouch&&this.selectedBuild){this.placeAtMouse();return}const a=this.findColonistAt(this.mouse.wx,this.mouse.wy);if(a){this.selColonist=a,this.follow=!0;return}this.placeAtMouse()}findColonistAt(e,o){for(let i=this.colonists.length-1;i>=0;i--){const n=this.colonists[i];if(!n.alive||n.inside)continue;if((n.x-e)*(n.x-e)+(n.y-o)*(n.y-o)<=(n.r+2)*(n.r+2))return n}return null}msg(e,o="info"){this.messages.push({text:e,t:4,kind:o}),this.toast(e,1600)}toast(e,o=1400){const i=document.getElementById("toast");i&&(i.textContent=e,i.style.opacity="1",clearTimeout(i._t),i._t=setTimeout(()=>i.style.opacity="0",o))}scatter(){for(let e=0;e<220;e++){const o={x:O(80,N.w-80),y:O(80,N.h-80)};Math.hypot(o.x-j.x,o.y-j.y)<220||this.trees.push({x:o.x,y:o.y,r:12,hp:40,type:"tree"})}for(let e=0;e<140;e++){const o={x:O(80,N.w-80),y:O(80,N.h-80)};Math.hypot(o.x-j.x,o.y-j.y)<200||this.rocks.push({x:o.x,y:o.y,r:12,hp:50,type:"rock"})}this.rebuildNavGrid()}tryRespawn(e){if(this.respawnTimer+=e*this.fastForward,this.respawnTimer>=4){this.respawnTimer=0;const o=i=>{for(let n=0;n<6;n++){const l={x:O(60,N.w-60),y:O(60,N.h-60)};if(Math.hypot(l.x-j.x,l.y-j.y)<200)continue;let s=!0;for(const a of this.buildings)if(l.x>a.x-24&&l.x<a.x+a.w+24&&l.y>a.y-24&&l.y<a.y+a.h+24){s=!1;break}if(s){i==="tree"?this.trees.push({x:l.x,y:l.y,r:12,hp:40,type:"tree"}):this.rocks.push({x:l.x,y:l.y,r:12,hp:50,type:"rock"}),this.rebuildNavGrid();break}}};Math.random()<.5&&this.trees.length<260&&o("tree"),Math.random()<.35&&this.rocks.length<180&&o("rock")}}buildHQ(){const e={w:3*y,h:3*y},o={kind:"hq",name:"HQ",x:j.x-e.w/2,y:j.y-e.h/2,w:e.w,h:e.h,hp:600,done:!0,color:G.bld,size:{w:3,h:3},build:0,buildLeft:0};this.buildings.push(o),this.rebuildNavGrid()}newGame(){var o;this.colonists.length=this.enemies.length=this.trees.length=this.rocks.length=this.buildings.length=this.bullets.length=this.messages.length=0,this.buildReservations.clear(),this.insideCounts.clear(),this.RES.wood=50,this.RES.stone=30,this.RES.food=20,this.day=1,this.tDay=0,this.fastForward=1,this.camera.zoom=1,this.camera.x=j.x-this.canvas.width/this.DPR/(2*this.camera.zoom),this.camera.y=j.y-this.canvas.height/this.DPR/(2*this.camera.zoom),this.buildHQ(),this.scatter();for(let i=0;i<3;i++){const n=O(0,Math.PI*2),l=80+O(-10,10);this.spawnColonist({x:j.x+Math.cos(n)*l,y:j.y+Math.sin(n)*l})}if(!this.colonists.some(i=>{var n,l;return((l=(n=i.inventory)==null?void 0:n.equipment)==null?void 0:l.weapon)&&(i.inventory.equipment.weapon.defName==="Pistol"||i.inventory.equipment.weapon.defName==="Rifle")})&&this.colonists.length){const i=this.colonists[0],n=H.createItem("Pistol",1,"normal");n&&(i.inventory||(i.inventory={items:[],equipment:{},carryCapacity:50,currentWeight:0}),i.inventory.equipment.weapon=n,this.recalcInventoryWeight(i),this.msg(`${((o=i.profile)==null?void 0:o.name)||"Colonist"} starts with a pistol for defense.`,"info"))}this.msg("Welcome! Build farms before night, then turrets.")}spawnColonist(e){const o=_e(),i={x:e.x,y:e.y,r:8,hp:100,speed:50*o.stats.workSpeed,task:null,target:null,carrying:null,hunger:0,alive:!0,color:o.avatar.clothing,t:O(0,1),direction:0,profile:o,inventory:JSON.parse(JSON.stringify(o.startingInventory))};return this.colonists.push(i),this.msg(`${Qi(o)} has joined the colony!`,"good"),i}spawnEnemy(){const e=Nt(0,4);let o,i;e===0?(o=O(0,N.w),i=-80):e===1?(o=O(0,N.w),i=N.h+80):e===2?(o=-80,i=O(0,N.h)):(o=N.w+80,i=O(0,N.h));const n={x:o,y:i,r:9,hp:60+this.day*6,speed:48+this.day*2,dmg:8+this.day,target:null,color:G.enemy};return this.enemies.push(n),n}placeAtMouse(){kn(this)}tryPlaceNow(e,o,i,n){Ge(this,e,o,i,n)}nudgePending(e,o){Sn(this,e,o)}rotatePending(e){Cn(this,e)}confirmPending(){Rn(this)}cancelPending(){Bn(this)}paintPathAtMouse(e=!1){Tn(this,e)}paintWallAtMouse(e=!1){In(this,e)}eraseInRect(e){Pn(this,e)}cancelOrErase(){En(this)}evictColonistsFrom(e){Ye(this,e)}buildingCapacity(e){return e.kind==="hq"?8:e.kind==="house"?3:1}buildingHasSpace(e){const o=this.buildingCapacity(e);return(this.insideCounts.get(e)||0)<o}tryEnterBuilding(e,o){return!o.done||!this.buildingHasSpace(o)?!1:(this.insideCounts.set(o,(this.insideCounts.get(o)||0)+1),e.inside=o,e.hideTimer=0,!0)}leaveBuilding(e){const o=e.inside;if(o){const i=(this.insideCounts.get(o)||1)-1;i<=0?this.insideCounts.delete(o):this.insideCounts.set(o,i)}e.inside=null,e.hideTimer=0}getMaxCrew(e){const o=e.w/y*(e.h/y);return o<=1?1:o<=4?2:3}releaseBuildReservation(e){if(!e.reservedBuildFor)return;const o=e.reservedBuildFor,i=(this.buildReservations.get(o)||1)-1;i<=0?this.buildReservations.delete(o):this.buildReservations.set(o,i),e.reservedBuildFor=null}clearPath(e){e.path=void 0,e.pathIndex=void 0}setTask(e,o,i){if(e.target&&e.target.type&&this.assignedTargets.has(e.target)&&this.assignedTargets.delete(e.target),e.reservedBuildFor&&e.reservedBuildFor!==i&&this.releaseBuildReservation(e),e.task=o,e.target=i,this.clearPath(e),i&&i.type&&(i.type==="tree"||i.type==="rock")&&this.assignedTargets.add(i),o==="build"&&i&&i.w!=null&&!e.reservedBuildFor){const n=i,l=this.buildReservations.get(n)||0,s=this.getMaxCrew(n);l<s&&(this.buildReservations.set(n,l+1),e.reservedBuildFor=n)}}pickTask(e){if(this.isNight()){this.setTask(e,"idle",{x:e.x,y:e.y});return}let o=null,i=1/0;for(const a of this.buildings){if(a.done||(this.buildReservations.get(a)||0)>=this.getMaxCrew(a))continue;const c=Q({x:e.x,y:e.y},this.centerOf(a));c<i&&(i=c,o=a)}if(o){this.setTask(e,"build",o);return}const n=this.buildings.find(a=>a.kind==="farm"&&a.done&&a.ready);if(n){this.setTask(e,"harvestFarm",n);return}if(Math.random()<.1){const a=this.buildings.find(r=>r.kind==="well"&&r.done);if(a){this.setTask(e,"harvestWell",a);return}}if(this.RES.food<Math.max(4,this.colonists.length*2)){const a=this.nearestCircle({x:e.x,y:e.y},this.trees.filter(r=>!this.assignedTargets.has(r)));if(a){this.setTask(e,"chop",a);return}}const l=this.trees.filter(a=>!this.assignedTargets.has(a)),s=this.rocks.filter(a=>!this.assignedTargets.has(a));if(Math.random()<.05&&console.log(`Task assignment: wood=${this.RES.wood}, stone=${this.RES.stone}, trees=${l.length}, rocks=${s.length}`),this.RES.wood<this.RES.stone){const a=this.nearestSafeCircle(e,{x:e.x,y:e.y},l);if(a){Math.random()<.1&&console.log("Assigning chop task"),this.setTask(e,"chop",a);return}else Math.random()<.1&&console.log("No trees available for chopping")}else{const a=this.nearestSafeCircle(e,{x:e.x,y:e.y},s);if(a){Math.random()<.1&&console.log("Assigning mine task to rock at:",a),this.setTask(e,"mine",a);return}else Math.random()<.1&&console.log("No rocks available for mining")}Math.random()<.1&&console.log("Assigning idle task"),this.setTask(e,"idle",{x:e.x+O(-80,80),y:e.y+O(-80,80)})}nearestCircle(e,o){let i=null,n=1e9;for(const l of o){const s=Q(e,l);s<n&&(n=s,i=l)}return i}nearestSafeCircle(e,o,i){const n=i.filter(l=>{const s=e.dangerMemory;if(!s||!Array.isArray(s))return!0;for(const a of s){const r=Math.hypot(l.x-a.x,l.y-a.y),c=e.t-a.time,h=c<5?a.radius:c<20?a.radius*(1-(c-5)/15):0;if(r<h)return Math.random()<.1&&console.log(`Danger memory: Avoiding target at (${l.x.toFixed(0)}, ${l.y.toFixed(0)}) due to danger memory at (${a.x.toFixed(0)}, ${a.y.toFixed(0)}), distance=${r.toFixed(0)}, radius=${h.toFixed(0)}`),!1}return!0});return n.length<i.length&&Math.random()<.2&&console.log(`Danger memory: Filtered ${i.length-n.length} dangerous targets out of ${i.length} total`),this.nearestCircle(o,n)}moveAlongPath(e,o,i,n=10){const l=i&&(!e.pathGoal||Math.hypot(e.pathGoal.x-i.x,e.pathGoal.y-i.y)>24);if(i&&(l||!e.path||e.pathIndex==null)){const f=this.computePathWithDangerAvoidance(e,e.x,e.y,i.x,i.y);if(f&&f.length){if(e.path=f,e.pathIndex=0,e.pathGoal={x:i.x,y:i.y},Math.random()<.1){let g=0;for(const m of f){const b=Math.floor(m.x/y),w=Math.floor(m.y/y);if(b>=0&&w>=0&&b<this.grid.cols&&w<this.grid.rows){const v=w*this.grid.cols+b;this.grid.cost[v]<=.7&&g++}}g>0&&console.log(`Computed path with ${g}/${f.length} low-cost tiles`)}}else Math.random()<.05&&console.log(`Failed to compute path from (${e.x.toFixed(1)}, ${e.y.toFixed(1)}) to (${i.x.toFixed(1)}, ${i.y.toFixed(1)})`)}if(!e.path||e.pathIndex==null||e.pathIndex>=e.path.length)return i?Math.hypot(e.x-i.x,e.y-i.y)<=n:!1;const s=e.path[e.pathIndex];if(!s||s.x==null||s.y==null)return console.log(`Invalid path node at index ${e.pathIndex}, clearing path`),this.clearPath(e),i?Math.hypot(e.x-i.x,e.y-i.y)<=n:!1;const a=s.x-e.x,r=s.y-e.y;let c=Math.hypot(a,r);const h=15,d=6;let A=e.speed*(e.fatigueSlow||1)*this.getMoveSpeedMultiplier(e);{const f=Math.floor(e.x/y),g=Math.floor(e.y/y);if(f>=0&&g>=0&&f<this.grid.cols&&g<this.grid.rows){const b=g*this.grid.cols+f;this.grid.cost[b]<=.7&&(A+=25,Math.random()<.01&&console.log(`Colonist at (${e.x.toFixed(1)}, ${e.y.toFixed(1)}) on path tile - cost: ${this.grid.cost[b]}, speed: ${A}`))}}const p=A*o;if(c<=Math.max(h,p))return e.x=s.x,e.y=s.y,e.pathIndex++,e.jitterScore=0,e.jitterWindow=0,e.lastDistToNode=void 0,e.lastDistSign=void 0,e.pathIndex>=e.path.length?(e.path=void 0,e.pathIndex=void 0,i?Math.hypot(e.x-i.x,e.y-i.y)<=n:!0):!1;if(e.jitterWindow=(e.jitterWindow||0)+o,e.lastDistToNode!=null){const f=c-e.lastDistToNode,g=f===0?0:f>0?1:-1,m=e.lastDistSign??g;g!==0&&m!==0&&g!==m&&c<h+15?e.jitterScore=(e.jitterScore||0)+1:e.jitterScore=Math.max(0,(e.jitterScore||0)-1),e.lastDistSign=g}if(e.lastDistToNode=c,(e.jitterScore||0)>=8||(e.jitterWindow||0)>3){if(c<h+d){if(e.pathIndex++,e.pathIndex>=e.path.length)return this.clearPath(e),i?Math.hypot(e.x-i.x,e.y-i.y)<=n:!1}else if(i){const f=this.computePath(e.x,e.y,i.x,i.y);f&&f.length&&(e.path=f,e.pathIndex=0)}if(e.jitterScore=0,e.jitterWindow=0,e.lastDistToNode=void 0,e.lastDistSign=void 0,!e.path||e.pathIndex==null||e.pathIndex>=e.path.length)return!1}return c>1&&(e.direction=Math.atan2(r,a)),e.x=Math.max(0,Math.min(e.x+a/(c||1)*p,N.w)),e.y=Math.max(0,Math.min(e.y+r/(c||1)*p,N.h)),!1}findSafeTurret(e,o){let i=null,n=1/0;for(const l of this.buildings){if(l.kind!=="turret"||!l.done)continue;const s=this.centerOf(l),a=Math.hypot(e.x-s.x,e.y-s.y),r=Math.hypot(o.x-s.x,o.y-s.y),c=l.range||160,h=r<c?100:0,d=a+h;d<n&&(n=d,i=l)}return i}isProtectedByTurret(e){const o=this.centerOf(e);for(const i of this.buildings){if(i.kind!=="turret"||!i.done)continue;const n=i.range||120,l=this.centerOf(i);if(Q(o,l)<n*n)return!0}return!1}centerOf(e){return{x:e.x+e.w/2,y:e.y+e.h/2}}pointInRect(e,o){return e.x>=o.x&&e.x<=o.x+o.w&&e.y>=o.y&&e.y<=o.y+o.h}updateTurret(e,o){Wn(this,e,o)}isNight(){return this.tDay>=Qe.start||this.tDay<=Qe.end}spawnWave(){const e=4+Math.floor(this.day*1.3);for(let o=0;o<e;o++)this.spawnEnemy();this.msg(`Night ${this.day}: Enemies incoming!`,"warn")}nextDay(){this.day++,this.waveSpawnedForDay=!1;let e=0;for(let n=0;n<this.colonists.length;n++)this.RES.food>0?this.RES.food-=1:(e++,this.colonists[n]&&(this.colonists[n].alive=!1));e>0&&(this.colonists=this.colonists.filter(n=>n.alive),this.msg(`${e} colonist(s) starved`,"bad"));for(const n of this.buildings)n.kind==="farm"&&n.done&&(n.growth=(n.growth||0)+.5,(n.growth||0)>=(n.growTime||1)&&(n.ready=!0));const o=this.buildings.find(n=>n.kind==="tent"&&n.done),i=(this.buildings.find(n=>n.kind==="hq")?3:0)+this.buildings.filter(n=>n.kind==="house"&&n.done).reduce((n,l)=>n+(l.popCap||0),0);o&&this.colonists.length<i&&this.RES.food>=15&&(this.RES.food-=15,this.spawnColonist({x:j.x+O(-20,20),y:j.y+O(-20,20)}),this.msg("A new colonist joined! (-15 food)","info")),this.day>20&&this.win()}dayTick(e){const o=this.isNight();this.tDay+=e*this.fastForward/this.dayLength,this.tDay>=1&&(this.tDay-=1,this.nextDay());const i=this.isNight();!o&&i&&this.spawnWave(),this.prevIsNight=i;for(let n=this.colonists.length-1;n>=0;n--){const l=this.colonists[n];if(!l.alive){this.colonists.splice(n,1);continue}l.profile||(l.profile=_e(),l.color=l.profile.avatar.clothing,l.speed=50*l.profile.stats.workSpeed),l.hp<=0&&(l.alive=!1)}}keyPressed(e){return this.once.has(e)?(this.once.delete(e),!0):!1}update(e){const o=this.debugConsole,i=!!(o&&o.open);if(!i&&this.keyPressed(" ")){this.paused=!this.paused;const l=document.getElementById("btnPause");l&&(l.textContent=this.paused?"Resume":"Pause")}if(!i&&this.keyPressed("h")){const l=document.getElementById("help");l&&(l.hidden=!l.hidden)}!i&&this.keyPressed("b")&&(this.showBuildMenu=!this.showBuildMenu),!i&&this.keyPressed("g")&&(this.debug.nav=!this.debug.nav,this.toast(this.debug.nav?"Debug: nav ON":"Debug: nav OFF")),!i&&this.keyPressed("j")&&(this.debug.colonists=!this.debug.colonists,this.toast(this.debug.colonists?"Debug: colonists ON":"Debug: colonists OFF")),!i&&this.keyPressed("k")&&(this.debug.forceDesktopMode=!this.debug.forceDesktopMode,this.toast(this.debug.forceDesktopMode?"Debug: Force Desktop Mode ON":"Debug: Force Desktop Mode OFF")),!i&&this.keyPressed("escape")&&(this.showBuildMenu?this.showBuildMenu=!1:(this.selectedBuild=null,this.toast("Build canceled"),this.selColonist=null,this.follow=!1)),!i&&this.keyPressed("f")&&(this.fastForward=this.fastForward===1?6:1,this.toast(this.fastForward>1?"Fast-forward ON":"Fast-forward OFF"));const n=360*e/this.camera.zoom;if(this.keyState.w&&(this.camera.y-=n),this.keyState.s&&(this.camera.y+=n),this.keyState.a&&(this.camera.x-=n),this.keyState.d&&(this.camera.x+=n),(this.keyState["+"]||this.keyState["="])&&(this.camera.zoom=Math.max(.6,Math.min(2.2,this.camera.zoom*1.02))),(this.keyState["-"]||this.keyState._)&&(this.camera.zoom=Math.max(.6,Math.min(2.2,this.camera.zoom/1.02))),!this.paused){for(const[l,s]of this.hotbar.entries())this.keyPressed(String(l+1))&&(this.selectedBuild=s,this.toast("Selected: "+z[s].name));if(this.follow&&this.selColonist){const l=this.selColonist,s=this.canvas.width/this.camera.zoom,a=this.canvas.height/this.camera.zoom;this.camera.x=q(l.x-s/2,0,Math.max(0,N.w-s)),this.camera.y=q(l.y-a/2,0,Math.max(0,N.h-a))}this.dayTick(e);for(const l of this.colonists)l.alive&&(rn(this,l,e*this.fastForward),Un(this,l,e*this.fastForward),hn(this,l,e*this.fastForward));for(let l=this.enemies.length-1;l>=0;l--){const s=this.enemies[l];dn(this,s,e*this.fastForward),s.hp<=0&&(this.enemies.splice(l,1),Math.random()<.5&&(this.RES.food+=1))}for(const l of this.buildings){if(l.kind==="turret"&&l.done&&this.updateTurret(l,e*this.fastForward),l.healRate&&l.done){const s=l.healRate,a=l.healRange||120,r=this.centerOf(l);for(const c of this.colonists){if(!c.alive)continue;(c.x-r.x)*(c.x-r.x)+(c.y-r.y)*(c.y-r.y)<a*a&&(c.hp=Math.min(100,c.hp+s*e*this.fastForward))}}if(l.kind==="tent"&&l.done&&(l.cooldown=(l.cooldown||0)-e*this.fastForward,l.cooldown<=0&&this.RES.food>=15)){const s=this.getPopulationCap(),a=this.colonists.filter(d=>d.alive).length,h=Math.max(25,a*8)+15;if(this.colonists.length<s&&this.RES.food>=h){this.RES.food-=15;const d=this.centerOf(l);this.spawnColonist({x:d.x+(Math.random()-.5)*40,y:d.y+(Math.random()-.5)*40}),this.msg("Recruit tent attracted a new colonist! (-15 food)","good"),l.cooldown=60}else this.RES.food<h&&this.RES.food>=15}}this.tryRespawn(e),Yn(this,e);for(let l=this.messages.length-1;l>=0;l--){const s=this.messages[l];s.t-=e,s.t<=0&&this.messages.splice(l,1)}}}draw(){var a;const{ctx:e}=this;Xi(e,this.canvas),this.clampCameraToWorld(),e.save(),qi(e,this.camera),ji(e);for(const r of this.trees)it(e,r.x,r.y,r.r,G.tree);for(const r of this.rocks)it(e,r.x,r.y,r.r,G.rock);for(const r of this.buildings)if(Ki(e,r),(r.kind==="house"||r.kind==="hq")&&this.buildings.some(h=>h.kind==="turret"&&h.done&&Q(this.centerOf(r),this.centerOf(h))<(h.range||120)*(h.range||120))){const h=this.centerOf(r);Ji(e,h.x,r.y-8,12,"#60a5fa")}{const r=new Map;for(const c of this.colonists)c.inside&&c.alive&&r.set(c.inside,(r.get(c.inside)||0)+1);e.save();for(const[c,h]of r){if(!h)continue;const d=8,A=Math.min(h,d),p=10,f=4,g=A*(p+f)-f;let m=c.x+c.w/2-g/2+p/2;const b=c.y+c.h+8,w=this.colonists.filter(v=>v.inside===c);for(let v=0;v<A;v++){const k=w[v%w.length],S=k?k.hp:100,R=S>66?"#22c55e":S>33?"#eab308":"#ef4444";Zi(e,m+v*(p+f),b,10,R)}if(h>d){const v=h-d,k=m+A*(p+f)+6;e.fillStyle="#dbeafe",e.font="600 11px system-ui,Segoe UI,Roboto",e.fillText("+"+v,k,b+4)}}e.restore()}for(const r of this.colonists)!r.inside&&r.alive&&Pt(e,r.x,r.y,r,r.r,this.selColonist===r);if(this.debug.combat){e.save(),e.strokeStyle="#fca5a5",e.globalAlpha=.6;for(const r of this.buildings){if(r.kind!=="turret"||!r.done)continue;const c=this.centerOf(r);e.beginPath(),e.arc(c.x,c.y,r.range||160,0,Math.PI*2),e.stroke()}e.restore()}if(this.drawLongPressProgress(),this.debug.nav){e.save(),e.globalAlpha=.18,e.fillStyle="#ef4444";for(let r=0;r<this.grid.rows;r++)for(let c=0;c<this.grid.cols;c++)this.grid.solid[r*this.grid.cols+c]&&e.fillRect(c*y,r*y,y,y);e.restore(),e.save(),e.globalAlpha=.12;for(let r=0;r<this.grid.rows;r++)for(let c=0;c<this.grid.cols;c++){const h=r*this.grid.cols+c;if(!this.grid.solid[h]){const d=this.grid.cost[h];d<=.7?e.fillStyle="#22c55e":d<=1?e.fillStyle="#eab308":e.fillStyle="#f97316",e.fillRect(c*y,r*y,y,y)}}e.restore(),e.save(),e.strokeStyle="#22d3ee",e.lineWidth=2;for(const r of this.colonists)if(!(!r.alive||!r.path||!r.path.length)){e.beginPath(),e.moveTo(r.x,r.y);for(let c=r.pathIndex??0;c<r.path.length;c++){const h=r.path[c];e.lineTo(h.x,h.y)}if(e.stroke(),r.pathIndex!=null&&r.pathIndex<r.path.length){const c=r.path[r.pathIndex];e.save(),e.fillStyle="#fbbf24",e.beginPath(),e.arc(c.x,c.y,6,0,Math.PI*2),e.fill(),e.restore()}}e.restore(),e.save(),e.font="11px monospace",e.fillStyle="#ffffff",e.strokeStyle="#000000",e.lineWidth=2;for(const r of this.colonists){if(r.inside||!r.alive)continue;const c=`${r.task||r.state||"idle"}`,h=r.x-20,d=r.y-r.r-8;if(e.strokeText(c,h,d),e.fillText(c,h,d),r.target&&r.target.x!=null){const A=r.target;e.save(),e.strokeStyle="#94a3b8",e.lineWidth=1,e.setLineDash([3,3]),e.beginPath(),e.moveTo(r.x,r.y),e.lineTo(A.x,A.y),e.stroke(),e.setLineDash([]),e.restore()}}e.restore(),e.save();for(const r of this.colonists){if(r.inside||!r.alive)continue;const c=r.dangerMemory;if(!(!c||!Array.isArray(c)))for(const h of c){const d=r.t-h.time;if(d>=20)continue;const A=d<5?h.radius:d<20?h.radius*(1-(d-5)/15):0;if(A<=0)continue;const p=d<5?.3:.15*(1-(d-5)/15),f=d<5?0:30;e.globalAlpha=p,e.fillStyle=`hsl(${f}, 100%, 50%)`,e.strokeStyle=`hsl(${f}, 100%, 30%)`,e.lineWidth=2,e.beginPath(),e.arc(h.x,h.y,A,0,Math.PI*2),e.fill(),e.stroke(),e.globalAlpha=p*2,e.fillStyle=`hsl(${f}, 100%, 20%)`,e.beginPath(),e.arc(h.x,h.y,4,0,Math.PI*2),e.fill(),e.globalAlpha=.8,e.fillStyle="#ffffff",e.strokeStyle="#000000",e.lineWidth=2,e.font="10px monospace";const g=`${(20-d).toFixed(1)}s`;e.strokeText(g,h.x-10,h.y-A-5),e.fillText(g,h.x-10,h.y-A-5)}}e.restore()}if(Zn(this),this.debug.colonists){e.save(),e.font="10px monospace",e.lineWidth=1;for(const r of this.colonists){if(r.inside||!r.alive)continue;const c=r.x-35;let h=r.y-r.r-45;const d=12,A=[`State: ${r.state||"unknown"}`,`Task: ${r.task||"none"}`,`HP: ${Math.floor(r.hp||0)}`,`Pos: ${Math.floor(r.x)},${Math.floor(r.y)}`,`Speed: ${(()=>{let g=r.speed||0;r.fatigueSlow&&(g*=r.fatigueSlow);const m=Math.floor(r.x/y),b=Math.floor(r.y/y);if(m>=0&&b>=0&&m<this.grid.cols&&b<this.grid.rows){const w=b*this.grid.cols+m;this.grid.cost[w]<=.7&&(g+=25)}return g.toFixed(1)})()}`,`Stuck: ${r.stuckTimer?r.stuckTimer.toFixed(1)+"s":"no"}`,`Since: ${r.stateSince?r.stateSince.toFixed(1)+"s":"0s"}`,`PathIdx: ${r.pathIndex??"none"}/${((a=r.path)==null?void 0:a.length)??0}`,`Jitter: ${r.jitterScore??0}`,`Repath: ${r.repath?r.repath.toFixed(1)+"s":"none"}`];if(r.target){const g=r.target;g.x!=null&&(A.push(`Target: ${Math.floor(g.x)},${Math.floor(g.y)}`),g.type&&A.push(`Type: ${g.type}`),g.hp!=null&&A.push(`T.HP: ${Math.floor(g.hp)}`))}const p=140,f=A.length*d+4;e.fillStyle="rgba(0, 0, 0, 0.8)",e.fillRect(c-2,h-d+2,p,f),e.strokeStyle="#444",e.strokeRect(c-2,h-d+2,p,f);for(let g=0;g<A.length;g++){const m=A[g];e.fillStyle="#ffffff",e.strokeStyle="#000000",e.lineWidth=2,e.strokeText(m,c,h+g*d),e.fillText(m,c,h+g*d)}if(e.strokeStyle="#ff6b6b",e.lineWidth=1,e.globalAlpha=.3,e.beginPath(),e.arc(r.x,r.y,r.r,0,Math.PI*2),e.stroke(),e.globalAlpha=1,r.target&&r.task&&(r.task==="chop"||r.task==="mine")){const g=r.target;if(g.x!=null&&g.r!=null){const m=g.r+r.r+4+2.5;e.strokeStyle="#22c55e",e.lineWidth=2,e.globalAlpha=.4,e.beginPath(),e.arc(g.x,g.y,m,0,Math.PI*2),e.stroke(),e.globalAlpha=1;const b=Math.hypot(r.x-g.x,r.y-g.y);e.fillStyle=b<=m?"#22c55e":"#ff6b6b",e.font="12px monospace";const w=(r.x+g.x)/2,v=(r.y+g.y)/2;e.strokeText(`${b.toFixed(1)}`,w-15,v),e.fillText(`${b.toFixed(1)}`,w-15,v)}}}e.restore()}for(const r of this.enemies)Vi(e,r.x,r.y,r.r+2,3,G.enemy,-Math.PI/2);if(_i(e,this.bullets),It(e,this.particles),this.isNight()&&(e.fillStyle="rgba(6,10,18, 0.58)",e.fillRect(0,0,N.w,N.h)),this.selectedBuild&&!this.pendingPlacement){const r=z[this.selectedBuild],c=Math.floor(this.mouse.wx/y)*y,h=Math.floor(this.mouse.wy/y)*y,d=xe(this,{...r,size:r.size},c,h)&&pe(this.RES,r.cost);e.globalAlpha=.6,e.fillStyle=d?G.ghost:"#ff6b6b88",e.fillRect(c,h,r.size.w*y,r.size.h*y),e.globalAlpha=1}if(this.mouse.rdown&&this.eraseDragStart){const r=Math.min(this.eraseDragStart.x,this.mouse.wx),c=Math.min(this.eraseDragStart.y,this.mouse.wy),h=Math.abs(this.mouse.wx-this.eraseDragStart.x),d=Math.abs(this.mouse.wy-this.eraseDragStart.y);e.save(),e.globalAlpha=.18,e.fillStyle="#ef4444",e.fillRect(r,c,h,d),e.globalAlpha=1,e.strokeStyle="#ef4444",e.setLineDash([6,4]),e.strokeRect(r+.5,c+.5,h-1,d-1),e.setLineDash([]),e.restore()}e.restore();const o=this.getPopulationCap(),i=this.colonists.filter(r=>!!r.inside).length,n=this.RES.wood+this.RES.stone+this.RES.food,l=this.getStorageCapacity(),s=this.hotbar.map(r=>({key:String(r),name:z[r].name,cost:this.costText(z[r].cost||{}),selected:this.selectedBuild===r}));$i(this.ctx,this.canvas,{res:this.RES,colonists:this.colonists.filter(r=>r.alive).length,cap:o,hiding:i,day:this.day,tDay:this.tDay,isNight:this.isNight(),hotbar:s,messages:this.messages,storage:{used:n,max:l}},this),this.selColonist?un(this,this.selColonist):this.colonistPanelRect=this.colonistPanelCloseRect=null,this.showBuildMenu&&fn(this),this.pendingPlacement&&Dn(this),this.contextMenu&&vn(this)}costText(e){const o=[];return e.wood&&o.push(`${e.wood}w`),e.stone&&o.push(`${e.stone}s`),e.food&&o.push(`${e.food}f`),o.join(" ")}win(){this.paused=!0,this.msg("You survived! Day 20 reached.","good"),alert("You survived to Day 20 — victory!")}lose(){this.paused=!0,this.msg("HQ destroyed. Colony fell.","bad"),alert("Your HQ was destroyed. Game over.")}rebuildNavGrid(){Xt(this)}computePath(e,o,i,n){return qt(this,e,o,i,n)}computePathWithDangerAvoidance(e,o,i,n,l){return jt(this,e,o,i,n,l)}cellIndexAt(e,o){return Rt(this,e,o)}isBlocked(e,o){return Vt(this,e,o)}isWithinInteractionRange(e,o,i,n){const l=e-i.x,s=o-i.y;return Math.hypot(l,s)<=i.r+n}bestApproachToCircle(e,o,i){const l=new Set,s=[],a=Math.max(6,o.r+i-2),r=Math.atan2(o.y-e.y,o.x-e.x),c=[];for(let g=0;g<16;g++){const m=(g%2?1:-1)*Math.ceil(g/2);c.push(m/16*Math.PI*2+r)}for(const g of c){const m=o.x+Math.cos(g)*a,b=o.y+Math.sin(g)*a,w=Math.floor(m/y),v=Math.floor(b/y);if(w<0||v<0||w>=this.grid.cols||v>=this.grid.rows)continue;const k=w*y+y/2,S=v*y+y/2,R=`${w},${v}`;l.has(R)||(l.add(R),!this.isBlocked(k,S)&&s.push({x:k,y:S,gx:w,gy:v}))}if(s.length===0){const g=Math.atan2(e.y-o.y,e.x-o.x),m=o.r+i,b=Math.max(4,y*.33);for(let w=m;w>=Math.max(o.r+2,m-6*y);w-=b){const v=o.x+Math.cos(g)*w,k=o.y+Math.sin(g)*w,S=Math.floor(v/y),R=Math.floor(k/y);if(S<0||R<0||S>=this.grid.cols||R>=this.grid.rows)continue;const P=S*y+y/2,u=R*y+y/2;if(this.isBlocked(P,u))continue;if(this.computePathWithDangerAvoidance(e,e.x,e.y,P,u))return{x:P,y:u}}return{x:o.x+Math.cos(g)*m,y:o.y+Math.sin(g)*m}}let h=null,d=1/0,A=1/0,p=0;const f=8;for(const g of s){if(p>=f)break;const m=this.computePathWithDangerAvoidance(e,e.x,e.y,g.x,g.y);if(!m||m.length===0)continue;p++;let b=0;for(const v of m){const k=this.cellIndexAt(v.x,v.y);if(k<0){b=1/0;break}b+=this.grid.cost[k]||1}if(b===1/0)continue;const w=this.cellIndexAt(g.x,g.y);if(w>=0&&this.grid.cost[w]<=.7&&(b-=.05),m.length<=3&&b<=2)return Math.random()<.02&&console.log(`Early-out: great path found with length ${m.length} and cost ${b.toFixed(3)}`),g;(b<A||b===A&&m.length<d)&&(A=b,d=m.length,h=g)}return h?(Math.random()<.02&&console.log(`Best approach: (${h.x.toFixed(1)}, ${h.y.toFixed(1)}) with path cost ${A.toFixed(3)} and length ${d} (evaluated ${p} candidates)`),h):s[0]}handleContextMenuAction(e,o){var i,n,l,s,a,r,c,h,d,A,p;switch(console.log(`Context menu action: ${e} for colonist:`,(i=o.profile)==null?void 0:i.name),e){case"prioritize_work":this.setTask(o,"work",this.findNearestWorkTarget(o)),this.msg(`${((n=o.profile)==null?void 0:n.name)||"Colonist"} prioritizing work tasks`,"info");break;case"prioritize_build":this.setTask(o,"build",this.findNearestBuildTarget(o)),this.msg(`${((l=o.profile)==null?void 0:l.name)||"Colonist"} prioritizing construction`,"info");break;case"prioritize_haul":this.msg(`${((s=o.profile)==null?void 0:s.name)||"Colonist"} prioritizing hauling`,"info");break;case"prioritize_research":this.msg(`${((a=o.profile)==null?void 0:a.name)||"Colonist"} prioritizing research`,"info");break;case"force_rest":this.forceColonistToRest(o);break;case"force_eat":this.forceColonistToEat(o);break;case"force_work":this.setTask(o,"work",this.findNearestWorkTarget(o)),this.msg(`${((r=o.profile)==null?void 0:r.name)||"Colonist"} forced to work`,"info");break;case"force_guard":this.setTask(o,"guard",{x:o.x,y:o.y}),this.msg(`${((c=o.profile)==null?void 0:c.name)||"Colonist"} guarding area`,"info");break;case"goto_hq":this.sendColonistToHQ(o);break;case"goto_safety":this.sendColonistToSafety(o);break;case"goto_bed":this.sendColonistToBed(o);break;case"goto_food":this.sendColonistToFood(o);break;case"medical_treat":{const f=o,g=this.colonists.filter(b=>{var w;return b!==f&&b.alive&&!((w=b.health)!=null&&w.downed)&&!b.inside});let m=g[0];if(g.length>1){const b=w=>(w.x-f.x)*(w.x-f.x)+(w.y-f.y)*(w.y-f.y);m=g.sort((w,v)=>b(w)-b(v))[0]}!m&&f&&f.alive&&!((h=f.health)!=null&&h.downed)&&(m=f),m?(m.task=null,m.target=null,this.clearPath&&this.clearPath(m),m.tendTarget=f,m.state="tend",m.stateSince=0,this.msg("Tend ordered","info")):this.msg("No available tender","warn");break}case"medical_rescue":{const f=o,g=this.colonists.filter(b=>{var w;return b!==f&&b.alive&&!((w=b.health)!=null&&w.downed)&&!b.inside});let m=g[0];if(g.length>1){const b=w=>(w.x-f.x)*(w.x-f.x)+(w.y-f.y)*(w.y-f.y);m=g.sort((w,v)=>b(w)-b(v))[0]}m?(m.task=null,m.target=null,this.clearPath&&this.clearPath(m),m.rescueTarget=f,m.state="rescue",m.stateSince=0,this.msg("Rescue ordered","info")):this.msg("No available rescuer","warn");break}case"medical_rest":this.forceColonistToRest(o),this.msg(`${((d=o.profile)==null?void 0:d.name)||"Colonist"} ordered to bed rest`,"info");break;case"cancel":this.setTask(o,"idle",{x:o.x,y:o.y}),this.msg(`${((A=o.profile)==null?void 0:A.name)||"Colonist"} task cancelled`,"info");break;case"follow":this.follow&&this.selColonist===o?(this.follow=!1,this.selColonist=null,this.msg("Stopped following","info")):(this.selColonist=o,this.follow=!0,this.msg(`Following ${((p=o.profile)==null?void 0:p.name)||"colonist"}`,"info"));break}xn(this)}findNearestWorkTarget(e){let o=null,i=1/0;for(const n of this.buildings)if(!n.done){const l=Math.hypot(e.x-(n.x+n.w/2),e.y-(n.y+n.h/2));l<i&&(i=l,o=n)}return o||{x:e.x+O(-50,50),y:e.y+O(-50,50)}}findNearestBuildTarget(e){return this.findNearestWorkTarget(e)}forceColonistToRest(e){var i;const o=this.buildings.find(n=>(n.kind==="house"||n.kind==="tent"||n.kind==="hq")&&n.done&&this.buildingHasSpace(n));o?(this.setTask(e,"rest",o),this.msg(`${((i=e.profile)==null?void 0:i.name)||"Colonist"} going to rest`,"info")):this.msg("No available sleeping quarters","warn")}forceColonistToEat(e){var o;this.RES.food>0?(e.hunger=Math.max(0,(e.hunger||0)-30),this.RES.food=Math.max(0,this.RES.food-1),this.msg(`${((o=e.profile)==null?void 0:o.name)||"Colonist"} eating food`,"good")):this.msg("No food available","warn")}sendColonistToHQ(e){var i;const o=this.buildings.find(n=>n.kind==="hq");if(o){const n={x:o.x+o.w/2,y:o.y+o.h/2};this.setTask(e,"goto",n),this.msg(`${((i=e.profile)==null?void 0:i.name)||"Colonist"} going to HQ`,"info")}}sendColonistToSafety(e){var o;for(const i of this.buildings)if(i.done&&this.isProtectedByTurret(i)&&this.buildingHasSpace(i)){this.setTask(e,"goto",i),this.msg(`${((o=e.profile)==null?void 0:o.name)||"Colonist"} going to safety`,"info");return}this.sendColonistToHQ(e)}sendColonistToBed(e){var i;const o=this.buildings.find(n=>(n.kind==="house"||n.kind==="tent")&&n.done&&this.buildingHasSpace(n));o?(this.setTask(e,"rest",o),this.msg(`${((i=e.profile)==null?void 0:i.name)||"Colonist"} going to bed`,"info")):this.msg("No available beds","warn")}sendColonistToFood(e){var i;const o=this.buildings.find(n=>(n.kind==="warehouse"||n.kind==="hq")&&n.done);if(o){const n={x:o.x+o.w/2,y:o.y+o.h/2};this.setTask(e,"goto",n),this.msg(`${((i=e.profile)==null?void 0:i.name)||"Colonist"} going to food storage`,"info")}else this.sendColonistToHQ(e)}treatColonist(e){var i,n;const o=this.buildings.find(l=>l.kind==="infirmary"&&l.done);o?(this.setTask(e,"medical",o),this.msg(`${((i=e.profile)==null?void 0:i.name)||"Colonist"} going for medical treatment`,"info")):(e.hp=Math.min(100,e.hp+15),this.msg(`${((n=e.profile)==null?void 0:n.name)||"Colonist"} received basic treatment`,"good"))}drawLongPressProgress(){if(!this.longPressStartTime||!this.longPressTarget||!this.longPressStartPos)return;const e=this.ctx,i=performance.now()-this.longPressStartTime,n=Math.min(i/500,1);if(n>=1)return;const l=(this.longPressTarget.x-this.camera.x)*this.camera.zoom,s=(this.longPressTarget.y-this.camera.y)*this.camera.zoom;e.save();const a=this.scale(20),r=l,c=s;e.strokeStyle="rgba(255, 255, 255, 0.3)",e.lineWidth=this.scale(3),e.beginPath(),e.arc(r,c,a,0,Math.PI*2),e.stroke(),e.strokeStyle="#60a5fa",e.lineWidth=this.scale(3),e.lineCap="round",e.beginPath();const h=-Math.PI/2,d=h+n*Math.PI*2;if(e.arc(r,c,a,h,d),e.stroke(),n>.3){const A=Math.sin(i/100*Math.PI)*.3+.1;e.fillStyle=`rgba(96, 165, 250, ${A})`,e.beginPath(),e.arc(r,c,a*.6,0,Math.PI*2),e.fill()}n>.5&&(e.fillStyle="#ffffff",e.font=this.getScaledFont(12,"600"),e.textAlign="center",e.textBaseline="middle",e.fillText("⚙️",r,c)),e.restore()}barRow(e,o,i,n,l,s){const a=this.ctx;a.fillStyle="#dbeafe",a.textAlign="left",a.textBaseline="alphabetic",a.fillText(i,e,o);const r=a.measureText(i).width,c=this.scale(70),h=this.scale(10),d=Math.max(c,Math.ceil(r+h*2)),A=this.scale(180),p=s&&s>0?s:d+A+this.scale(16),f=Math.max(this.scale(120),Math.min(A*2,p-d-this.scale(12))),g=this.scale(10),m=e+d,b=o-this.scale(8);a.fillStyle="#0f172a",a.fillRect(m,b,f,g),a.strokeStyle="#1e293b",a.strokeRect(m+.5,b+.5,f-1,g-1);const w=this.scale(2),v=Math.max(0,Math.min(f-w*2,n/100*(f-w*2)));a.fillStyle=l,a.fillRect(m+w,b+w,v,g-w*2)}}function Kn(){if(document.getElementById("error-overlay"))return;const e=document.createElement("div");e.id="error-overlay",e.style.cssText=["position:fixed","inset:0 auto auto 0","max-width:100%","z-index:99999","background:rgba(8,8,10,0.82)","color:#fee2e2",'font:12px/1.4 ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace',"padding:10px","overflow:auto","display:none","white-space:pre-wrap","pointer-events:auto"].join(";");const o=document.createElement("div");o.style.cssText="display:flex;align-items:center;gap:8px;margin-bottom:8px;";const i=document.createElement("strong");i.textContent="Errors";const n=document.createElement("button");n.textContent="Dismiss",n.style.cssText="margin-left:auto;background:#ef4444;color:white;border:none;border-radius:4px;padding:4px 8px;",n.onclick=()=>{e.style.display="none",e.innerHTML="",e.appendChild(o),o.appendChild(i),o.appendChild(n)},o.appendChild(i),o.appendChild(n),e.appendChild(o),document.body.appendChild(e);const l=s=>{e.style.display="block";const a=document.createElement("div");a.textContent=s,e.appendChild(a)};window.__showErrorOverlay=l,window.addEventListener("error",s=>{var r;const a=((r=s==null?void 0:s.error)==null?void 0:r.stack)||(s==null?void 0:s.message)||String(s);l(`[error] ${a}`)}),window.addEventListener("unhandledrejection",s=>{const a=s.reason,r=a&&(a.stack||a.message)||String(a);l(`[unhandledrejection] ${r}`)})}Kn();(()=>{const t=window.__showErrorOverlay;if(!t)return;const e=console.error.bind(console),o=console.warn.bind(console);console.error=(...i)=>{try{t(`[console.error] ${i.map(n=>n&&(n.stack||n.message)?n.stack||n.message:String(n)).join(" ")}`)}catch{}e(...i)},console.warn=(...i)=>{try{t(`[console.warn] ${i.map(n=>n&&(n.stack||n.message)?n.stack||n.message:String(n)).join(" ")}`)}catch{}o(...i)}})();let ae=document.getElementById("game");const ye=document.getElementById("btnPause"),dt=document.getElementById("btnHelp");document.getElementById("btnToggleUI");const Te=document.getElementById("btnMenu"),se=document.getElementById("headerDropdown"),ft=document.getElementById("hd-new"),At=document.getElementById("hd-help"),ut=document.getElementById("hd-build");document.getElementById("hd-toggle-mobile");const pt=document.getElementById("btnNew"),re=document.getElementById("help"),gt=document.getElementById("mobileControls"),mt=document.getElementById("mc-build"),yt=document.getElementById("mc-cancel"),wt=document.getElementById("mc-erase"),bt=document.getElementById("mc-pause"),xt=document.getElementById("mc-ff"),vt=document.getElementById("mc-zoom-in"),Mt=document.getElementById("mc-zoom-out");re&&(re.innerHTML=`
    <h2>How to play</h2>
    <div><b>Goal:</b> Gather wood & stone, build farms for food, add houses for pop cap; survive nightly raids with turrets/walls.</div>
  <div><b>Controls:</b> 1..9 quick-build, <b>B</b> build menu, LMB place, RMB cancel/erase; WASD pan; Space pause; H toggle help; +/- zoom; F fast-forward.</div>
  <div><b>UI Modes:</b> 📱 Mobile UI shows touch controls for tap/touch gameplay. 🖥️ Desktop UI is clean with keyboard shortcuts only.</div>
  `);async function _n(){if(ae=document.getElementById("game"),!ae){const n=window.__showErrorOverlay,l='Fatal: Canvas element with id "game" not found in DOM.';throw n==null||n(l),new Error(l)}const t=ae.getContext("2d");t&&(t.fillStyle="#0a0e14",t.fillRect(0,0,ae.width,ae.height),t.fillStyle="#dbeafe",t.font="24px system-ui",t.textAlign="center",t.fillText("Loading assets...",ae.width/2,ae.height/2));try{await K.getInstance().loadAssets(),console.log("Assets loaded successfully"),console.log("House image loaded:",!!K.getInstance().getImage("house"))}catch(n){console.warn("Some assets failed to load:",n);const l=window.__showErrorOverlay;l==null||l("Warning: some assets failed to load. See console for details.")}const e=new Jn(ae);ye&&(ye.onclick=()=>{e.paused=!e.paused,ye.textContent=e.paused?"Resume":"Pause"}),pt&&(pt.onclick=()=>{e.newGame()}),dt&&(dt.onclick=()=>{re&&(re.hidden=!re.hidden)});const o=document.getElementById("btnFSM"),i=document.getElementById("btnBlueprint");o&&(o.onclick=()=>{window.open("./fsm-editor.html","_blank")}),i&&(i.onclick=()=>{window.open("./blueprint-fsm-editor.html","_blank")}),Object.assign(window,{game:e,BUILD_TYPES:z,imageAssets:K.getInstance()}),gt&&(gt.hidden=!1),document.addEventListener("keydown",n=>{const l=[" ","h","b","f","g","j","escape","w","a","s","d","+","=","-","_"],s=/^[1-9]$/.test(n.key);(l.includes(n.key.toLowerCase())||s)&&document.activeElement&&document.activeElement!==document.body&&document.activeElement.blur()}),Te&&se&&(Te.onclick=()=>{se.hidden=!se.hidden},ft&&(ft.onclick=()=>{se.hidden=!0,e.newGame()}),At&&(At.onclick=()=>{se.hidden=!0,re&&(re.hidden=!re.hidden)}),ut&&(ut.onclick=()=>{se.hidden=!0,e.showBuildMenu=!e.showBuildMenu}),document.addEventListener("click",n=>{if(!se)return;const l=n.target;l&&!se.contains(l)&&l!==Te&&(se.hidden=!0)})),mt&&(mt.onclick=()=>{e.showBuildMenu=!e.showBuildMenu}),yt&&(yt.onclick=()=>{e.selectedBuild=null,e.pendingPlacement=null,e.toast("Build canceled")}),wt&&(wt.onclick=()=>{window._eraseOnce=!0,e.toast("Erase mode: tap on a building to remove")}),bt&&(bt.onclick=()=>{e.paused=!e.paused,ye&&(ye.textContent=e.paused?"Resume":"Pause")}),xt&&(xt.onclick=()=>{e.fastForward=e.fastForward===1?6:1,e.toast(e.fastForward>1?"Fast-forward ON":"Fast-forward OFF")}),vt&&(vt.onclick=()=>{e.camera.zoom=Math.max(.6,Math.min(2.2,e.camera.zoom*1.1))}),Mt&&(Mt.onclick=()=>{e.camera.zoom=Math.max(.6,Math.min(2.2,e.camera.zoom/1.1))})}try{const t=_n();t&&typeof t.catch=="function"&&t.catch(e=>{const o=window.__showErrorOverlay,i=e&&(e.stack||e.message)?e.stack||e.message:String(e);o==null||o(`[init] ${i}`),console.error(e)})}catch(t){const e=window.__showErrorOverlay,o=t&&(t.stack||t.message)?t.stack||t.message:String(t);e==null||e(`[init-sync] ${o}`),console.error(t)}
